WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 16:47:43.950984: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 16:47:43.985659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 16:47:43.985787: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:47:43.985841: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:47:43.985920: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:47:43.985985: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:47:43.986027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:47:43.986066: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:47:43.986105: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 16:47:43.986112: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 16:47:43.986503: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 16:47:44.009955: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 16:47:44.010938: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564ff5d7d540 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:47:44.010959: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 16:47:44.131064: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564ff5ddf850 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:47:44.131100: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 16:47:44.131187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 16:47:44.131193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 11.6775 (error=0.0556997), validation cost 12.0767 (error=0.0591241)
epoch 10, training cost 2.25687 (error=0.0227516), validation cost 2.2632 (error=0.0231505)
epoch 20, training cost 2.17296 (error=0.0221074), validation cost 2.17896 (error=0.0223708)
epoch 30, training cost 1.91027 (error=0.0119034), validation cost 1.91279 (error=0.0120682)
epoch 40, training cost 1.32474 (error=0.00298798), validation cost 1.34256 (error=0.00317548)
epoch 50, training cost 1.10391 (error=0.00188194), validation cost 1.11655 (error=0.002006)
epoch 60, training cost 1.00968 (error=0.00154913), validation cost 1.02728 (error=0.00163872)
epoch 70, training cost 0.82863 (error=0.00114975), validation cost 0.829245 (error=0.00120739)
epoch 80, training cost 0.606516 (error=0.000804673), validation cost 0.623958 (error=0.000832318)
epoch 90, training cost 0.483618 (error=0.000629934), validation cost 0.514965 (error=0.000670879)
[RESULT] training cost 0.655778, validation cost 0.69604, training error 0.000573178, validation error 0.000615517
[SAVE] result_1_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_1/train.jbl
[SAVE] config:  config_adw_gen_1_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.8901262 1.1482503]
[ 1.7640544 -2.0983384]
data index: 0
error= 1.2681737162354814
dimension (observation): 0
steps: 100
[SAVE] : result_1_1/plot/0_data0_train.png
data index: 1
error= 8.43507007995113
dimension (observation): 0
steps: 100
[SAVE] : result_1_1/plot/1_data1_train.png
data index: 2
error= 1.439940577974377
dimension (observation): 0
steps: 100
[SAVE] : result_1_1/plot/2_data2_train.png
data index: 3
error= 9.849149750619521
dimension (observation): 0
steps: 100
[SAVE] : result_1_1/plot/3_data3_train.png
data index: 4
error= 1.2101195629695674
dimension (observation): 0
steps: 100
[SAVE] : result_1_1/plot/4_data4_train.png
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 16:50:34.621222: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 16:50:34.659101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 16:50:34.659269: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:50:34.659332: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:50:34.659384: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:50:34.659438: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:50:34.659493: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:50:34.659548: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:50:34.659598: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 16:50:34.659607: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 16:50:34.660033: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 16:50:34.685998: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 16:50:34.687616: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d9710666b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:50:34.687644: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 16:50:34.815284: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d9710c89c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:50:34.815350: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 16:50:34.815500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 16:50:34.815512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 8.98947 (error=0.132587), validation cost 8.39235 (error=0.121582)
epoch 10, training cost 2.78969 (error=0.0377728), validation cost 2.74745 (error=0.0359756)
epoch 20, training cost 2.403 (error=0.0258141), validation cost 2.37758 (error=0.0246331)
epoch 30, training cost 2.28449 (error=0.0233015), validation cost 2.25654 (error=0.022241)
epoch 40, training cost 2.25635 (error=0.0230222), validation cost 2.225 (error=0.0217852)
epoch 50, training cost 2.24391 (error=0.0229705), validation cost 2.21301 (error=0.0217818)
epoch 60, training cost 2.23665 (error=0.0229568), validation cost 2.20535 (error=0.021786)
epoch 70, training cost 2.23114 (error=0.0229508), validation cost 2.19933 (error=0.0217485)
epoch 80, training cost 2.22808 (error=0.022977), validation cost 2.19646 (error=0.0217573)
epoch 90, training cost 2.22457 (error=0.0229389), validation cost 2.19255 (error=0.0217139)
[RESULT] training cost 2.22262, validation cost 2.1883, training error 0.0229636, validation error 0.0216303
[SAVE] result_1_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_2/train.jbl
[SAVE] config:  config_adw_gen_1_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.3496522 0.883926 ]
[0.3496522 0.883926 ]
data index: 0
error= 1.5335454013746241
dimension (observation): 0
steps: 100
[SAVE] : result_1_2/plot/0_data0_train.png
data index: 1
error= 3.027499617951085
dimension (observation): 0
steps: 100
[SAVE] : result_1_2/plot/1_data1_train.png
data index: 2
error= 1.389017836104375
dimension (observation): 0
steps: 100
[SAVE] : result_1_2/plot/2_data2_train.png
data index: 3
error= 1.3168485907096787
dimension (observation): 0
steps: 100
[SAVE] : result_1_2/plot/3_data3_train.png
data index: 4
error= 1.605031507103015
dimension (observation): 0
steps: 100
[SAVE] : result_1_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_1_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 16:53:34.283976: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 16:53:34.321085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 16:53:34.321292: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:53:34.321363: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:53:34.321439: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:53:34.321485: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:53:34.321533: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:53:34.321595: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:53:34.321646: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 16:53:34.321654: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 16:53:34.322185: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 16:53:34.349978: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 16:53:34.351296: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560ef1e95ff0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:53:34.351341: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 16:53:34.489209: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560ef1ef8300 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:53:34.489251: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 16:53:34.489343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 16:53:34.489350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 120.38 (error=0.146299), validation cost 183.698 (error=0.152586)
epoch 10, training cost 2.82621 (error=0.0232487), validation cost 2.81142 (error=0.0239494)
epoch 20, training cost 2.73823 (error=0.0230701), validation cost 2.75535 (error=0.0235676)
epoch 30, training cost 2.67942 (error=0.0229011), validation cost 2.69613 (error=0.0235534)
epoch 40, training cost 2.63306 (error=0.0227699), validation cost 2.66094 (error=0.0234316)
epoch 50, training cost 2.60594 (error=0.0227288), validation cost 2.62393 (error=0.0233051)
epoch 60, training cost 2.58512 (error=0.0226894), validation cost 2.60664 (error=0.0232956)
epoch 70, training cost 2.56676 (error=0.0226347), validation cost 2.58201 (error=0.0232641)
epoch 80, training cost 2.55298 (error=0.022633), validation cost 2.57219 (error=0.0232422)
epoch 90, training cost 2.53949 (error=0.0226025), validation cost 2.55967 (error=0.023195)
[RESULT] training cost 2.52881, validation cost 2.54619, training error 0.0226107, validation error 0.0232028
[SAVE] result_1_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_3/train.jbl
[SAVE] config:  config_adw_gen_1_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.4045824 -1.740117 ]
[ 0.4045824 -1.740117 ]
data index: 0
error= 1.5427023398300388
dimension (observation): 0
steps: 100
[SAVE] : result_1_3/plot/0_data0_train.png
data index: 1
error= 3.013061829923607
dimension (observation): 0
steps: 100
[SAVE] : result_1_3/plot/1_data1_train.png
data index: 2
error= 1.395140979833986
dimension (observation): 0
steps: 100
[SAVE] : result_1_3/plot/2_data2_train.png
data index: 3
error= 1.33193813543932
dimension (observation): 0
steps: 100
[SAVE] : result_1_3/plot/3_data3_train.png
data index: 4
error= 1.6330587519207576
dimension (observation): 0
steps: 100
[SAVE] : result_1_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_1_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 16:56:18.297027: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 16:56:18.330486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 16:56:18.330596: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:56:18.330638: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:56:18.330675: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:56:18.330715: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:56:18.330760: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:56:18.330798: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:56:18.330835: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 16:56:18.330842: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 16:56:18.331193: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 16:56:18.358095: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 16:56:18.359305: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55abe04486c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:56:18.359326: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 16:56:18.479888: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55abe04aa9d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:56:18.479970: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 16:56:18.480186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 16:56:18.480195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 17.5847 (error=0.049379), validation cost 18.3689 (error=0.0535362)
epoch 10, training cost 3.19105 (error=0.0242319), validation cost 3.21836 (error=0.0255851)
epoch 20, training cost 2.94244 (error=0.0227025), validation cost 2.97431 (error=0.0237805)
epoch 30, training cost 2.83261 (error=0.022575), validation cost 2.85918 (error=0.0236292)
epoch 40, training cost 2.76503 (error=0.0225489), validation cost 2.79765 (error=0.0236552)
epoch 50, training cost 2.71196 (error=0.0225178), validation cost 2.74526 (error=0.0235028)
epoch 60, training cost 2.66891 (error=0.0225116), validation cost 2.70003 (error=0.0235483)
epoch 70, training cost 2.63975 (error=0.0225125), validation cost 2.67063 (error=0.0234822)
epoch 80, training cost 2.62931 (error=0.0225045), validation cost 2.66039 (error=0.0234896)
epoch 90, training cost 2.62216 (error=0.0225036), validation cost 2.6536 (error=0.0235012)
[RESULT] training cost 2.61673, validation cost 2.64645, training error 0.0225029, validation error 0.0234459
[SAVE] result_1_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_4/train.jbl
[SAVE] config:  config_adw_gen_1_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.03259382 0.4697395 ]
[0.03259382 0.4697395 ]
data index: 0
error= 1.5098919344380028
dimension (observation): 0
steps: 100
[SAVE] : result_1_4/plot/0_data0_train.png
data index: 1
error= 3.0023370706106607
dimension (observation): 0
steps: 100
[SAVE] : result_1_4/plot/1_data1_train.png
data index: 2
error= 1.371793631985665
dimension (observation): 0
steps: 100
[SAVE] : result_1_4/plot/2_data2_train.png
data index: 3
error= 1.3085848960238606
dimension (observation): 0
steps: 100
[SAVE] : result_1_4/plot/3_data3_train.png
data index: 4
error= 1.6010876343249223
dimension (observation): 0
steps: 100
[SAVE] : result_1_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_1_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 16:59:06.082126: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 16:59:06.117841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 16:59:06.117996: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:59:06.118045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:59:06.118086: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:59:06.118126: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:59:06.118164: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:59:06.118214: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 16:59:06.118252: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 16:59:06.118259: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 16:59:06.118675: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 16:59:06.145979: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 16:59:06.147170: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557ed5e1bd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:59:06.147196: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 16:59:06.272129: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557ed5e7e040 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 16:59:06.272162: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 16:59:06.272231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 16:59:06.272237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 35476 (error=0.0791214), validation cost 38452.7 (error=0.0794961)
epoch 10, training cost 4.18268 (error=0.0427348), validation cost 4.17792 (error=0.0422777)
epoch 20, training cost 4.02042 (error=0.041513), validation cost 4.00396 (error=0.0405658)
epoch 30, training cost 3.941 (error=0.0404881), validation cost 3.90978 (error=0.0394063)
epoch 40, training cost 3.85805 (error=0.0388598), validation cost 3.85022 (error=0.0386047)
epoch 50, training cost 3.77342 (error=0.0376096), validation cost 3.75845 (error=0.0373531)
epoch 60, training cost 3.70531 (error=0.0363321), validation cost 3.70774 (error=0.0364652)
epoch 70, training cost 3.64868 (error=0.0356116), validation cost 3.63365 (error=0.0352385)
epoch 80, training cost 3.59146 (error=0.0345901), validation cost 3.58011 (error=0.0345577)
epoch 90, training cost 3.53304 (error=0.033535), validation cost 3.52112 (error=0.0333508)
[RESULT] training cost 3.4831, validation cost 3.47449, training error 0.0329771, validation error 0.0329044
[SAVE] result_1_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_5/train.jbl
[SAVE] config:  config_adw_gen_1_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.5651807 0.769812 ]
[0.5651807 0.769812 ]
data index: 0
error= 1.2752909453360861
dimension (observation): 0
steps: 100
[SAVE] : result_1_5/plot/0_data0_train.png
data index: 1
error= 4.731249499998958
dimension (observation): 0
steps: 100
[SAVE] : result_1_5/plot/1_data1_train.png
data index: 2
error= 1.231400308096266
dimension (observation): 0
steps: 100
[SAVE] : result_1_5/plot/2_data2_train.png
data index: 3
error= 0.8271297290901604
dimension (observation): 0
steps: 100
[SAVE] : result_1_5/plot/3_data3_train.png
data index: 4
error= 0.8682502474399177
dimension (observation): 0
steps: 100
[SAVE] : result_1_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_1_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:01:54.668201: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:01:54.700537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:01:54.700645: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:01:54.700690: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:01:54.700728: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:01:54.700768: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:01:54.700806: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:01:54.700842: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:01:54.700880: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:01:54.700895: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:01:54.701234: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:01:54.725970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:01:54.727122: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dc7c756740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:01:54.727151: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:01:54.859143: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dc7c7b8a50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:01:54.859182: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:01:54.859266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:01:54.859272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 150763 (error=0.163874), validation cost 160911 (error=0.156918)
epoch 10, training cost 5.77542 (error=0.0604089), validation cost 5.66756 (error=0.0566818)
epoch 20, training cost 5.59025 (error=0.0561656), validation cost 5.49798 (error=0.0537533)
epoch 30, training cost 5.53288 (error=0.054011), validation cost 5.43145 (error=0.0518809)
epoch 40, training cost 5.4936 (error=0.0520527), validation cost 5.37712 (error=0.0499914)
epoch 50, training cost 5.42681 (error=0.0501513), validation cost 5.34483 (error=0.0479951)
epoch 60, training cost 5.40493 (error=0.0489506), validation cost 5.28715 (error=0.0468936)
epoch 70, training cost 5.3498 (error=0.0472345), validation cost 5.22069 (error=0.0444467)
epoch 80, training cost 5.26316 (error=0.0453427), validation cost 5.2029 (error=0.0435055)
epoch 90, training cost 5.20463 (error=0.0430059), validation cost 5.10895 (error=0.0408781)
[RESULT] training cost 5.13834, validation cost 5.08286, training error 0.0403589, validation error 0.0389315
[SAVE] result_1_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_6/train.jbl
[SAVE] config:  config_adw_gen_1_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.8735866  -0.07688867]
[-0.8735866  -0.07688867]
data index: 0
error= 4.189162342261846
dimension (observation): 0
steps: 100
[SAVE] : result_1_6/plot/0_data0_train.png
data index: 1
error= 4.744435294884639
dimension (observation): 0
steps: 100
[SAVE] : result_1_6/plot/1_data1_train.png
data index: 2
error= 3.7119645162149024
dimension (observation): 0
steps: 100
[SAVE] : result_1_6/plot/2_data2_train.png
data index: 3
error= 5.199121675373661
dimension (observation): 0
steps: 100
[SAVE] : result_1_6/plot/3_data3_train.png
data index: 4
error= 5.287025112529386
dimension (observation): 0
steps: 100
[SAVE] : result_1_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_1_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:04:31.081161: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:04:31.118422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:04:31.118578: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:04:31.118649: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:04:31.118699: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:04:31.118752: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:04:31.118797: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:04:31.118847: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:04:31.118904: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:04:31.118915: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:04:31.119422: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:04:31.145967: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:04:31.147270: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bb4b129890 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:04:31.147317: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:04:31.279160: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bb4b18bba0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:04:31.279221: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:04:31.279355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:04:31.279363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 223286 (error=0.24312), validation cost 242525 (error=0.258906)
epoch 10, training cost 16.4691 (error=0.100523), validation cost 16.982 (error=0.110443)
epoch 20, training cost 14.4366 (error=0.0677441), validation cost 14.7147 (error=0.0726031)
epoch 30, training cost 9.7326 (error=0.0304692), validation cost 9.71986 (error=0.0305181)
epoch 40, training cost 9.22044 (error=0.0241147), validation cost 9.23436 (error=0.0252434)
epoch 50, training cost 8.96371 (error=0.0227024), validation cost 9.0363 (error=0.0241553)
epoch 60, training cost 8.86054 (error=0.0226485), validation cost 8.90256 (error=0.024065)
epoch 70, training cost 8.7753 (error=0.022659), validation cost 8.78254 (error=0.0243041)
epoch 80, training cost 8.62259 (error=0.0225755), validation cost 8.58113 (error=0.0241757)
epoch 90, training cost 8.53725 (error=0.0226093), validation cost 8.60242 (error=0.0240808)
[RESULT] training cost 8.39473, validation cost 8.39497, training error 0.0225752, validation error 0.0241905
[SAVE] result_1_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_7/train.jbl
[SAVE] config:  config_adw_gen_1_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 1.1156226  -0.03024421]
[ 1.1156226  -0.03024421]
data index: 0
error= 1.4904783438623699
dimension (observation): 0
steps: 100
[SAVE] : result_1_7/plot/0_data0_train.png
data index: 1
error= 2.9873116775903226
dimension (observation): 0
steps: 100
[SAVE] : result_1_7/plot/1_data1_train.png
data index: 2
error= 1.3171391633383804
dimension (observation): 0
steps: 100
[SAVE] : result_1_7/plot/2_data2_train.png
data index: 3
error= 1.319935152443661
dimension (observation): 0
steps: 100
[SAVE] : result_1_7/plot/3_data3_train.png
data index: 4
error= 1.579893687996133
dimension (observation): 0
steps: 100
[SAVE] : result_1_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_1_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:07:13.282158: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:07:13.316095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:07:13.316217: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:07:13.316261: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:07:13.316300: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:07:13.316341: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:07:13.316380: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:07:13.316418: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:07:13.316458: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:07:13.316464: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:07:13.316823: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:07:13.341969: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:07:13.343256: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5582cef554a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:07:13.343305: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:07:13.468513: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5582cefb77b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:07:13.468575: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:07:13.468707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:07:13.468714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 180.697 (error=0.145635), validation cost 170.096 (error=0.134583)
epoch 10, training cost 5.5176 (error=0.0261592), validation cost 5.37429 (error=0.0234634)
epoch 20, training cost 4.35605 (error=0.0239977), validation cost 4.26784 (error=0.0226294)
epoch 30, training cost 3.99114 (error=0.0234366), validation cost 3.92106 (error=0.022202)
epoch 40, training cost 3.8071 (error=0.0232401), validation cost 3.76128 (error=0.02217)
epoch 50, training cost 3.70175 (error=0.0230798), validation cost 3.65415 (error=0.0219979)
epoch 60, training cost 3.63038 (error=0.0229889), validation cost 3.58469 (error=0.0218788)
epoch 70, training cost 3.58444 (error=0.0229983), validation cost 3.53918 (error=0.0218804)
epoch 80, training cost 3.54304 (error=0.0229584), validation cost 3.5021 (error=0.0218911)
epoch 90, training cost 3.51376 (error=0.0229344), validation cost 3.47046 (error=0.0218465)
[RESULT] training cost 3.49207, validation cost 3.44953, training error 0.0229448, validation error 0.0218655
[SAVE] result_1_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_8/train.jbl
[SAVE] config:  config_adw_gen_1_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.0660423 -1.4113264]
[ 0.0660423 -1.4113264]
data index: 0
error= 1.6212077711045856
dimension (observation): 0
steps: 100
[SAVE] : result_1_8/plot/0_data0_train.png
data index: 1
error= 2.999840480852286
dimension (observation): 0
steps: 100
[SAVE] : result_1_8/plot/1_data1_train.png
data index: 2
error= 1.4848983928900619
dimension (observation): 0
steps: 100
[SAVE] : result_1_8/plot/2_data2_train.png
data index: 3
error= 1.41430804568597
dimension (observation): 0
steps: 100
[SAVE] : result_1_8/plot/3_data3_train.png
data index: 4
error= 1.726423063068923
dimension (observation): 0
steps: 100
[SAVE] : result_1_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_1_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:10:16.754002: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:10:16.787636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:10:16.787748: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:10:16.787795: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:10:16.787836: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:10:16.787875: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:10:16.787913: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:10:16.787951: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:10:16.787991: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:10:16.787997: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:10:16.788346: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:10:16.813977: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:10:16.815065: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b10344d310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:10:16.815096: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:10:16.943373: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b1034af620 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:10:16.943425: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:10:16.943512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:10:16.943518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 16018.1 (error=0.414602), validation cost 16118.8 (error=0.404192)
epoch 10, training cost 9.98153 (error=0.0933078), validation cost 9.78072 (error=0.088901)
epoch 20, training cost 5.80352 (error=0.0347247), validation cost 5.7446 (error=0.03391)
epoch 30, training cost 5.1269 (error=0.0196728), validation cost 5.1048 (error=0.0197728)
epoch 40, training cost 4.8973 (error=0.0179744), validation cost 4.89286 (error=0.0184983)
epoch 50, training cost 4.70381 (error=0.0197214), validation cost 4.72542 (error=0.0203812)
epoch 60, training cost 4.60768 (error=0.0218711), validation cost 4.62865 (error=0.0226202)
epoch 70, training cost 4.5521 (error=0.0224343), validation cost 4.58343 (error=0.0231595)
epoch 80, training cost 4.50082 (error=0.0225228), validation cost 4.54075 (error=0.0236335)
epoch 90, training cost 4.45563 (error=0.0223901), validation cost 4.49195 (error=0.0231766)
[RESULT] training cost 4.41684, validation cost 4.44112, training error 0.0222162, validation error 0.0227614
[SAVE] result_1_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_9/train.jbl
[SAVE] config:  config_adw_gen_1_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.9945554  0.91313696]
[ 0.5189527 -1.0519284]
data index: 0
error= 1.8757880644671037
dimension (observation): 0
steps: 100
[SAVE] : result_1_9/plot/0_data0_train.png
data index: 1
error= 3.360189590204155
dimension (observation): 0
steps: 100
[SAVE] : result_1_9/plot/1_data1_train.png
data index: 2
error= 1.927129334888976
dimension (observation): 0
steps: 100
[SAVE] : result_1_9/plot/2_data2_train.png
data index: 3
error= 1.6599547408940953
dimension (observation): 0
steps: 100
[SAVE] : result_1_9/plot/3_data3_train.png
data index: 4
error= 2.3975868338494077
dimension (observation): 0
steps: 100
[SAVE] : result_1_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_1_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:13:30.373932: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:13:30.416252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:13:30.416382: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:13:30.416425: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:13:30.416465: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:13:30.416506: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:13:30.416544: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:13:30.416581: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:13:30.416621: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:13:30.416628: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:13:30.416984: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:13:30.441971: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:13:30.443454: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56306b2da2e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:13:30.443482: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:13:30.566487: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56306b33c5f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:13:30.566543: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:13:30.566654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:13:30.566660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 30.7036 (error=0.107273), validation cost 30.8253 (error=0.107887)
epoch 10, training cost 4.50086 (error=0.035323), validation cost 4.44706 (error=0.0330701)
epoch 20, training cost 4.17823 (error=0.0295558), validation cost 4.1283 (error=0.0280455)
epoch 30, training cost 4.02645 (error=0.0272643), validation cost 3.98209 (error=0.0255783)
epoch 40, training cost 3.85399 (error=0.0248763), validation cost 3.78476 (error=0.0232414)
epoch 50, training cost 3.77463 (error=0.0235687), validation cost 3.71126 (error=0.0221351)
epoch 60, training cost 3.73582 (error=0.0224002), validation cost 3.67771 (error=0.0211032)
epoch 70, training cost 3.52197 (error=0.016083), validation cost 3.47266 (error=0.0153477)
epoch 80, training cost 3.02876 (error=0.00847654), validation cost 2.98507 (error=0.00782558)
epoch 90, training cost 2.67905 (error=0.00530594), validation cost 2.66343 (error=0.00502694)
[RESULT] training cost 2.41116, validation cost 2.4077, training error 0.00351326, validation error 0.00340803
[SAVE] result_1_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_1_10/train.jbl
[SAVE] config:  config_adw_gen_1_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_1_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.46432617 1.6020358 ]
[-7.1892953 -2.3092873]
data index: 0
error= 1.2147908702036714
dimension (observation): 0
steps: 100
[SAVE] : result_1_10/plot/0_data0_train.png
data index: 1
error= 5.412739393759948
dimension (observation): 0
steps: 100
[SAVE] : result_1_10/plot/1_data1_train.png
data index: 2
error= 3.1410698494065414
dimension (observation): 0
steps: 100
[SAVE] : result_1_10/plot/2_data2_train.png
data index: 3
error= 2.055384348329223
dimension (observation): 0
steps: 100
[SAVE] : result_1_10/plot/3_data3_train.png
data index: 4
error= 7.093043164888132
dimension (observation): 0
steps: 100
[SAVE] : result_1_10/plot/4_data4_train.png
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:16:36.082364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:16:36.118092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:16:36.118255: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:16:36.118319: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:16:36.118368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:16:36.118408: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:16:36.118453: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:16:36.118513: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:16:36.118573: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:16:36.118589: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:16:36.119030: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:16:36.146042: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:16:36.147685: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5638a49ca510 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:16:36.147714: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:16:36.284365: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5638a4a2c820 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:16:36.284402: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:16:36.284493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:16:36.284499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 6295.05 (error=0.342595), validation cost 5565.05 (error=0.333399)
epoch 10, training cost 4.19022 (error=0.108201), validation cost 4.09849 (error=0.103481)
epoch 20, training cost 2.70685 (error=0.0372288), validation cost 2.69058 (error=0.0361405)
epoch 30, training cost 2.53552 (error=0.0255985), validation cost 2.53355 (error=0.0253447)
epoch 40, training cost 2.45736 (error=0.023935), validation cost 2.45371 (error=0.0239418)
epoch 50, training cost 2.43092 (error=0.0233377), validation cost 2.42811 (error=0.0233821)
epoch 60, training cost 2.41286 (error=0.0230547), validation cost 2.41376 (error=0.0231973)
epoch 70, training cost 2.39986 (error=0.0229296), validation cost 2.39937 (error=0.0229595)
epoch 80, training cost 2.38662 (error=0.0228441), validation cost 2.38861 (error=0.0228825)
epoch 90, training cost 2.38122 (error=0.022862), validation cost 2.37993 (error=0.0229188)
[RESULT] training cost 2.37143, validation cost 2.37069, training error 0.0228516, validation error 0.022903
[SAVE] result_2_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_1/train.jbl
[SAVE] config:  config_adw_gen_2_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.3337638  0.2167663]
[-1.484302    0.17024189]
data index: 0
error= 1.5932330807425963
dimension (observation): 0
steps: 100
[SAVE] : result_2_1/plot/0_data0_train.png
data index: 1
error= 3.0128208255930007
dimension (observation): 0
steps: 100
[SAVE] : result_2_1/plot/1_data1_train.png
data index: 2
error= 1.4947747741790653
dimension (observation): 0
steps: 100
[SAVE] : result_2_1/plot/2_data2_train.png
data index: 3
error= 1.4235824425807577
dimension (observation): 0
steps: 100
[SAVE] : result_2_1/plot/3_data3_train.png
data index: 4
error= 1.7012649165509035
dimension (observation): 0
steps: 100
[SAVE] : result_2_1/plot/4_data4_train.png
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:19:36.501340: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:19:36.533341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:19:36.533457: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:19:36.533499: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:19:36.533536: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:19:36.533575: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:19:36.533611: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:19:36.533649: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:19:36.533687: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:19:36.533694: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:19:36.534058: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:19:36.557971: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:19:36.559248: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560b4951ada0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:19:36.559286: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:19:36.684921: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560b4957d0b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:19:36.684981: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:19:36.685115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:19:36.685125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 10.3616 (error=0.0577825), validation cost 10.3535 (error=0.0580307)
epoch 10, training cost 2.77292 (error=0.0297816), validation cost 2.76757 (error=0.0296103)
epoch 20, training cost 2.42884 (error=0.0226245), validation cost 2.41032 (error=0.0217789)
epoch 30, training cost 2.29429 (error=0.0207014), validation cost 2.27499 (error=0.0200543)
epoch 40, training cost 2.2366 (error=0.019291), validation cost 2.22489 (error=0.0188728)
epoch 50, training cost 2.17342 (error=0.0176273), validation cost 2.16415 (error=0.0173549)
epoch 60, training cost 2.06023 (error=0.0146752), validation cost 2.04676 (error=0.0143132)
epoch 70, training cost 1.82243 (error=0.00956353), validation cost 1.79845 (error=0.00927262)
epoch 80, training cost 1.45208 (error=0.00434445), validation cost 1.43072 (error=0.00422418)
epoch 90, training cost 1.14465 (error=0.001971), validation cost 1.13154 (error=0.00195604)
[RESULT] training cost 0.988738, validation cost 0.976183, training error 0.00116752, validation error 0.00115005
[SAVE] result_2_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_2/train.jbl
[SAVE] config:  config_adw_gen_2_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[4.2802505  0.53794223]
[0.4118287  0.26692757]
data index: 0
error= 1.087456273072502
dimension (observation): 0
steps: 100
[SAVE] : result_2_2/plot/0_data0_train.png
data index: 1
error= 7.551227289024919
dimension (observation): 0
steps: 100
[SAVE] : result_2_2/plot/1_data1_train.png
data index: 2
error= 6.1046076711049055
dimension (observation): 0
steps: 100
[SAVE] : result_2_2/plot/2_data2_train.png
data index: 3
error= 1.0078617997672794
dimension (observation): 0
steps: 100
[SAVE] : result_2_2/plot/3_data3_train.png
data index: 4
error= 2.1963540071469483
dimension (observation): 0
steps: 100
[SAVE] : result_2_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_2_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:22:44.370575: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:22:44.405363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:22:44.405483: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:22:44.405527: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:22:44.405577: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:22:44.405621: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:22:44.405659: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:22:44.405699: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:22:44.405739: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:22:44.405745: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:22:44.406133: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:22:44.429973: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:22:44.431237: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564fb4c54060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:22:44.431261: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:22:44.562131: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564fb4cb6370 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:22:44.562189: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:22:44.562311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:22:44.562317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 96.0057 (error=0.137102), validation cost 97.0204 (error=0.148669)
epoch 10, training cost 6.16357 (error=0.0306078), validation cost 6.22581 (error=0.0345676)
epoch 20, training cost 3.07503 (error=0.0236991), validation cost 3.12251 (error=0.0259107)
epoch 30, training cost 2.59449 (error=0.022391), validation cost 2.64551 (error=0.0243093)
epoch 40, training cost 2.50839 (error=0.0223421), validation cost 2.57048 (error=0.0244771)
epoch 50, training cost 2.47497 (error=0.0223388), validation cost 2.53359 (error=0.0243284)
epoch 60, training cost 2.4557 (error=0.0223141), validation cost 2.51483 (error=0.0243727)
epoch 70, training cost 2.44364 (error=0.022327), validation cost 2.50102 (error=0.0243154)
epoch 80, training cost 2.43408 (error=0.0223263), validation cost 2.49001 (error=0.0242573)
epoch 90, training cost 2.42671 (error=0.0223101), validation cost 2.48399 (error=0.024298)
[RESULT] training cost 2.41955, validation cost 2.47847, training error 0.0222985, validation error 0.0243155
[SAVE] result_2_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_3/train.jbl
[SAVE] config:  config_adw_gen_2_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.68763614 -0.7517652 ]
[-0.68763614 -0.7517652 ]
data index: 0
error= 1.521230397672233
dimension (observation): 0
steps: 100
[SAVE] : result_2_3/plot/0_data0_train.png
data index: 1
error= 2.9888070786894003
dimension (observation): 0
steps: 100
[SAVE] : result_2_3/plot/1_data1_train.png
data index: 2
error= 1.3751366677243402
dimension (observation): 0
steps: 100
[SAVE] : result_2_3/plot/2_data2_train.png
data index: 3
error= 1.2986946754848188
dimension (observation): 0
steps: 100
[SAVE] : result_2_3/plot/3_data3_train.png
data index: 4
error= 1.5981766703678635
dimension (observation): 0
steps: 100
[SAVE] : result_2_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_2_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:25:37.292136: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:25:37.330874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:25:37.330997: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:25:37.331042: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:25:37.331084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:25:37.331126: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:25:37.331175: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:25:37.331215: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:25:37.331255: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:25:37.331262: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:25:37.331638: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:25:37.357998: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:25:37.359411: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5652ab8c88c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:25:37.359440: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:25:37.480708: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5652ab92abd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:25:37.480773: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:25:37.480904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:25:37.480912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 31.2627 (error=0.0408386), validation cost 29.3557 (error=0.0417339)
epoch 10, training cost 3.05257 (error=0.0246669), validation cost 3.05661 (error=0.0249836)
epoch 20, training cost 2.83136 (error=0.023232), validation cost 2.8365 (error=0.023413)
epoch 30, training cost 2.70732 (error=0.022919), validation cost 2.71449 (error=0.0231283)
epoch 40, training cost 2.6537 (error=0.0228421), validation cost 2.65982 (error=0.0230189)
epoch 50, training cost 2.62808 (error=0.0228067), validation cost 2.63581 (error=0.0230308)
epoch 60, training cost 2.6129 (error=0.0227372), validation cost 2.61878 (error=0.0229032)
epoch 70, training cost 2.60375 (error=0.0227516), validation cost 2.60977 (error=0.0229661)
epoch 80, training cost 2.59825 (error=0.0227171), validation cost 2.60535 (error=0.0229446)
epoch 90, training cost 2.59584 (error=0.0227477), validation cost 2.60052 (error=0.0228916)
[RESULT] training cost 2.59309, validation cost 2.59759, training error 0.0227015, validation error 0.0228802
[SAVE] result_2_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_4/train.jbl
[SAVE] config:  config_adw_gen_2_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.4073568  -0.60682356]
[-0.4073568  -0.60682356]
data index: 0
error= 1.5698477930524883
dimension (observation): 0
steps: 100
[SAVE] : result_2_4/plot/0_data0_train.png
data index: 1
error= 2.9605341116614374
dimension (observation): 0
steps: 100
[SAVE] : result_2_4/plot/1_data1_train.png
data index: 2
error= 1.4182821457828128
dimension (observation): 0
steps: 100
[SAVE] : result_2_4/plot/2_data2_train.png
data index: 3
error= 1.313893653539565
dimension (observation): 0
steps: 100
[SAVE] : result_2_4/plot/3_data3_train.png
data index: 4
error= 1.6042231388251371
dimension (observation): 0
steps: 100
[SAVE] : result_2_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_2_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:28:36.405118: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:28:36.443012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:28:36.443174: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:28:36.443230: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:28:36.443275: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:28:36.443329: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:28:36.443376: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:28:36.443443: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:28:36.443495: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:28:36.443505: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:28:36.443964: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:28:36.473978: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:28:36.475247: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5599b34d0a90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:28:36.475273: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:28:36.600698: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5599b3532da0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:28:36.600737: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:28:36.600829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:28:36.600836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 8.29923 (error=0.0999769), validation cost 8.11441 (error=0.0962788)
epoch 10, training cost 3.59354 (error=0.0338435), validation cost 3.55733 (error=0.031994)
epoch 20, training cost 3.26025 (error=0.028077), validation cost 3.22759 (error=0.0268288)
epoch 30, training cost 3.06362 (error=0.0244658), validation cost 3.03567 (error=0.0232499)
epoch 40, training cost 2.93355 (error=0.0232086), validation cost 2.90429 (error=0.0221826)
epoch 50, training cost 2.85344 (error=0.0229796), validation cost 2.8202 (error=0.0219908)
epoch 60, training cost 2.81499 (error=0.0229525), validation cost 2.78133 (error=0.0219486)
epoch 70, training cost 2.79809 (error=0.0229096), validation cost 2.76572 (error=0.021951)
epoch 80, training cost 2.79229 (error=0.0229212), validation cost 2.7563 (error=0.0218074)
epoch 90, training cost 2.78796 (error=0.0229184), validation cost 2.75691 (error=0.0219756)
[RESULT] training cost 2.78605, validation cost 2.75938, training error 0.0229668, validation error 0.0221696
[SAVE] result_2_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_5/train.jbl
[SAVE] config:  config_adw_gen_2_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.5549757  -0.41442555]
[-0.5549757  -0.41442555]
data index: 0
error= 1.7416640985262328
dimension (observation): 0
steps: 100
[SAVE] : result_2_5/plot/0_data0_train.png
data index: 1
error= 2.94962408414672
dimension (observation): 0
steps: 100
[SAVE] : result_2_5/plot/1_data1_train.png
data index: 2
error= 1.5834473756572183
dimension (observation): 0
steps: 100
[SAVE] : result_2_5/plot/2_data2_train.png
data index: 3
error= 1.5496908591946281
dimension (observation): 0
steps: 100
[SAVE] : result_2_5/plot/3_data3_train.png
data index: 4
error= 1.887258586789047
dimension (observation): 0
steps: 100
[SAVE] : result_2_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_2_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:31:34.484877: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:31:34.518258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:31:34.518384: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:31:34.518427: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:31:34.518466: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:31:34.518506: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:31:34.518543: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:31:34.518582: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:31:34.518621: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:31:34.518637: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:31:34.519008: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:31:34.546077: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:31:34.547333: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ccde6476e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:31:34.547370: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:31:34.676127: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ccde6a99f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:31:34.676183: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:31:34.676308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:31:34.676315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 255.333 (error=0.0484284), validation cost 242.515 (error=0.0483434)
epoch 10, training cost 5.65954 (error=0.0244405), validation cost 5.75985 (error=0.0260672)
epoch 20, training cost 4.85564 (error=0.0230296), validation cost 4.89476 (error=0.024075)
epoch 30, training cost 4.45 (error=0.0228827), validation cost 4.48404 (error=0.0238875)
epoch 40, training cost 4.19051 (error=0.0228544), validation cost 4.23156 (error=0.0238579)
epoch 50, training cost 3.96955 (error=0.0227075), validation cost 4.00497 (error=0.0237592)
epoch 60, training cost 3.79251 (error=0.0225749), validation cost 3.82548 (error=0.0236599)
epoch 70, training cost 3.66043 (error=0.0225245), validation cost 3.69164 (error=0.0235656)
epoch 80, training cost 3.55681 (error=0.0224869), validation cost 3.59276 (error=0.023567)
epoch 90, training cost 3.46966 (error=0.0224699), validation cost 3.50955 (error=0.0235479)
[RESULT] training cost 3.39913, validation cost 3.44038, training error 0.0224761, validation error 0.0235866
[SAVE] result_2_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_6/train.jbl
[SAVE] config:  config_adw_gen_2_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.09123181 1.1438578 ]
[0.09123181 1.1438578 ]
data index: 0
error= 1.5538947339007967
dimension (observation): 0
steps: 100
[SAVE] : result_2_6/plot/0_data0_train.png
data index: 1
error= 3.017365714825347
dimension (observation): 0
steps: 100
[SAVE] : result_2_6/plot/1_data1_train.png
data index: 2
error= 1.400968920146705
dimension (observation): 0
steps: 100
[SAVE] : result_2_6/plot/2_data2_train.png
data index: 3
error= 1.340178888534631
dimension (observation): 0
steps: 100
[SAVE] : result_2_6/plot/3_data3_train.png
data index: 4
error= 1.621639154929415
dimension (observation): 0
steps: 100
[SAVE] : result_2_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_2_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:34:39.367759: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:34:39.405764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:34:39.405955: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:34:39.406048: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:34:39.406113: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:34:39.406165: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:34:39.406221: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:34:39.406267: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:34:39.406319: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:34:39.406327: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:34:39.406824: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:34:39.433992: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:34:39.436560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561a504e7450 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:34:39.436587: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:34:39.564577: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561a50549760 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:34:39.564634: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:34:39.564764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:34:39.564774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 22533.4 (error=0.0275554), validation cost 24086.3 (error=0.0263966)
epoch 10, training cost 6.72852 (error=0.0250165), validation cost 6.75581 (error=0.0241059)
epoch 20, training cost 6.63246 (error=0.0237316), validation cost 6.68685 (error=0.022988)
epoch 30, training cost 6.60837 (error=0.023519), validation cost 6.6051 (error=0.0225819)
epoch 40, training cost 6.56076 (error=0.0234128), validation cost 6.55003 (error=0.0227729)
epoch 50, training cost 6.49099 (error=0.0233176), validation cost 6.47005 (error=0.0224865)
epoch 60, training cost 6.41491 (error=0.0233671), validation cost 6.40247 (error=0.0223464)
epoch 70, training cost 6.1679 (error=0.0235444), validation cost 6.19352 (error=0.0225918)
epoch 80, training cost 5.94587 (error=0.0236055), validation cost 5.92761 (error=0.0227857)
epoch 90, training cost 5.89434 (error=0.0234367), validation cost 5.87695 (error=0.0225988)
[RESULT] training cost 5.85432, validation cost 5.84752, training error 0.0232384, validation error 0.0225134
[SAVE] result_2_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_7/train.jbl
[SAVE] config:  config_adw_gen_2_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.51332504 0.05710576]
[0.51332504 0.05710576]
data index: 0
error= 1.473199583900642
dimension (observation): 0
steps: 100
[SAVE] : result_2_7/plot/0_data0_train.png
data index: 1
error= 2.9479396418578916
dimension (observation): 0
steps: 100
[SAVE] : result_2_7/plot/1_data1_train.png
data index: 2
error= 1.4315914040801823
dimension (observation): 0
steps: 100
[SAVE] : result_2_7/plot/2_data2_train.png
data index: 3
error= 1.3492535077780188
dimension (observation): 0
steps: 100
[SAVE] : result_2_7/plot/3_data3_train.png
data index: 4
error= 1.621604219427417
dimension (observation): 0
steps: 100
[SAVE] : result_2_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_2_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:37:24.335506: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:37:24.373571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:37:24.373698: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:37:24.373742: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:37:24.373780: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:37:24.373821: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:37:24.373875: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:37:24.373917: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:37:24.373955: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:37:24.373962: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:37:24.374372: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:37:24.401963: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:37:24.403511: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562aff9e9f80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:37:24.403582: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:37:24.533673: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562affa4c290 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:37:24.533724: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:37:24.533850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:37:24.533883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 19.2042 (error=0.0269651), validation cost 18.8066 (error=0.0258528)
epoch 10, training cost 3.88916 (error=0.0239368), validation cost 3.83694 (error=0.0225579)
epoch 20, training cost 3.56014 (error=0.0231737), validation cost 3.50989 (error=0.0219291)
epoch 30, training cost 3.42288 (error=0.0230663), validation cost 3.36648 (error=0.0217576)
epoch 40, training cost 3.37694 (error=0.0230128), validation cost 3.32565 (error=0.021702)
epoch 50, training cost 3.36783 (error=0.0229816), validation cost 3.31478 (error=0.0216671)
epoch 60, training cost 3.3611 (error=0.022973), validation cost 3.30965 (error=0.0216165)
epoch 70, training cost 3.35848 (error=0.0229883), validation cost 3.30819 (error=0.0216781)
epoch 80, training cost 3.35424 (error=0.0229672), validation cost 3.30085 (error=0.0215969)
epoch 90, training cost 3.35166 (error=0.0229638), validation cost 3.29872 (error=0.0216006)
[RESULT] training cost 3.34837, validation cost 3.29781, training error 0.0229605, validation error 0.0216064
[SAVE] result_2_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_8/train.jbl
[SAVE] config:  config_adw_gen_2_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.21407081 -0.90462255]
[-0.21407081 -0.90462255]
data index: 0
error= 1.572311453272516
dimension (observation): 0
steps: 100
[SAVE] : result_2_8/plot/0_data0_train.png
data index: 1
error= 3.0255305389334217
dimension (observation): 0
steps: 100
[SAVE] : result_2_8/plot/1_data1_train.png
data index: 2
error= 1.4055561958148028
dimension (observation): 0
steps: 100
[SAVE] : result_2_8/plot/2_data2_train.png
data index: 3
error= 1.35487609116175
dimension (observation): 0
steps: 100
[SAVE] : result_2_8/plot/3_data3_train.png
data index: 4
error= 1.659062931430748
dimension (observation): 0
steps: 100
[SAVE] : result_2_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_2_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:40:23.576559: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:40:23.613937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:40:23.614124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:40:23.614181: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:40:23.614221: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:40:23.614269: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:40:23.614311: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:40:23.614368: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:40:23.614423: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:40:23.614433: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:40:23.614859: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:40:23.645955: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:40:23.647039: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5565f52c1710 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:40:23.647062: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:40:23.775636: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5565f5323a20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:40:23.775692: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:40:23.775785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:40:23.775794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 5963.95 (error=0.0415373), validation cost 5645.44 (error=0.040905)
epoch 10, training cost 8.44223 (error=0.0212126), validation cost 8.54412 (error=0.0201529)
epoch 20, training cost 7.26784 (error=0.0208508), validation cost 7.2863 (error=0.0199873)
epoch 30, training cost 6.73702 (error=0.0217312), validation cost 6.66408 (error=0.0208867)
epoch 40, training cost 6.31273 (error=0.0222248), validation cost 6.30521 (error=0.0214485)
epoch 50, training cost 6.07368 (error=0.02238), validation cost 6.06154 (error=0.0215235)
epoch 60, training cost 5.8464 (error=0.0225222), validation cost 5.84419 (error=0.0217011)
epoch 70, training cost 5.69433 (error=0.0225297), validation cost 5.65437 (error=0.0216255)
epoch 80, training cost 5.56324 (error=0.0225739), validation cost 5.52839 (error=0.0217424)
epoch 90, training cost 5.43233 (error=0.0225971), validation cost 5.38549 (error=0.0218458)
[RESULT] training cost 5.33019, validation cost 5.29865, training error 0.0225765, validation error 0.0218124
[SAVE] result_2_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_9/train.jbl
[SAVE] config:  config_adw_gen_2_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.2764468 -1.3045882]
[-1.0829908 -2.09472  ]
data index: 0
error= 1.6777241082305996
dimension (observation): 0
steps: 100
[SAVE] : result_2_9/plot/0_data0_train.png
data index: 1
error= 2.947388097127595
dimension (observation): 0
steps: 100
[SAVE] : result_2_9/plot/1_data1_train.png
data index: 2
error= 1.5808060070861119
dimension (observation): 0
steps: 100
[SAVE] : result_2_9/plot/2_data2_train.png
data index: 3
error= 1.5128702778194187
dimension (observation): 0
steps: 100
[SAVE] : result_2_9/plot/3_data3_train.png
data index: 4
error= 1.8550677120311712
dimension (observation): 0
steps: 100
[SAVE] : result_2_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_2_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:43:30.559114: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:43:30.596263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:43:30.596397: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:43:30.596445: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:43:30.596485: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:43:30.596526: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:43:30.596564: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:43:30.596612: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:43:30.596655: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:43:30.596662: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:43:30.597113: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:43:30.621966: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:43:30.623002: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5574e1e98af0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:43:30.623021: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:43:30.744941: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5574e1efae00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:43:30.744990: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:43:30.745088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:43:30.745099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 6935.59 (error=0.290607), validation cost 7679 (error=0.283024)
epoch 10, training cost 12.6433 (error=0.029476), validation cost 12.8853 (error=0.0291156)
epoch 20, training cost 10.6833 (error=0.0227014), validation cost 10.9097 (error=0.021714)
epoch 30, training cost 9.45546 (error=0.0217831), validation cost 10.529 (error=0.0209561)
epoch 40, training cost 10.1656 (error=0.0214892), validation cost 8.45351 (error=0.0202772)
epoch 50, training cost 8.87903 (error=0.0215098), validation cost 9.10897 (error=0.020274)
epoch 60, training cost 8.22547 (error=0.0216201), validation cost 8.46695 (error=0.0203476)
epoch 70, training cost 8.38154 (error=0.0216746), validation cost 7.67187 (error=0.0205126)
epoch 80, training cost 8.08089 (error=0.0217348), validation cost 7.88931 (error=0.0204557)
epoch 90, training cost 7.62197 (error=0.021773), validation cost 7.54511 (error=0.0207107)
[RESULT] training cost 7.58688, validation cost 7.76867, training error 0.0216901, validation error 0.0204466
[SAVE] result_2_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_2_10/train.jbl
[SAVE] config:  config_adw_gen_2_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_2_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.80059487 -0.63471127]
[ 0.1465149 -1.811545 ]
data index: 0
error= 1.9557873851377778
dimension (observation): 0
steps: 100
[SAVE] : result_2_10/plot/0_data0_train.png
data index: 1
error= 3.0020443064751867
dimension (observation): 0
steps: 100
[SAVE] : result_2_10/plot/1_data1_train.png
data index: 2
error= 1.3077731352224482
dimension (observation): 0
steps: 100
[SAVE] : result_2_10/plot/2_data2_train.png
data index: 3
error= 1.5588582633813355
dimension (observation): 0
steps: 100
[SAVE] : result_2_10/plot/3_data3_train.png
data index: 4
error= 2.021009485436105
dimension (observation): 0
steps: 100
[SAVE] : result_2_10/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_1.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:46:03.834293: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:46:03.870158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:46:03.870320: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:46:03.870389: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:46:03.870446: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:46:03.870490: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:46:03.870533: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:46:03.870572: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:46:03.870612: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:46:03.870618: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:46:03.871025: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:46:03.897974: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:46:03.899251: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cce11da550 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:46:03.899277: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:46:04.026894: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cce123c860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:46:04.026958: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:46:04.027078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:46:04.027088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 3116.89 (error=0.101824), validation cost 4284.63 (error=0.112536)
epoch 10, training cost 3.79926 (error=0.0391179), validation cost 3.85557 (error=0.0379256)
epoch 20, training cost 3.56105 (error=0.0331188), validation cost 3.63618 (error=0.0331859)
epoch 30, training cost 3.43121 (error=0.0282953), validation cost 3.49929 (error=0.0294414)
epoch 40, training cost 3.31049 (error=0.0263562), validation cost 3.39166 (error=0.0278704)
epoch 50, training cost 3.25382 (error=0.0254105), validation cost 3.31471 (error=0.0269972)
epoch 60, training cost 3.1661 (error=0.0247734), validation cost 3.23307 (error=0.0259979)
epoch 70, training cost 3.10756 (error=0.0240856), validation cost 3.16324 (error=0.0257534)
epoch 80, training cost 3.03885 (error=0.0238538), validation cost 3.09967 (error=0.0252186)
epoch 90, training cost 2.97568 (error=0.0234125), validation cost 3.0508 (error=0.0251118)
[RESULT] training cost 2.92737, validation cost 2.9815, training error 0.0230999, validation error 0.0249306
[SAVE] result_3_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_1/train.jbl
[SAVE] config:  config_adw_gen_3_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.07519558 -3.241803  ]
[-0.07566561 -3.2702334 ]
data index: 0
error= 1.7175625795919585
dimension (observation): 0
steps: 100
[SAVE] : result_3_1/plot/0_data0_train.png
data index: 1
error= 3.080805649751508
dimension (observation): 0
steps: 100
[SAVE] : result_3_1/plot/1_data1_train.png
data index: 2
error= 1.6320305715021424
dimension (observation): 0
steps: 100
[SAVE] : result_3_1/plot/2_data2_train.png
data index: 3
error= 1.710303509250172
dimension (observation): 0
steps: 100
[SAVE] : result_3_1/plot/3_data3_train.png
data index: 4
error= 1.9847209353053195
dimension (observation): 0
steps: 100
[SAVE] : result_3_1/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_2.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:48:54.101321: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:48:54.137249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:48:54.137407: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:48:54.137468: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:48:54.137527: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:48:54.137584: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:48:54.137628: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:48:54.137670: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:48:54.137709: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:48:54.137716: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:48:54.138220: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:48:54.161956: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:48:54.162961: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556dff9d9d90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:48:54.162985: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:48:54.283668: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556dffa3c0a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:48:54.283717: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:48:54.283828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:48:54.283834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 8.85744 (error=0.043927), validation cost 8.34879 (error=0.0393364)
epoch 10, training cost 2.82838 (error=0.0248424), validation cost 2.79657 (error=0.0235378)
epoch 20, training cost 2.45401 (error=0.0237635), validation cost 2.43471 (error=0.0230601)
epoch 30, training cost 2.3223 (error=0.0229781), validation cost 2.30105 (error=0.0221846)
epoch 40, training cost 2.2723 (error=0.0228678), validation cost 2.2536 (error=0.0221558)
epoch 50, training cost 2.25404 (error=0.0228977), validation cost 2.23319 (error=0.0220714)
epoch 60, training cost 2.24508 (error=0.022867), validation cost 2.22915 (error=0.0222184)
epoch 70, training cost 2.23937 (error=0.0228552), validation cost 2.22436 (error=0.0222627)
epoch 80, training cost 2.23538 (error=0.0228607), validation cost 2.22055 (error=0.0222997)
epoch 90, training cost 2.23117 (error=0.0228379), validation cost 2.21374 (error=0.0221682)
[RESULT] training cost 2.22808, validation cost 2.20996, training error 0.0228299, validation error 0.0221203
[SAVE] result_3_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_2/train.jbl
[SAVE] config:  config_adw_gen_3_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.5574304  1.5664197]
[-0.5574304  1.5664197]
data index: 0
error= 1.637662141205278
dimension (observation): 0
steps: 100
[SAVE] : result_3_2/plot/0_data0_train.png
data index: 1
error= 2.9780275465114787
dimension (observation): 0
steps: 100
[SAVE] : result_3_2/plot/1_data1_train.png
data index: 2
error= 1.4619731591066338
dimension (observation): 0
steps: 100
[SAVE] : result_3_2/plot/2_data2_train.png
data index: 3
error= 1.4398467563130122
dimension (observation): 0
steps: 100
[SAVE] : result_3_2/plot/3_data3_train.png
data index: 4
error= 1.7199444992256339
dimension (observation): 0
steps: 100
[SAVE] : result_3_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:51:44.134719: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:51:44.174041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:51:44.174244: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:51:44.174331: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:51:44.174387: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:51:44.174442: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:51:44.174494: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:51:44.174547: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:51:44.174602: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:51:44.174611: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:51:44.175095: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:51:44.201974: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:51:44.203149: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555b14f18010 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:51:44.203191: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:51:44.330891: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555b14f7a320 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:51:44.330956: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:51:44.331094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:51:44.331103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 162.257 (error=0.0536007), validation cost 156.743 (error=0.0496617)
epoch 10, training cost 7.99473 (error=0.026823), validation cost 8.0047 (error=0.0259213)
epoch 20, training cost 5.54274 (error=0.0231185), validation cost 5.51025 (error=0.0217685)
epoch 30, training cost 4.67484 (error=0.0230082), validation cost 4.63092 (error=0.0215465)
epoch 40, training cost 4.20147 (error=0.0229785), validation cost 4.15229 (error=0.0215412)
epoch 50, training cost 3.89873 (error=0.0229766), validation cost 3.84599 (error=0.0215587)
epoch 60, training cost 3.68766 (error=0.0229636), validation cost 3.638 (error=0.0215626)
epoch 70, training cost 3.53396 (error=0.0229713), validation cost 3.48634 (error=0.0215777)
epoch 80, training cost 3.40986 (error=0.0229682), validation cost 3.36388 (error=0.0215652)
epoch 90, training cost 3.31059 (error=0.0229692), validation cost 3.26702 (error=0.0215678)
[RESULT] training cost 3.2185, validation cost 3.18116, training error 0.0229791, validation error 0.0215228
[SAVE] result_3_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_3/train.jbl
[SAVE] config:  config_adw_gen_3_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.9626895 1.0952272]
[0.94541055 1.0866189 ]
data index: 0
error= 1.5552452279588442
dimension (observation): 0
steps: 100
[SAVE] : result_3_3/plot/0_data0_train.png
data index: 1
error= 3.0175552037897324
dimension (observation): 0
steps: 100
[SAVE] : result_3_3/plot/1_data1_train.png
data index: 2
error= 1.3938991411443376
dimension (observation): 0
steps: 100
[SAVE] : result_3_3/plot/2_data2_train.png
data index: 3
error= 1.3330180049801947
dimension (observation): 0
steps: 100
[SAVE] : result_3_3/plot/3_data3_train.png
data index: 4
error= 1.6201935677535155
dimension (observation): 0
steps: 100
[SAVE] : result_3_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:54:52.887715: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:54:52.924530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:54:52.924694: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:54:52.924743: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:54:52.924783: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:54:52.924833: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:54:52.924873: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:54:52.924913: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:54:52.924954: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:54:52.924964: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:54:52.925454: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:54:52.951218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:54:52.952265: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556e2ca91e20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:54:52.952289: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:54:53.080030: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556e2caf4130 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:54:53.080070: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:54:53.080167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:54:53.080173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 6972.66 (error=0.0713214), validation cost 5541.36 (error=0.0792827)
epoch 10, training cost 9.65373 (error=0.0803282), validation cost 9.72663 (error=0.0869506)
epoch 20, training cost 6.64574 (error=0.0518978), validation cost 6.72441 (error=0.0580102)
epoch 30, training cost 5.53812 (error=0.0286053), validation cost 5.56455 (error=0.0302941)
epoch 40, training cost 5.10193 (error=0.0244741), validation cost 5.14225 (error=0.0262154)
epoch 50, training cost 4.8286 (error=0.0237313), validation cost 4.86344 (error=0.0252008)
epoch 60, training cost 4.64297 (error=0.0234714), validation cost 4.70196 (error=0.0250097)
epoch 70, training cost 4.50536 (error=0.0234076), validation cost 4.54491 (error=0.0249088)
epoch 80, training cost 4.39653 (error=0.023414), validation cost 4.43348 (error=0.0247919)
epoch 90, training cost 4.2901 (error=0.0233505), validation cost 4.33346 (error=0.0248129)
[RESULT] training cost 4.20811, validation cost 4.25157, training error 0.0232267, validation error 0.0245709
[SAVE] result_3_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_4/train.jbl
[SAVE] config:  config_adw_gen_3_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.37763393 0.24376202]
[-1.0494086 -0.2986443]
data index: 0
error= 1.4438404709580757
dimension (observation): 0
steps: 100
[SAVE] : result_3_4/plot/0_data0_train.png
data index: 1
error= 3.068589801167767
dimension (observation): 0
steps: 100
[SAVE] : result_3_4/plot/1_data1_train.png
data index: 2
error= 1.4409492261426584
dimension (observation): 0
steps: 100
[SAVE] : result_3_4/plot/2_data2_train.png
data index: 3
error= 1.3463542443799426
dimension (observation): 0
steps: 100
[SAVE] : result_3_4/plot/3_data3_train.png
data index: 4
error= 1.7339682813149333
dimension (observation): 0
steps: 100
[SAVE] : result_3_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 17:58:05.458936: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 17:58:05.500133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 17:58:05.500254: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:58:05.500301: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:58:05.500340: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:58:05.500380: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:58:05.500417: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:58:05.500466: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 17:58:05.500505: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 17:58:05.500511: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 17:58:05.500878: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 17:58:05.525978: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 17:58:05.527162: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5617ed994570 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:58:05.527192: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 17:58:05.669257: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5617ed9f6880 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 17:58:05.669316: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 17:58:05.669427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 17:58:05.669433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 8.55479 (error=0.276226), validation cost 8.4934 (error=0.275568)
epoch 10, training cost 3.3791 (error=0.02619), validation cost 3.36824 (error=0.0255654)
epoch 20, training cost 3.1195 (error=0.0236108), validation cost 3.11352 (error=0.0230984)
epoch 30, training cost 2.89112 (error=0.0229175), validation cost 2.87441 (error=0.0223733)
epoch 40, training cost 2.83516 (error=0.0229308), validation cost 2.81744 (error=0.022379)
epoch 50, training cost 2.80746 (error=0.0228391), validation cost 2.79173 (error=0.0223147)
epoch 60, training cost 2.79594 (error=0.0228244), validation cost 2.77832 (error=0.0222726)
epoch 70, training cost 2.78904 (error=0.0228315), validation cost 2.77161 (error=0.022284)
epoch 80, training cost 2.7851 (error=0.022888), validation cost 2.7679 (error=0.0223512)
epoch 90, training cost 2.77991 (error=0.0228449), validation cost 2.76256 (error=0.02232)
[RESULT] training cost 2.77612, validation cost 2.75868, training error 0.0228349, validation error 0.0222972
[SAVE] result_3_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_5/train.jbl
[SAVE] config:  config_adw_gen_3_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.3279037 1.156943 ]
[1.3279037 1.156943 ]
data index: 0
error= 1.505006853524087
dimension (observation): 0
steps: 100
[SAVE] : result_3_5/plot/0_data0_train.png
data index: 1
error= 3.056051278007106
dimension (observation): 0
steps: 100
[SAVE] : result_3_5/plot/1_data1_train.png
data index: 2
error= 1.357331649459296
dimension (observation): 0
steps: 100
[SAVE] : result_3_5/plot/2_data2_train.png
data index: 3
error= 1.2699268316723729
dimension (observation): 0
steps: 100
[SAVE] : result_3_5/plot/3_data3_train.png
data index: 4
error= 1.5494936224114386
dimension (observation): 0
steps: 100
[SAVE] : result_3_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:01:14.234496: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:01:14.271966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:01:14.272118: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:01:14.272167: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:01:14.272230: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:01:14.272285: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:01:14.272533: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:01:14.272584: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:01:14.272637: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:01:14.272651: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:01:14.273032: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:01:14.298004: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:01:14.299506: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dbfcd39b10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:01:14.299533: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:01:14.444803: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dbfcd9be20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:01:14.444858: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:01:14.444977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:01:14.444987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 56.7392 (error=0.0243551), validation cost 59.4862 (error=0.0262515)
epoch 10, training cost 3.6047 (error=0.0232713), validation cost 3.6242 (error=0.0241576)
epoch 20, training cost 3.26038 (error=0.0226674), validation cost 3.2868 (error=0.0237109)
epoch 30, training cost 3.14436 (error=0.0225653), validation cost 3.18112 (error=0.0236823)
epoch 40, training cost 3.07606 (error=0.0225278), validation cost 3.10718 (error=0.0237139)
epoch 50, training cost 3.03436 (error=0.0225143), validation cost 3.06627 (error=0.0236656)
epoch 60, training cost 3.01108 (error=0.0225078), validation cost 3.04535 (error=0.0236258)
epoch 70, training cost 2.99751 (error=0.022543), validation cost 3.03489 (error=0.0236654)
epoch 80, training cost 2.98688 (error=0.0225059), validation cost 3.02257 (error=0.0235915)
epoch 90, training cost 2.97983 (error=0.0224773), validation cost 3.01903 (error=0.0236289)
[RESULT] training cost 2.97688, validation cost 3.02005, training error 0.0224847, validation error 0.0237264
[SAVE] result_3_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_6/train.jbl
[SAVE] config:  config_adw_gen_3_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 1.628821  -1.3516414]
[ 1.6003805 -2.3385637]
data index: 0
error= 1.4563504337011075
dimension (observation): 0
steps: 100
[SAVE] : result_3_6/plot/0_data0_train.png
data index: 1
error= 3.0315486010453863
dimension (observation): 0
steps: 100
[SAVE] : result_3_6/plot/1_data1_train.png
data index: 2
error= 1.3377141906982872
dimension (observation): 0
steps: 100
[SAVE] : result_3_6/plot/2_data2_train.png
data index: 3
error= 1.2360920820403163
dimension (observation): 0
steps: 100
[SAVE] : result_3_6/plot/3_data3_train.png
data index: 4
error= 1.5496706961878897
dimension (observation): 0
steps: 100
[SAVE] : result_3_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:04:15.743160: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:04:15.781254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:04:15.781402: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:04:15.781449: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:04:15.781489: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:04:15.781532: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:04:15.781574: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:04:15.781614: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:04:15.781656: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:04:15.781662: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:04:15.782101: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:04:15.805997: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:04:15.807420: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55997bb35940 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:04:15.807453: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:04:15.937473: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55997bb97c50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:04:15.937512: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:04:15.937598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:04:15.937604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 737.205 (error=0.224551), validation cost 704.147 (error=0.223175)
epoch 10, training cost 3.85852 (error=0.0309863), validation cost 3.85428 (error=0.0314835)
epoch 20, training cost 3.62768 (error=0.0239963), validation cost 3.62841 (error=0.0240803)
epoch 30, training cost 3.55 (error=0.0231454), validation cost 3.54732 (error=0.0230385)
epoch 40, training cost 3.49612 (error=0.0230788), validation cost 3.48979 (error=0.0229136)
epoch 50, training cost 3.45554 (error=0.0230742), validation cost 3.45318 (error=0.022998)
epoch 60, training cost 3.42239 (error=0.0230159), validation cost 3.4211 (error=0.0229735)
epoch 70, training cost 3.39258 (error=0.02298), validation cost 3.39166 (error=0.0228724)
epoch 80, training cost 3.36694 (error=0.0229606), validation cost 3.36386 (error=0.022869)
epoch 90, training cost 3.34027 (error=0.0228249), validation cost 3.34164 (error=0.0228429)
[RESULT] training cost 3.32145, validation cost 3.32032, training error 0.0228162, validation error 0.0227701
[SAVE] result_3_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_7/train.jbl
[SAVE] config:  config_adw_gen_3_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.3595893 1.5786299]
[1.3595893 1.5786299]
data index: 0
error= 1.5511824313441949
dimension (observation): 0
steps: 100
[SAVE] : result_3_7/plot/0_data0_train.png
data index: 1
error= 3.0127480701591365
dimension (observation): 0
steps: 100
[SAVE] : result_3_7/plot/1_data1_train.png
data index: 2
error= 1.3918910286336372
dimension (observation): 0
steps: 100
[SAVE] : result_3_7/plot/2_data2_train.png
data index: 3
error= 1.3560267879694807
dimension (observation): 0
steps: 100
[SAVE] : result_3_7/plot/3_data3_train.png
data index: 4
error= 1.5870094311202303
dimension (observation): 0
steps: 100
[SAVE] : result_3_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:07:16.919626: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:07:16.956185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:07:16.956309: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:07:16.956354: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:07:16.956395: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:07:16.956439: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:07:16.956479: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:07:16.956519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:07:16.956558: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:07:16.956565: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:07:16.956936: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:07:16.981976: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:07:16.983266: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5559cd90f650 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:07:16.983292: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:07:17.114772: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5559cd971960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:07:17.114819: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:07:17.114938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:07:17.114948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 124.331 (error=0.0381956), validation cost 113.556 (error=0.0343968)
epoch 10, training cost 4.70324 (error=0.0267393), validation cost 4.61526 (error=0.0266619)
epoch 20, training cost 3.73602 (error=0.0200732), validation cost 3.68677 (error=0.0195225)
epoch 30, training cost 3.54225 (error=0.0162496), validation cost 3.49137 (error=0.0156591)
epoch 40, training cost 3.46621 (error=0.0155992), validation cost 3.41469 (error=0.0150365)
epoch 50, training cost 3.42509 (error=0.015423), validation cost 3.37784 (error=0.014695)
epoch 60, training cost 3.39632 (error=0.0153106), validation cost 3.34569 (error=0.0146567)
epoch 70, training cost 3.37681 (error=0.0153354), validation cost 3.325 (error=0.0144625)
epoch 80, training cost 3.36221 (error=0.0152044), validation cost 3.31222 (error=0.0146784)
epoch 90, training cost 3.34944 (error=0.0152539), validation cost 3.29594 (error=0.014387)
[RESULT] training cost 3.34401, validation cost 3.29754, training error 0.0151444, validation error 0.0145935
[SAVE] result_3_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_8/train.jbl
[SAVE] config:  config_adw_gen_3_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.61234623 -1.0663568 ]
[-0.57619506 -2.2135525 ]
data index: 0
error= 1.2794270860771597
dimension (observation): 0
steps: 100
[SAVE] : result_3_8/plot/0_data0_train.png
data index: 1
error= 3.194230748031387
dimension (observation): 0
steps: 100
[SAVE] : result_3_8/plot/1_data1_train.png
data index: 2
error= 2.824618080479722
dimension (observation): 0
steps: 100
[SAVE] : result_3_8/plot/2_data2_train.png
data index: 3
error= 1.108188226986098
dimension (observation): 0
steps: 100
[SAVE] : result_3_8/plot/3_data3_train.png
data index: 4
error= 3.425940640952641
dimension (observation): 0
steps: 100
[SAVE] : result_3_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:10:03.131564: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:10:03.171747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:10:03.171912: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:10:03.171961: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:10:03.172007: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:10:03.172051: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:10:03.172094: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:10:03.172133: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:10:03.172174: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:10:03.172181: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:10:03.172695: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:10:03.197979: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:10:03.199358: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5586c838d360 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:10:03.199376: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:10:03.322581: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5586c83ef670 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:10:03.322634: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:10:03.322740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:10:03.322747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 302.115 (error=0.0577885), validation cost 550.74 (error=0.0588963)
epoch 10, training cost 5.73456 (error=0.0268566), validation cost 6.24771 (error=0.0276175)
epoch 20, training cost 5.93636 (error=0.0242412), validation cost 4.64608 (error=0.0248467)
epoch 30, training cost 5.07842 (error=0.0232545), validation cost 4.15495 (error=0.0238945)
epoch 40, training cost 4.73729 (error=0.0228719), validation cost 4.26298 (error=0.0235441)
epoch 50, training cost 4.20931 (error=0.0227569), validation cost 3.95072 (error=0.0234655)
epoch 60, training cost 4.29286 (error=0.0227024), validation cost 3.97973 (error=0.0234082)
epoch 70, training cost 4.01096 (error=0.022652), validation cost 3.87661 (error=0.0234064)
epoch 80, training cost 3.92495 (error=0.0226391), validation cost 3.98304 (error=0.0233742)
epoch 90, training cost 3.9479 (error=0.022588), validation cost 3.85485 (error=0.0233511)
[RESULT] training cost 3.81918, validation cost 3.93215, training error 0.0226099, validation error 0.0233889
[SAVE] result_3_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_9/train.jbl
[SAVE] config:  config_adw_gen_3_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.849416  -1.9097295]
[ 0.849416  -1.9097295]
data index: 0
error= 1.5182313103974094
dimension (observation): 0
steps: 100
[SAVE] : result_3_9/plot/0_data0_train.png
data index: 1
error= 3.038117781997516
dimension (observation): 0
steps: 100
[SAVE] : result_3_9/plot/1_data1_train.png
data index: 2
error= 1.3612112730178338
dimension (observation): 0
steps: 100
[SAVE] : result_3_9/plot/2_data2_train.png
data index: 3
error= 1.3255040798650415
dimension (observation): 0
steps: 100
[SAVE] : result_3_9/plot/3_data3_train.png
data index: 4
error= 1.5370430129822992
dimension (observation): 0
steps: 100
[SAVE] : result_3_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_3_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:12:31.359658: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:12:31.395363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:12:31.395501: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:12:31.395551: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:12:31.395595: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:12:31.395637: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:12:31.395686: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:12:31.395725: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:12:31.395763: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:12:31.395769: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:12:31.396131: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:12:31.421997: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:12:31.423674: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cc466b23c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:12:31.423703: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:12:31.551152: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cc467146d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:12:31.551202: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:12:31.551326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:12:31.551344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 11.4162 (error=0.0708049), validation cost 11.0579 (error=0.0682164)
epoch 10, training cost 3.78461 (error=0.0228265), validation cost 3.82822 (error=0.0240418)
epoch 20, training cost 3.71768 (error=0.0225595), validation cost 3.75952 (error=0.0235606)
epoch 30, training cost 3.69137 (error=0.0225022), validation cost 3.73146 (error=0.0234813)
epoch 40, training cost 3.6755 (error=0.0224952), validation cost 3.71999 (error=0.0234999)
epoch 50, training cost 3.66799 (error=0.0224854), validation cost 3.70889 (error=0.0234647)
epoch 60, training cost 3.66375 (error=0.0224912), validation cost 3.70634 (error=0.0234374)
epoch 70, training cost 3.65948 (error=0.0224851), validation cost 3.70311 (error=0.0234716)
epoch 80, training cost 3.65701 (error=0.0224837), validation cost 3.70108 (error=0.0234692)
epoch 90, training cost 3.65525 (error=0.0224867), validation cost 3.70038 (error=0.0234929)
[RESULT] training cost 3.65358, validation cost 3.69612, training error 0.0224858, validation error 0.0234496
[SAVE] result_3_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_3_10/train.jbl
[SAVE] config:  config_adw_gen_3_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_3_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.4450432  -0.10176796]
[-1.4450432  -0.10176796]
data index: 0
error= 1.557000111144076
dimension (observation): 0
steps: 100
[SAVE] : result_3_10/plot/0_data0_train.png
data index: 1
error= 3.0041327756143317
dimension (observation): 0
steps: 100
[SAVE] : result_3_10/plot/1_data1_train.png
data index: 2
error= 1.3985626152484594
dimension (observation): 0
steps: 100
[SAVE] : result_3_10/plot/2_data2_train.png
data index: 3
error= 1.3359022666802904
dimension (observation): 0
steps: 100
[SAVE] : result_3_10/plot/3_data3_train.png
data index: 4
error= 1.6343104594450906
dimension (observation): 0
steps: 100
[SAVE] : result_3_10/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_1.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:15:16.240541: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:15:16.274623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:15:16.274769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:15:16.274832: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:15:16.274884: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:15:16.274939: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:15:16.274993: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:15:16.275048: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:15:16.275092: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:15:16.275102: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:15:16.275577: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:15:16.302092: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:15:16.305060: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55da2abf60e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:15:16.305094: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:15:16.434866: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55da2ac583f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:15:16.434918: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:15:16.435038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:15:16.435044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 244907 (error=0.100465), validation cost 238438 (error=0.0954808)
epoch 10, training cost 33.301 (error=0.0738423), validation cost 34.6979 (error=0.0793505)
epoch 20, training cost 4.25184 (error=0.062802), validation cost 4.12929 (error=0.0574062)
epoch 30, training cost 3.15404 (error=0.0227696), validation cost 3.02131 (error=0.021992)
epoch 40, training cost 3.09252 (error=0.0210949), validation cost 3.11806 (error=0.0204151)
epoch 50, training cost 2.97948 (error=0.0205447), validation cost 2.92517 (error=0.020218)
epoch 60, training cost 2.87308 (error=0.0204891), validation cost 2.85436 (error=0.0197173)
epoch 70, training cost 2.84502 (error=0.0203686), validation cost 2.774 (error=0.0196855)
epoch 80, training cost 2.76686 (error=0.0198724), validation cost 2.72471 (error=0.0191978)
epoch 90, training cost 2.78834 (error=0.0194756), validation cost 2.69555 (error=0.0187638)
[RESULT] training cost 2.69689, validation cost 2.67432, training error 0.0193251, validation error 0.0187206
[SAVE] result_4_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_1/train.jbl
[SAVE] config:  config_adw_gen_4_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 1.6162711 -1.3428152]
[ 1.1850836 -2.6194596]
data index: 0
error= 1.5767869779892767
dimension (observation): 0
steps: 100
[SAVE] : result_4_1/plot/0_data0_train.png
data index: 1
error= 2.919625673872706
dimension (observation): 0
steps: 100
[SAVE] : result_4_1/plot/1_data1_train.png
data index: 2
error= 1.7459795319361011
dimension (observation): 0
steps: 100
[SAVE] : result_4_1/plot/2_data2_train.png
data index: 3
error= 1.9967867457132604
dimension (observation): 0
steps: 100
[SAVE] : result_4_1/plot/3_data3_train.png
data index: 4
error= 1.8596690330124024
dimension (observation): 0
steps: 100
[SAVE] : result_4_1/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_2.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:17:55.933780: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:17:55.967520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:17:55.967641: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:17:55.967685: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:17:55.967725: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:17:55.967765: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:17:55.967803: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:17:55.967841: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:17:55.967879: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:17:55.967886: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:17:55.968260: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:17:55.993994: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:17:55.995266: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5588dd073070 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:17:55.995296: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:17:56.118170: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5588dd0d5380 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:17:56.118226: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:17:56.118341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:17:56.118348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 13888 (error=0.093059), validation cost 12894.7 (error=0.0975193)
epoch 10, training cost 27.5762 (error=0.0302539), validation cost 29.4914 (error=0.0307252)
epoch 20, training cost 20.4435 (error=0.024822), validation cost 19.2495 (error=0.0260426)
epoch 30, training cost 17.7269 (error=0.0229308), validation cost 17.3448 (error=0.0240304)
epoch 40, training cost 15.9047 (error=0.0225981), validation cost 14.8883 (error=0.0237567)
epoch 50, training cost 14.2943 (error=0.0225637), validation cost 13.669 (error=0.0237195)
epoch 60, training cost 12.4997 (error=0.022576), validation cost 13.2816 (error=0.02372)
epoch 70, training cost 11.6974 (error=0.0225398), validation cost 11.67 (error=0.0237778)
epoch 80, training cost 10.1958 (error=0.0225295), validation cost 11.1226 (error=0.0237333)
epoch 90, training cost 9.60347 (error=0.0225547), validation cost 10.08 (error=0.0237245)
[RESULT] training cost 9.22175, validation cost 8.72045, training error 0.0225118, validation error 0.0236911
[SAVE] result_4_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_2/train.jbl
[SAVE] config:  config_adw_gen_4_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.0398749 -1.3035206]
[-1.0601733 -1.7157187]
data index: 0
error= 1.529318608153811
dimension (observation): 0
steps: 100
[SAVE] : result_4_2/plot/0_data0_train.png
data index: 1
error= 3.005859044601349
dimension (observation): 0
steps: 100
[SAVE] : result_4_2/plot/1_data1_train.png
data index: 2
error= 1.3908385157182404
dimension (observation): 0
steps: 100
[SAVE] : result_4_2/plot/2_data2_train.png
data index: 3
error= 1.31637361701753
dimension (observation): 0
steps: 100
[SAVE] : result_4_2/plot/3_data3_train.png
data index: 4
error= 1.6338297285876284
dimension (observation): 0
steps: 100
[SAVE] : result_4_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:20:34.976716: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:20:35.011789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:20:35.011949: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:20:35.012018: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:20:35.012080: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:20:35.012138: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:20:35.012191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:20:35.012240: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:20:35.012290: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:20:35.012300: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:20:35.012745: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:20:35.038057: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:20:35.039935: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55adb803ff30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:20:35.039964: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:20:35.171086: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55adb80a2240 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:20:35.171128: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:20:35.171239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:20:35.171247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 25.8004 (error=0.112035), validation cost 25.661 (error=0.112825)
epoch 10, training cost 4.65656 (error=0.0320174), validation cost 4.66606 (error=0.032787)
epoch 20, training cost 3.27729 (error=0.0284868), validation cost 3.28454 (error=0.0288459)
epoch 30, training cost 2.81458 (error=0.0242722), validation cost 2.82224 (error=0.0247617)
epoch 40, training cost 2.5775 (error=0.023079), validation cost 2.58364 (error=0.0234604)
epoch 50, training cost 2.51072 (error=0.022823), validation cost 2.52178 (error=0.0232364)
epoch 60, training cost 2.49046 (error=0.0227345), validation cost 2.50195 (error=0.0232358)
epoch 70, training cost 2.47708 (error=0.0226972), validation cost 2.48589 (error=0.0230865)
epoch 80, training cost 2.46731 (error=0.0226707), validation cost 2.48047 (error=0.023108)
epoch 90, training cost 2.46222 (error=0.022728), validation cost 2.4732 (error=0.0230717)
[RESULT] training cost 2.45461, validation cost 2.46533, training error 0.0226593, validation error 0.0230821
[SAVE] result_4_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_3/train.jbl
[SAVE] config:  config_adw_gen_4_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.8209654 1.1352983]
[0.8161664  0.66828644]
data index: 0
error= 1.5524190271972678
dimension (observation): 0
steps: 100
[SAVE] : result_4_3/plot/0_data0_train.png
data index: 1
error= 3.0256259597798056
dimension (observation): 0
steps: 100
[SAVE] : result_4_3/plot/1_data1_train.png
data index: 2
error= 1.4295583572909998
dimension (observation): 0
steps: 100
[SAVE] : result_4_3/plot/2_data2_train.png
data index: 3
error= 1.3344088326659616
dimension (observation): 0
steps: 100
[SAVE] : result_4_3/plot/3_data3_train.png
data index: 4
error= 1.605003805594117
dimension (observation): 0
steps: 100
[SAVE] : result_4_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:23:28.882762: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:23:28.917410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:23:28.917570: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:23:28.917638: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:23:28.917707: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:23:28.917784: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:23:28.917843: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:23:28.917936: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:23:28.917992: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:23:28.918003: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:23:28.918445: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:23:28.945992: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:23:28.947227: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559b92131730 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:23:28.947271: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:23:29.077434: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559b92193a40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:23:29.077489: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:23:29.077608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:23:29.077614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 17.3719 (error=0.0252134), validation cost 17.2532 (error=0.0247069)
epoch 10, training cost 4.25855 (error=0.0234199), validation cost 4.24742 (error=0.0230666)
epoch 20, training cost 3.06409 (error=0.0229296), validation cost 3.05247 (error=0.0226776)
epoch 30, training cost 2.81649 (error=0.0227766), validation cost 2.81123 (error=0.0225723)
epoch 40, training cost 2.72037 (error=0.0227489), validation cost 2.71539 (error=0.022552)
epoch 50, training cost 2.66825 (error=0.0227423), validation cost 2.65954 (error=0.0225161)
epoch 60, training cost 2.63855 (error=0.0227497), validation cost 2.63148 (error=0.02251)
epoch 70, training cost 2.62055 (error=0.0227394), validation cost 2.61383 (error=0.0225178)
epoch 80, training cost 2.61023 (error=0.0227471), validation cost 2.60286 (error=0.0225073)
epoch 90, training cost 2.60347 (error=0.0227406), validation cost 2.59723 (error=0.0225275)
[RESULT] training cost 2.59919, validation cost 2.59383, training error 0.0227675, validation error 0.0225761
[SAVE] result_4_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_4/train.jbl
[SAVE] config:  config_adw_gen_4_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.90009373  0.91135746]
[-1.3698345   0.12439439]
data index: 0
error= 1.6663026412986257
dimension (observation): 0
steps: 100
[SAVE] : result_4_4/plot/0_data0_train.png
data index: 1
error= 3.0016609394939566
dimension (observation): 0
steps: 100
[SAVE] : result_4_4/plot/1_data1_train.png
data index: 2
error= 1.4926816589114924
dimension (observation): 0
steps: 100
[SAVE] : result_4_4/plot/2_data2_train.png
data index: 3
error= 1.455078631852967
dimension (observation): 0
steps: 100
[SAVE] : result_4_4/plot/3_data3_train.png
data index: 4
error= 1.7602915286865348
dimension (observation): 0
steps: 100
[SAVE] : result_4_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:26:31.216512: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:26:31.250716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:26:31.250829: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:26:31.250872: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:26:31.250911: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:26:31.250951: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:26:31.250990: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:26:31.251037: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:26:31.251075: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:26:31.251081: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:26:31.251434: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:26:31.277983: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:26:31.279222: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5585f8a611c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:26:31.279261: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:26:31.412755: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5585f8ac34d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:26:31.412808: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:26:31.412923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:26:31.412930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 14.0628 (error=0.362638), validation cost 15.6251 (error=0.347153)
epoch 10, training cost 5.73109 (error=0.0302367), validation cost 3.73641 (error=0.0310895)
epoch 20, training cost 3.40485 (error=0.0248874), validation cost 3.33863 (error=0.0264486)
epoch 30, training cost 3.19775 (error=0.0228695), validation cost 3.28356 (error=0.0243264)
epoch 40, training cost 3.04706 (error=0.0224872), validation cost 3.12646 (error=0.023978)
epoch 50, training cost 2.90253 (error=0.022477), validation cost 2.96943 (error=0.0238371)
epoch 60, training cost 2.85869 (error=0.0224908), validation cost 2.90178 (error=0.0237828)
epoch 70, training cost 2.84655 (error=0.0224461), validation cost 2.8848 (error=0.023857)
epoch 80, training cost 2.82447 (error=0.0224519), validation cost 2.87307 (error=0.0239498)
epoch 90, training cost 2.82231 (error=0.0225375), validation cost 2.85587 (error=0.0236995)
[RESULT] training cost 2.80505, validation cost 2.85046, training error 0.0224244, validation error 0.0238236
[SAVE] result_4_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_5/train.jbl
[SAVE] config:  config_adw_gen_4_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.6731253 1.7124925]
[1.6731253 1.7124925]
data index: 0
error= 1.5269807048805109
dimension (observation): 0
steps: 100
[SAVE] : result_4_5/plot/0_data0_train.png
data index: 1
error= 3.00598868562722
dimension (observation): 0
steps: 100
[SAVE] : result_4_5/plot/1_data1_train.png
data index: 2
error= 1.3711435418586293
dimension (observation): 0
steps: 100
[SAVE] : result_4_5/plot/2_data2_train.png
data index: 3
error= 1.2930099421160794
dimension (observation): 0
steps: 100
[SAVE] : result_4_5/plot/3_data3_train.png
data index: 4
error= 1.5631974895928114
dimension (observation): 0
steps: 100
[SAVE] : result_4_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:29:17.208016: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:29:17.240065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:29:17.240215: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:29:17.240265: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:29:17.240318: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:29:17.240379: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:29:17.240440: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:29:17.240502: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:29:17.240564: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:29:17.240575: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:29:17.241067: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:29:17.265960: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:29:17.266998: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b752d30420 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:29:17.267019: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:29:17.401000: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b752d92730 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:29:17.401039: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:29:17.401131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:29:17.401137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 3070.43 (error=0.0916207), validation cost 3651.18 (error=0.0924737)
epoch 10, training cost 5.24933 (error=0.0325993), validation cost 5.23901 (error=0.0318033)
epoch 20, training cost 4.84013 (error=0.0280817), validation cost 4.45846 (error=0.0279949)
epoch 30, training cost 4.30838 (error=0.0258223), validation cost 4.36085 (error=0.0253261)
epoch 40, training cost 4.22191 (error=0.0238583), validation cost 4.01336 (error=0.023721)
epoch 50, training cost 3.88243 (error=0.0228224), validation cost 3.88774 (error=0.0225253)
epoch 60, training cost 3.71588 (error=0.0227436), validation cost 3.6427 (error=0.0224666)
epoch 70, training cost 3.73245 (error=0.022744), validation cost 3.8013 (error=0.0224536)
epoch 80, training cost 3.72263 (error=0.0227361), validation cost 3.54721 (error=0.0223704)
epoch 90, training cost 3.5976 (error=0.0228057), validation cost 3.52006 (error=0.0224799)
[RESULT] training cost 3.56404, validation cost 3.51964, training error 0.0227385, validation error 0.0224121
[SAVE] result_4_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_6/train.jbl
[SAVE] config:  config_adw_gen_4_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.0607215 0.8357189]
[ 0.732279   -0.14808506]
data index: 0
error= 1.630889239137078
dimension (observation): 0
steps: 100
[SAVE] : result_4_6/plot/0_data0_train.png
data index: 1
error= 2.991039231711988
dimension (observation): 0
steps: 100
[SAVE] : result_4_6/plot/1_data1_train.png
data index: 2
error= 1.4069577119015637
dimension (observation): 0
steps: 100
[SAVE] : result_4_6/plot/2_data2_train.png
data index: 3
error= 1.3818266019380325
dimension (observation): 0
steps: 100
[SAVE] : result_4_6/plot/3_data3_train.png
data index: 4
error= 1.7199280901762137
dimension (observation): 0
steps: 100
[SAVE] : result_4_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:31:49.218193: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:31:49.254539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:31:49.254712: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:31:49.254785: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:31:49.254849: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:31:49.254900: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:31:49.254959: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:31:49.255004: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:31:49.255045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:31:49.255052: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:31:49.255461: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:31:49.285973: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:31:49.287292: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d428d09420 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:31:49.287335: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:31:49.414323: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d428d6b730 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:31:49.414383: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:31:49.414499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:31:49.414506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 2.24007e+06 (error=0.0746479), validation cost 2.23417e+06 (error=0.0752845)
epoch 10, training cost 41.8998 (error=0.0434723), validation cost 42.9862 (error=0.0440544)
epoch 20, training cost 30.998 (error=0.0235255), validation cost 32.1237 (error=0.0227137)
epoch 30, training cost 31.4215 (error=0.0100991), validation cost 29.9486 (error=0.0101197)
epoch 40, training cost 30.3797 (error=0.0101225), validation cost 33.3503 (error=0.00995708)
epoch 50, training cost 27.7349 (error=0.010026), validation cost 30.8724 (error=0.00979187)
epoch 60, training cost 28.9988 (error=0.00976259), validation cost 30.2838 (error=0.009853)
epoch 70, training cost 30.807 (error=0.00985812), validation cost 27.3209 (error=0.00990982)
epoch 80, training cost 28.565 (error=0.00961774), validation cost 25.2359 (error=0.00943569)
epoch 90, training cost 27.6149 (error=0.00963348), validation cost 29.4714 (error=0.00954562)
[RESULT] training cost 24.8704, validation cost 29.6656, training error 0.00960042, validation error 0.00945251
[SAVE] result_4_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_7/train.jbl
[SAVE] config:  config_adw_gen_4_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.1635197 3.67513  ]
[-2.023909   -0.19144417]
data index: 0
error= 1.1460137204480543
dimension (observation): 0
steps: 100
[SAVE] : result_4_7/plot/0_data0_train.png
data index: 1
error= 3.674258972980104
dimension (observation): 0
steps: 100
[SAVE] : result_4_7/plot/1_data1_train.png
data index: 2
error= 1.3937648182031188
dimension (observation): 0
steps: 100
[SAVE] : result_4_7/plot/2_data2_train.png
data index: 3
error= 2.7178654120397763
dimension (observation): 0
steps: 100
[SAVE] : result_4_7/plot/3_data3_train.png
data index: 4
error= 1.1803704019293135
dimension (observation): 0
steps: 100
[SAVE] : result_4_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:34:11.090059: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:34:11.121856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:34:11.121985: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:34:11.122028: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:34:11.122066: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:34:11.122108: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:34:11.122146: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:34:11.122183: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:34:11.122220: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:34:11.122227: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:34:11.122565: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:34:11.145971: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:34:11.147258: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55905f3e29e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:34:11.147285: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:34:11.277166: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55905f444cf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:34:11.277221: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:34:11.277338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:34:11.277345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 19.55 (error=0.02467), validation cost 24.1004 (error=0.0289075)
epoch 10, training cost 4.32007 (error=0.0230089), validation cost 4.41372 (error=0.0255792)
epoch 20, training cost 4.02611 (error=0.0228366), validation cost 4.16668 (error=0.0254941)
epoch 30, training cost 3.87611 (error=0.0223819), validation cost 4.00123 (error=0.025336)
epoch 40, training cost 3.77634 (error=0.0222227), validation cost 3.91483 (error=0.0254731)
epoch 50, training cost 3.70761 (error=0.0221518), validation cost 3.82645 (error=0.0252405)
epoch 60, training cost 3.64612 (error=0.0220896), validation cost 3.77814 (error=0.0252509)
epoch 70, training cost 3.58975 (error=0.0221232), validation cost 3.7302 (error=0.0256123)
epoch 80, training cost 3.53734 (error=0.0220916), validation cost 3.67029 (error=0.0253515)
epoch 90, training cost 3.49046 (error=0.0220761), validation cost 3.62283 (error=0.0253661)
[RESULT] training cost 3.45292, validation cost 3.57063, training error 0.0221159, validation error 0.0250563
[SAVE] result_4_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_8/train.jbl
[SAVE] config:  config_adw_gen_4_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.02976271 -1.6440064 ]
[-0.02976271 -1.6440064 ]
data index: 0
error= 1.5792099173353042
dimension (observation): 0
steps: 100
[SAVE] : result_4_8/plot/0_data0_train.png
data index: 1
error= 3.0265613220513425
dimension (observation): 0
steps: 100
[SAVE] : result_4_8/plot/1_data1_train.png
data index: 2
error= 1.3989125346553255
dimension (observation): 0
steps: 100
[SAVE] : result_4_8/plot/2_data2_train.png
data index: 3
error= 1.353009855893309
dimension (observation): 0
steps: 100
[SAVE] : result_4_8/plot/3_data3_train.png
data index: 4
error= 1.6512446294651582
dimension (observation): 0
steps: 100
[SAVE] : result_4_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:37:12.450911: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:37:12.491398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:37:12.491529: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:37:12.491572: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:37:12.491611: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:37:12.491651: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:37:12.491690: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:37:12.491728: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:37:12.491765: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:37:12.491771: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:37:12.492172: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:37:12.518014: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:37:12.519311: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563bdf31be20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:37:12.519351: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:37:12.653217: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563bdf37e130 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:37:12.653260: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:37:12.653348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:37:12.653354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 5931.5 (error=0.0781476), validation cost 4993.14 (error=0.0710855)
epoch 10, training cost 21.4845 (error=0.0664067), validation cost 21.5716 (error=0.0593314)
epoch 20, training cost 15.2165 (error=0.0529474), validation cost 15.4833 (error=0.0479769)
epoch 30, training cost 10.6459 (error=0.0378393), validation cost 10.7494 (error=0.0359792)
epoch 40, training cost 8.83546 (error=0.0313417), validation cost 8.83434 (error=0.0295699)
epoch 50, training cost 7.63338 (error=0.027839), validation cost 7.61239 (error=0.0264657)
epoch 60, training cost 6.75857 (error=0.025678), validation cost 6.77395 (error=0.0244091)
epoch 70, training cost 6.099 (error=0.0239613), validation cost 6.10132 (error=0.0227836)
epoch 80, training cost 5.64007 (error=0.0231324), validation cost 5.58945 (error=0.0219638)
epoch 90, training cost 5.33998 (error=0.0229446), validation cost 5.3138 (error=0.0218505)
[RESULT] training cost 5.16163, validation cost 5.12813, training error 0.0229554, validation error 0.0218755
[SAVE] result_4_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_9/train.jbl
[SAVE] config:  config_adw_gen_4_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.60382456  2.0401995 ]
[-2.721096    0.86446637]
data index: 0
error= 1.5694899168304923
dimension (observation): 0
steps: 100
[SAVE] : result_4_9/plot/0_data0_train.png
data index: 1
error= 2.960737707226899
dimension (observation): 0
steps: 100
[SAVE] : result_4_9/plot/1_data1_train.png
data index: 2
error= 1.386124364347348
dimension (observation): 0
steps: 100
[SAVE] : result_4_9/plot/2_data2_train.png
data index: 3
error= 1.365379463902586
dimension (observation): 0
steps: 100
[SAVE] : result_4_9/plot/3_data3_train.png
data index: 4
error= 1.7370358762366296
dimension (observation): 0
steps: 100
[SAVE] : result_4_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_4_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:40:20.780966: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:40:20.813748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:40:20.813907: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:40:20.813982: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:40:20.814032: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:40:20.814075: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:40:20.814113: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:40:20.814150: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:40:20.814190: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:40:20.814196: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:40:20.814585: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:40:20.841982: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:40:20.843185: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e4d7594030 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:40:20.843214: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:40:20.970057: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e4d75f6340 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:40:20.970106: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:40:20.970233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:40:20.970239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 28.9515 (error=0.114068), validation cost 29.491 (error=0.115712)
epoch 10, training cost 5.98846 (error=0.0462017), validation cost 6.01555 (error=0.0482368)
epoch 20, training cost 4.8311 (error=0.0361659), validation cost 4.8575 (error=0.037323)
epoch 30, training cost 4.37498 (error=0.0279008), validation cost 4.39618 (error=0.0296724)
epoch 40, training cost 4.18025 (error=0.023562), validation cost 4.2103 (error=0.0248687)
epoch 50, training cost 4.10353 (error=0.0226289), validation cost 4.1322 (error=0.0240815)
epoch 60, training cost 4.02023 (error=0.0225513), validation cost 4.05291 (error=0.0239571)
epoch 70, training cost 3.91195 (error=0.022535), validation cost 3.96699 (error=0.0239253)
epoch 80, training cost 3.83714 (error=0.0225788), validation cost 3.89618 (error=0.0239914)
epoch 90, training cost 3.81269 (error=0.0226007), validation cost 3.87672 (error=0.0240412)
[RESULT] training cost 3.79065, validation cost 3.85053, training error 0.0224809, validation error 0.0238898
[SAVE] result_4_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_4_10/train.jbl
[SAVE] config:  config_adw_gen_4_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_4_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.4349017  0.935186 ]
[-1.5001364  0.9196422]
data index: 0
error= 1.510072200511587
dimension (observation): 0
steps: 100
[SAVE] : result_4_10/plot/0_data0_train.png
data index: 1
error= 3.0124108202049356
dimension (observation): 0
steps: 100
[SAVE] : result_4_10/plot/1_data1_train.png
data index: 2
error= 1.336663370896985
dimension (observation): 0
steps: 100
[SAVE] : result_4_10/plot/2_data2_train.png
data index: 3
error= 1.3155333435294017
dimension (observation): 0
steps: 100
[SAVE] : result_4_10/plot/3_data3_train.png
data index: 4
error= 1.5961994890633426
dimension (observation): 0
steps: 100
[SAVE] : result_4_10/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_1.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:43:23.207376: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:43:23.244257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:43:23.244438: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:43:23.244529: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:43:23.244592: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:43:23.244643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:43:23.244710: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:43:23.244770: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:43:23.244825: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:43:23.244834: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:43:23.245287: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:43:23.269965: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:43:23.271060: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e88db55400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:43:23.271081: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:43:23.402974: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e88dbb7710 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:43:23.403011: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:43:23.403094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:43:23.403101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 34.5565 (error=0.0460867), validation cost 34.5308 (error=0.0413569)
epoch 10, training cost 3.20311 (error=0.0232205), validation cost 3.21374 (error=0.023212)
epoch 20, training cost 2.81992 (error=0.0227438), validation cost 2.81503 (error=0.0227008)
epoch 30, training cost 2.58652 (error=0.0227267), validation cost 2.59606 (error=0.0227968)
epoch 40, training cost 2.42924 (error=0.0227099), validation cost 2.42071 (error=0.0227547)
epoch 50, training cost 2.29938 (error=0.0227143), validation cost 2.29626 (error=0.0228098)
epoch 60, training cost 2.20634 (error=0.0227105), validation cost 2.2066 (error=0.0226912)
epoch 70, training cost 2.15173 (error=0.0227175), validation cost 2.15171 (error=0.0226189)
epoch 80, training cost 2.12275 (error=0.0227147), validation cost 2.1228 (error=0.0227279)
epoch 90, training cost 2.10099 (error=0.0227088), validation cost 2.10566 (error=0.0227249)
[RESULT] training cost 2.09126, validation cost 2.0922, training error 0.0227089, validation error 0.0226716
[SAVE] result_5_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_1/train.jbl
[SAVE] config:  config_adw_gen_5_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.5258876 -1.0530059]
[-0.5258876 -1.0530059]
data index: 0
error= 1.4887100688439625
dimension (observation): 0
steps: 100
[SAVE] : result_5_1/plot/0_data0_train.png
data index: 1
error= 3.0420311639755444
dimension (observation): 0
steps: 100
[SAVE] : result_5_1/plot/1_data1_train.png
data index: 2
error= 1.343305937634869
dimension (observation): 0
steps: 100
[SAVE] : result_5_1/plot/2_data2_train.png
data index: 3
error= 1.2651415638197778
dimension (observation): 0
steps: 100
[SAVE] : result_5_1/plot/3_data3_train.png
data index: 4
error= 1.5539113655657564
dimension (observation): 0
steps: 100
[SAVE] : result_5_1/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_2.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:46:31.196208: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:46:31.232614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:46:31.232738: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:46:31.232781: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:46:31.232819: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:46:31.232859: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:46:31.232896: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:46:31.232934: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:46:31.232972: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:46:31.232978: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:46:31.233406: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:46:31.257971: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:46:31.259239: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a6b184a2f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:46:31.259263: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:46:31.388584: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a6b18ac600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:46:31.388628: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:46:31.388720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:46:31.388726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 31490.8 (error=0.199349), validation cost 34615.2 (error=0.19547)
epoch 10, training cost 9.06457 (error=0.0539566), validation cost 9.06122 (error=0.0503292)
epoch 20, training cost 6.01603 (error=0.0466495), validation cost 5.79079 (error=0.0432484)
epoch 30, training cost 4.11615 (error=0.0295597), validation cost 4.0084 (error=0.0280348)
epoch 40, training cost 3.60948 (error=0.0251078), validation cost 3.59362 (error=0.0238495)
epoch 50, training cost 3.35397 (error=0.0240811), validation cost 3.34908 (error=0.0225983)
epoch 60, training cost 3.2297 (error=0.023768), validation cost 3.17388 (error=0.0223638)
epoch 70, training cost 3.12892 (error=0.0235048), validation cost 3.10104 (error=0.0221921)
epoch 80, training cost 3.05302 (error=0.023363), validation cost 3.02348 (error=0.0220711)
epoch 90, training cost 2.99814 (error=0.0233288), validation cost 2.96853 (error=0.0219336)
[RESULT] training cost 2.95241, validation cost 2.92594, training error 0.0232823, validation error 0.0219586
[SAVE] result_5_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_2/train.jbl
[SAVE] config:  config_adw_gen_5_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.68199366 -0.8080128 ]
[-0.68199366 -0.8080128 ]
data index: 0
error= 1.5841217325993207
dimension (observation): 0
steps: 100
[SAVE] : result_5_2/plot/0_data0_train.png
data index: 1
error= 2.965536006630397
dimension (observation): 0
steps: 100
[SAVE] : result_5_2/plot/1_data1_train.png
data index: 2
error= 1.3521929403321824
dimension (observation): 0
steps: 100
[SAVE] : result_5_2/plot/2_data2_train.png
data index: 3
error= 1.3878530023824698
dimension (observation): 0
steps: 100
[SAVE] : result_5_2/plot/3_data3_train.png
data index: 4
error= 1.576582452608975
dimension (observation): 0
steps: 100
[SAVE] : result_5_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:49:30.464643: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:49:30.500244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:49:30.500364: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:49:30.500423: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:49:30.500465: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:49:30.500507: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:49:30.500545: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:49:30.500584: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:49:30.500623: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:49:30.500630: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:49:30.501047: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:49:30.525975: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:49:30.527273: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556cbc3843a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:49:30.527297: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:49:30.682396: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556cbc3e66b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:49:30.682441: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:49:30.682544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:49:30.682551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 9.61042 (error=0.180648), validation cost 9.84773 (error=0.180533)
epoch 10, training cost 2.82913 (error=0.0241049), validation cost 2.838 (error=0.024129)
epoch 20, training cost 2.6063 (error=0.0231006), validation cost 2.60652 (error=0.0230857)
epoch 30, training cost 2.52862 (error=0.0228936), validation cost 2.5262 (error=0.0228503)
epoch 40, training cost 2.48998 (error=0.022756), validation cost 2.49016 (error=0.0227638)
epoch 50, training cost 2.46903 (error=0.0227484), validation cost 2.46741 (error=0.0227071)
epoch 60, training cost 2.45464 (error=0.022746), validation cost 2.45342 (error=0.0227324)
epoch 70, training cost 2.44341 (error=0.0227197), validation cost 2.44258 (error=0.0226873)
epoch 80, training cost 2.43542 (error=0.0227134), validation cost 2.43331 (error=0.0226679)
epoch 90, training cost 2.42789 (error=0.0227001), validation cost 2.42602 (error=0.0226684)
[RESULT] training cost 2.42208, validation cost 2.42155, training error 0.0227016, validation error 0.0226879
[SAVE] result_5_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_3/train.jbl
[SAVE] config:  config_adw_gen_5_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.30545223 -0.7664061 ]
[-0.45224714 -1.114189  ]
data index: 0
error= 1.610194045939543
dimension (observation): 0
steps: 100
[SAVE] : result_5_3/plot/0_data0_train.png
data index: 1
error= 3.009111487371816
dimension (observation): 0
steps: 100
[SAVE] : result_5_3/plot/1_data1_train.png
data index: 2
error= 1.4369104606731449
dimension (observation): 0
steps: 100
[SAVE] : result_5_3/plot/2_data2_train.png
data index: 3
error= 1.4090796932646708
dimension (observation): 0
steps: 100
[SAVE] : result_5_3/plot/3_data3_train.png
data index: 4
error= 1.700771897970039
dimension (observation): 0
steps: 100
[SAVE] : result_5_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:52:44.030612: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:52:44.074428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:52:44.074639: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:52:44.074726: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:52:44.074797: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:52:44.074843: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:52:44.074891: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:52:44.074942: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:52:44.075002: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:52:44.075017: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:52:44.075564: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:52:44.105963: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:52:44.107513: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b33fadb1f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:52:44.107555: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:52:44.226669: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b33fb3d500 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:52:44.226724: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:52:44.226838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:52:44.226844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 15.1015 (error=0.0324083), validation cost 15.1817 (error=0.0331755)
epoch 10, training cost 3.01573 (error=0.021631), validation cost 3.01815 (error=0.0214697)
epoch 20, training cost 2.68801 (error=0.0211211), validation cost 2.69099 (error=0.0212837)
epoch 30, training cost 2.6405 (error=0.0211806), validation cost 2.63326 (error=0.0209761)
epoch 40, training cost 2.62301 (error=0.0210965), validation cost 2.62089 (error=0.0210699)
epoch 50, training cost 2.61529 (error=0.0210041), validation cost 2.6194 (error=0.0212027)
epoch 60, training cost 2.60892 (error=0.0209007), validation cost 2.60443 (error=0.0207283)
epoch 70, training cost 2.60468 (error=0.0207858), validation cost 2.59916 (error=0.0206537)
epoch 80, training cost 2.60323 (error=0.020835), validation cost 2.59598 (error=0.020629)
epoch 90, training cost 2.59656 (error=0.0205009), validation cost 2.58897 (error=0.0203008)
[RESULT] training cost 2.59506, validation cost 2.58509, training error 0.0202705, validation error 0.0199785
[SAVE] result_5_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_4/train.jbl
[SAVE] config:  config_adw_gen_5_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 1.7365388  -0.24855949]
[-0.49733794 -0.7638701 ]
data index: 0
error= 1.5446886960233004
dimension (observation): 0
steps: 100
[SAVE] : result_5_4/plot/0_data0_train.png
data index: 1
error= 3.1563283332161025
dimension (observation): 0
steps: 100
[SAVE] : result_5_4/plot/1_data1_train.png
data index: 2
error= 1.7158413434678936
dimension (observation): 0
steps: 100
[SAVE] : result_5_4/plot/2_data2_train.png
data index: 3
error= 1.5552247848713865
dimension (observation): 0
steps: 100
[SAVE] : result_5_4/plot/3_data3_train.png
data index: 4
error= 2.067691304395209
dimension (observation): 0
steps: 100
[SAVE] : result_5_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:55:30.713419: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:55:30.749921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:55:30.750158: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:55:30.750230: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:55:30.750291: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:55:30.750350: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:55:30.750433: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:55:30.750479: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:55:30.750523: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:55:30.750534: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:55:30.751093: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:55:30.778014: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:55:30.779773: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55870cf41e20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:55:30.779825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:55:30.906485: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55870cfa4130 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:55:30.906550: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:55:30.906691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:55:30.906702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 11.2196 (error=0.0332507), validation cost 12.5242 (error=0.0305714)
epoch 10, training cost 3.71225 (error=0.0241542), validation cost 3.6801 (error=0.0229424)
epoch 20, training cost 3.2186 (error=0.0231093), validation cost 3.18192 (error=0.0216905)
epoch 30, training cost 2.98497 (error=0.0230437), validation cost 2.93694 (error=0.0215279)
epoch 40, training cost 2.88011 (error=0.0230207), validation cost 2.8334 (error=0.0215988)
epoch 50, training cost 2.83693 (error=0.0230045), validation cost 2.78918 (error=0.0215762)
epoch 60, training cost 2.82009 (error=0.0230284), validation cost 2.76912 (error=0.0214266)
epoch 70, training cost 2.81011 (error=0.0229924), validation cost 2.75892 (error=0.0214194)
epoch 80, training cost 2.80191 (error=0.0229255), validation cost 2.75303 (error=0.0214011)
epoch 90, training cost 2.79562 (error=0.0228418), validation cost 2.7478 (error=0.0213955)
[RESULT] training cost 2.79188, validation cost 2.74628, training error 0.022806, validation error 0.0214147
[SAVE] result_5_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_5/train.jbl
[SAVE] config:  config_adw_gen_5_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.687426   -0.01081443]
[ 0.16237798 -0.8518874 ]
data index: 0
error= 1.7375793120483232
dimension (observation): 0
steps: 100
[SAVE] : result_5_5/plot/0_data0_train.png
data index: 1
error= 2.986510552220528
dimension (observation): 0
steps: 100
[SAVE] : result_5_5/plot/1_data1_train.png
data index: 2
error= 1.4770974427479922
dimension (observation): 0
steps: 100
[SAVE] : result_5_5/plot/2_data2_train.png
data index: 3
error= 1.4365970329057933
dimension (observation): 0
steps: 100
[SAVE] : result_5_5/plot/3_data3_train.png
data index: 4
error= 1.7581387987784145
dimension (observation): 0
steps: 100
[SAVE] : result_5_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 18:58:36.269956: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 18:58:36.310750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 18:58:36.310936: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:58:36.310990: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:58:36.311036: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:58:36.311152: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:58:36.311256: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:58:36.311358: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 18:58:36.311466: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 18:58:36.311484: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 18:58:36.312179: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 18:58:36.337997: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 18:58:36.339494: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563c47d00720 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:58:36.339527: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:58:36.492204: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563c47d62a30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:58:36.492249: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 18:58:36.492345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:58:36.492352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 84.3029 (error=0.103803), validation cost 81.8294 (error=0.103321)
epoch 10, training cost 6.22986 (error=0.0322234), validation cost 6.23166 (error=0.0312762)
epoch 20, training cost 3.46923 (error=0.0235546), validation cost 3.4559 (error=0.0233437)
epoch 30, training cost 3.194 (error=0.0228396), validation cost 3.18132 (error=0.0226289)
epoch 40, training cost 3.10733 (error=0.0227732), validation cost 3.10047 (error=0.022599)
epoch 50, training cost 3.0413 (error=0.0227688), validation cost 3.03496 (error=0.0226135)
epoch 60, training cost 2.99617 (error=0.0227317), validation cost 2.99101 (error=0.0225958)
epoch 70, training cost 2.97493 (error=0.0227286), validation cost 2.96923 (error=0.022575)
epoch 80, training cost 2.96678 (error=0.022715), validation cost 2.96024 (error=0.0225619)
epoch 90, training cost 2.9632 (error=0.0227325), validation cost 2.95725 (error=0.0225885)
[RESULT] training cost 2.96057, validation cost 2.95504, training error 0.022742, validation error 0.0225825
[SAVE] result_5_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_6/train.jbl
[SAVE] config:  config_adw_gen_5_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.07095058  0.9878215 ]
[-0.07095058  0.9878215 ]
data index: 0
error= 1.6597106397090766
dimension (observation): 0
steps: 100
[SAVE] : result_5_6/plot/0_data0_train.png
data index: 1
error= 2.9927707956935103
dimension (observation): 0
steps: 100
[SAVE] : result_5_6/plot/1_data1_train.png
data index: 2
error= 1.4961917441192192
dimension (observation): 0
steps: 100
[SAVE] : result_5_6/plot/2_data2_train.png
data index: 3
error= 1.438248959758844
dimension (observation): 0
steps: 100
[SAVE] : result_5_6/plot/3_data3_train.png
data index: 4
error= 1.739381084344038
dimension (observation): 0
steps: 100
[SAVE] : result_5_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:02:13.451055: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:02:13.489833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:02:13.489964: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:02:13.490009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:02:13.490048: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:02:13.490088: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:02:13.490127: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:02:13.490165: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:02:13.490203: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:02:13.490217: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:02:13.490618: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:02:13.513976: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:02:13.515093: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5584857cea40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:02:13.515121: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:02:13.640428: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558485830d50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:02:13.640476: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:02:13.640604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:02:13.640624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 194562 (error=0.825818), validation cost 195137 (error=0.788502)
epoch 10, training cost 131.64 (error=0.0336574), validation cost 157.187 (error=0.035633)
epoch 20, training cost 98.8902 (error=0.0221875), validation cost 137.785 (error=0.0215564)
epoch 30, training cost 83.9926 (error=0.0202573), validation cost 87.6518 (error=0.0193527)
epoch 40, training cost 60.6599 (error=0.0193347), validation cost 66.0027 (error=0.0184649)
epoch 50, training cost 63.6392 (error=0.0185463), validation cost 51.9551 (error=0.0175316)
epoch 60, training cost 40.3372 (error=0.01858), validation cost 46.1825 (error=0.0173884)
epoch 70, training cost 33.1096 (error=0.0188404), validation cost 33.0437 (error=0.0175026)
epoch 80, training cost 25.919 (error=0.0195399), validation cost 45.818 (error=0.0182834)
epoch 90, training cost 27.733 (error=0.0201437), validation cost 59.2907 (error=0.0189952)
[RESULT] training cost 24.3288, validation cost 24.0165, training error 0.0206111, validation error 0.0192712
[SAVE] result_5_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_7/train.jbl
[SAVE] config:  config_adw_gen_5_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[4.439495  3.5746837]
[1.346371  1.7481781]
data index: 0
error= 1.8116321455349003
dimension (observation): 0
steps: 100
[SAVE] : result_5_7/plot/0_data0_train.png
data index: 1
error= 3.2914069913348243
dimension (observation): 0
steps: 100
[SAVE] : result_5_7/plot/1_data1_train.png
data index: 2
error= 1.2890963039594237
dimension (observation): 0
steps: 100
[SAVE] : result_5_7/plot/2_data2_train.png
data index: 3
error= 1.7897055623191775
dimension (observation): 0
steps: 100
[SAVE] : result_5_7/plot/3_data3_train.png
data index: 4
error= 2.09930806444231
dimension (observation): 0
steps: 100
[SAVE] : result_5_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:05:15.613556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:05:15.656842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:05:15.656981: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:05:15.657027: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:05:15.657067: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:05:15.657109: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:05:15.657147: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:05:15.657184: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:05:15.657222: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:05:15.657229: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:05:15.657680: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:05:15.682002: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:05:15.684084: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d6e7aeabd0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:05:15.684134: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:05:15.849906: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d6e7b4cee0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:05:15.849957: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:05:15.850086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:05:15.850099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 19.0722 (error=0.0415826), validation cost 19.333 (error=0.0426867)
epoch 10, training cost 4.45509 (error=0.0267958), validation cost 4.40577 (error=0.0247216)
epoch 20, training cost 3.99152 (error=0.0232329), validation cost 3.95425 (error=0.0221962)
epoch 30, training cost 3.76445 (error=0.023091), validation cost 3.73816 (error=0.0224397)
epoch 40, training cost 3.63578 (error=0.0229432), validation cost 3.60138 (error=0.0220607)
epoch 50, training cost 3.54226 (error=0.0228907), validation cost 3.50959 (error=0.0220789)
epoch 60, training cost 3.47048 (error=0.0228881), validation cost 3.43896 (error=0.0220655)
epoch 70, training cost 3.42018 (error=0.0228932), validation cost 3.39233 (error=0.0221891)
epoch 80, training cost 3.38834 (error=0.0229216), validation cost 3.34532 (error=0.0217992)
epoch 90, training cost 3.37156 (error=0.0229098), validation cost 3.3299 (error=0.0218099)
[RESULT] training cost 3.3612, validation cost 3.33439, training error 0.0228984, validation error 0.0222004
[SAVE] result_5_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_8/train.jbl
[SAVE] config:  config_adw_gen_5_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 1.0371922  -0.02913359]
[ 1.0371922  -0.02913359]
data index: 0
error= 1.7036934246708657
dimension (observation): 0
steps: 100
[SAVE] : result_5_8/plot/0_data0_train.png
data index: 1
error= 2.973678899244188
dimension (observation): 0
steps: 100
[SAVE] : result_5_8/plot/1_data1_train.png
data index: 2
error= 1.5453767028862422
dimension (observation): 0
steps: 100
[SAVE] : result_5_8/plot/2_data2_train.png
data index: 3
error= 1.4914362374731704
dimension (observation): 0
steps: 100
[SAVE] : result_5_8/plot/3_data3_train.png
data index: 4
error= 1.8285642764074042
dimension (observation): 0
steps: 100
[SAVE] : result_5_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:08:55.654528: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:08:55.704307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:08:55.704515: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:08:55.704563: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:08:55.704612: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:08:55.704660: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:08:55.704712: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:08:55.704762: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:08:55.704823: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:08:55.704830: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:08:55.705429: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:08:55.729977: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:08:55.731358: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55be7aae3130 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:08:55.731400: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:08:55.867926: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55be7ab45440 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:08:55.867994: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:08:55.868120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:08:55.868128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 398778 (error=0.0317835), validation cost 392179 (error=0.0306439)
epoch 10, training cost 1107.27 (error=0.0290971), validation cost 967.014 (error=0.0288103)
epoch 20, training cost 678.899 (error=0.0234503), validation cost 653.905 (error=0.0229857)
epoch 30, training cost 518.469 (error=0.0231039), validation cost 464.08 (error=0.0228068)
epoch 40, training cost 389.377 (error=0.022917), validation cost 482.19 (error=0.0226572)
epoch 50, training cost 321.636 (error=0.0228998), validation cost 314.586 (error=0.0225242)
epoch 60, training cost 280.758 (error=0.0228466), validation cost 259.041 (error=0.0226219)
epoch 70, training cost 226.47 (error=0.0228536), validation cost 232.46 (error=0.0227045)
epoch 80, training cost 204.878 (error=0.0228133), validation cost 212.672 (error=0.022524)
epoch 90, training cost 176.209 (error=0.0227922), validation cost 185.316 (error=0.0225747)
[RESULT] training cost 155.798, validation cost 156.065, training error 0.0228046, validation error 0.0225125
[SAVE] result_5_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_9/train.jbl
[SAVE] config:  config_adw_gen_5_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.7239287  0.85695827]
[0.33564115 0.7886225 ]
data index: 0
error= 1.6242320225523006
dimension (observation): 0
steps: 100
[SAVE] : result_5_9/plot/0_data0_train.png
data index: 1
error= 2.9884340713160844
dimension (observation): 0
steps: 100
[SAVE] : result_5_9/plot/1_data1_train.png
data index: 2
error= 1.5004450713158648
dimension (observation): 0
steps: 100
[SAVE] : result_5_9/plot/2_data2_train.png
data index: 3
error= 1.3999454790706307
dimension (observation): 0
steps: 100
[SAVE] : result_5_9/plot/3_data3_train.png
data index: 4
error= 1.7325987218994658
dimension (observation): 0
steps: 100
[SAVE] : result_5_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_5_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:12:19.145397: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:12:19.177091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:12:19.177193: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:12:19.177236: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:12:19.177275: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:12:19.177315: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:12:19.177354: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:12:19.177393: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:12:19.177431: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:12:19.177437: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:12:19.177766: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:12:19.202020: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:12:19.203152: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f802580a30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:12:19.203174: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:12:19.347085: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f8025e2d40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:12:19.347135: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:12:19.347225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:12:19.347233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 1363.55 (error=0.10424), validation cost 1558.4 (error=0.110945)
epoch 10, training cost 8.40138 (error=0.0336025), validation cost 8.37493 (error=0.0337314)
epoch 20, training cost 5.49122 (error=0.0272603), validation cost 5.54519 (error=0.027835)
epoch 30, training cost 4.31699 (error=0.0259197), validation cost 4.34562 (error=0.0265079)
epoch 40, training cost 4.23205 (error=0.0250924), validation cost 4.25803 (error=0.0259784)
epoch 50, training cost 4.19768 (error=0.0245929), validation cost 4.22608 (error=0.0256113)
epoch 60, training cost 4.16318 (error=0.0239957), validation cost 4.18521 (error=0.0244929)
epoch 70, training cost 4.13866 (error=0.0235992), validation cost 4.15757 (error=0.0243293)
epoch 80, training cost 4.11209 (error=0.0233183), validation cost 4.13532 (error=0.0239554)
epoch 90, training cost 4.09905 (error=0.0230969), validation cost 4.11646 (error=0.0237561)
[RESULT] training cost 4.08624, validation cost 4.10512, training error 0.0230508, validation error 0.0237456
[SAVE] result_5_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_5_10/train.jbl
[SAVE] config:  config_adw_gen_5_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_5_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.95733875 0.8764193 ]
[0.7920723  0.84221774]
data index: 0
error= 1.4555269607837342
dimension (observation): 0
steps: 100
[SAVE] : result_5_10/plot/0_data0_train.png
data index: 1
error= 3.06290899103904
dimension (observation): 0
steps: 100
[SAVE] : result_5_10/plot/1_data1_train.png
data index: 2
error= 1.213690530961766
dimension (observation): 0
steps: 100
[SAVE] : result_5_10/plot/2_data2_train.png
data index: 3
error= 1.2137765027421938
dimension (observation): 0
steps: 100
[SAVE] : result_5_10/plot/3_data3_train.png
data index: 4
error= 1.5735997403563031
dimension (observation): 0
steps: 100
[SAVE] : result_5_10/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_1.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:15:40.913976: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:15:40.957509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:15:40.957719: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:15:40.957826: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:15:40.957926: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:15:40.958010: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:15:40.958088: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:15:40.958156: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:15:40.958233: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:15:40.958255: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:15:40.958916: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:15:40.990008: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:15:40.992649: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559db9203590 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:15:40.992736: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:15:41.150515: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559db92658a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:15:41.150589: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:15:41.150729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:15:41.150739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 590.248 (error=0.0607522), validation cost 558.957 (error=0.0575436)
epoch 10, training cost 21.0715 (error=0.0261888), validation cost 19.1264 (error=0.0263852)
epoch 20, training cost 12.8884 (error=0.0243282), validation cost 12.7332 (error=0.0243407)
epoch 30, training cost 10.2773 (error=0.0229289), validation cost 10.4367 (error=0.0231675)
epoch 40, training cost 8.28151 (error=0.0226771), validation cost 8.23181 (error=0.0228847)
epoch 50, training cost 7.22027 (error=0.0226529), validation cost 6.93424 (error=0.0228381)
epoch 60, training cost 6.3244 (error=0.0226603), validation cost 6.23804 (error=0.022814)
epoch 70, training cost 5.62566 (error=0.0226575), validation cost 5.93105 (error=0.0228803)
epoch 80, training cost 5.07666 (error=0.0226633), validation cost 5.19197 (error=0.0228539)
epoch 90, training cost 4.73405 (error=0.0226619), validation cost 4.6538 (error=0.0228535)
[RESULT] training cost 4.35962, validation cost 4.28566, training error 0.0226545, validation error 0.0228773
[SAVE] result_6_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_1/train.jbl
[SAVE] config:  config_adw_gen_6_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.21158288 1.0888339 ]
[0.21158288 1.0888339 ]
data index: 0
error= 1.6388608965763398
dimension (observation): 0
steps: 100
[SAVE] : result_6_1/plot/0_data0_train.png
data index: 1
error= 3.0006876263194693
dimension (observation): 0
steps: 100
[SAVE] : result_6_1/plot/1_data1_train.png
data index: 2
error= 1.4554661877150334
dimension (observation): 0
steps: 100
[SAVE] : result_6_1/plot/2_data2_train.png
data index: 3
error= 1.3953736554860259
dimension (observation): 0
steps: 100
[SAVE] : result_6_1/plot/3_data3_train.png
data index: 4
error= 1.7391668181572875
dimension (observation): 0
steps: 100
[SAVE] : result_6_1/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_2.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:18:59.663433: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:18:59.709809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:18:59.710052: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:18:59.710157: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:18:59.710255: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:18:59.710320: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:18:59.710376: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:18:59.710426: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:18:59.710500: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:18:59.710513: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:18:59.711132: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:18:59.738008: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:18:59.739235: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563688667d00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:18:59.739264: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:18:59.890292: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5636886ca010 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:18:59.890345: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:18:59.890452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:18:59.890461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 99.8763 (error=0.0907734), validation cost 100.769 (error=0.0854079)
epoch 10, training cost 8.67319 (error=0.0356782), validation cost 8.95988 (error=0.0368571)
epoch 20, training cost 5.45735 (error=0.0293193), validation cost 5.4508 (error=0.0292969)
epoch 30, training cost 4.30056 (error=0.0272201), validation cost 4.26938 (error=0.027025)
epoch 40, training cost 3.63636 (error=0.0250938), validation cost 3.64417 (error=0.0250402)
epoch 50, training cost 3.22351 (error=0.0241584), validation cost 3.24415 (error=0.0240866)
epoch 60, training cost 2.97434 (error=0.0233278), validation cost 2.99387 (error=0.0234683)
epoch 70, training cost 2.80823 (error=0.0230754), validation cost 2.82085 (error=0.0231911)
epoch 80, training cost 2.68452 (error=0.0228739), validation cost 2.68306 (error=0.0230822)
epoch 90, training cost 2.59368 (error=0.0227753), validation cost 2.57868 (error=0.0229535)
[RESULT] training cost 2.51954, validation cost 2.52962, training error 0.0227462, validation error 0.0228849
[SAVE] result_6_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_2/train.jbl
[SAVE] config:  config_adw_gen_6_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.2648576 -0.7931381]
[-0.2648576 -0.7931381]
data index: 0
error= 1.6424880115234128
dimension (observation): 0
steps: 100
[SAVE] : result_6_2/plot/0_data0_train.png
data index: 1
error= 2.969400823588972
dimension (observation): 0
steps: 100
[SAVE] : result_6_2/plot/1_data1_train.png
data index: 2
error= 1.4983263910329665
dimension (observation): 0
steps: 100
[SAVE] : result_6_2/plot/2_data2_train.png
data index: 3
error= 1.4147362530665726
dimension (observation): 0
steps: 100
[SAVE] : result_6_2/plot/3_data3_train.png
data index: 4
error= 1.7556215024010444
dimension (observation): 0
steps: 100
[SAVE] : result_6_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:22:35.129187: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:22:35.180569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:22:35.180716: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:22:35.180762: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:22:35.180804: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:22:35.180860: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:22:35.180911: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:22:35.180952: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:22:35.181002: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:22:35.181011: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:22:35.181508: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:22:35.205979: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:22:35.206991: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ff4a1b8900 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:22:35.207015: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:22:35.329070: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ff4a21ac10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:22:35.329113: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:22:35.329201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:22:35.329208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 645930 (error=0.61792), validation cost 647131 (error=0.622992)
epoch 10, training cost 27.5314 (error=0.0707371), validation cost 27.2607 (error=0.0727878)
epoch 20, training cost 24.9652 (error=0.0652052), validation cost 24.842 (error=0.0667034)
epoch 30, training cost 23.0902 (error=0.0624945), validation cost 22.9764 (error=0.063959)
epoch 40, training cost 21.3654 (error=0.0593462), validation cost 21.2823 (error=0.0604349)
epoch 50, training cost 19.7849 (error=0.0553518), validation cost 19.7294 (error=0.0571053)
epoch 60, training cost 18.4178 (error=0.0506856), validation cost 18.3098 (error=0.0518189)
epoch 70, training cost 17.1852 (error=0.0451262), validation cost 17.1771 (error=0.0463834)
epoch 80, training cost 16.0703 (error=0.0401585), validation cost 16.0196 (error=0.0408743)
epoch 90, training cost 15.1947 (error=0.0383234), validation cost 15.0948 (error=0.0387583)
[RESULT] training cost 14.4918, validation cost 14.3927, training error 0.0381688, validation error 0.0381869
[SAVE] result_6_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_3/train.jbl
[SAVE] config:  config_adw_gen_6_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.1538289  4.290699 ]
[-2.3935683  3.0548542]
data index: 0
error= 1.2344987811508168
dimension (observation): 0
steps: 100
[SAVE] : result_6_3/plot/0_data0_train.png
data index: 1
error= 4.480158142711869
dimension (observation): 0
steps: 100
[SAVE] : result_6_3/plot/1_data1_train.png
data index: 2
error= 1.624924226849026
dimension (observation): 0
steps: 100
[SAVE] : result_6_3/plot/2_data2_train.png
data index: 3
error= 1.2359601190336829
dimension (observation): 0
steps: 100
[SAVE] : result_6_3/plot/3_data3_train.png
data index: 4
error= 2.1636099855725273
dimension (observation): 0
steps: 100
[SAVE] : result_6_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:26:21.417541: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:26:21.465814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:26:21.466045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:26:21.466115: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:26:21.466215: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:26:21.466306: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:26:21.466388: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:26:21.466474: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:26:21.466531: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:26:21.466567: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:26:21.467284: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:26:21.494019: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:26:21.495591: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56198e985d80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:26:21.495622: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:26:21.652712: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56198e9e8090 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:26:21.652771: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:26:21.652887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:26:21.652897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 17975.8 (error=0.0397503), validation cost 16035.4 (error=0.0403359)
epoch 10, training cost 26.5068 (error=0.091802), validation cost 26.9966 (error=0.0942869)
epoch 20, training cost 12.8209 (error=0.0689739), validation cost 13.1693 (error=0.0711448)
epoch 30, training cost 3.57057 (error=0.024595), validation cost 3.60343 (error=0.0254462)
epoch 40, training cost 3.45542 (error=0.0237969), validation cost 3.48368 (error=0.0248335)
epoch 50, training cost 3.44057 (error=0.0237266), validation cost 3.47474 (error=0.0249736)
epoch 60, training cost 3.42507 (error=0.0235774), validation cost 3.45972 (error=0.0246962)
epoch 70, training cost 3.40931 (error=0.0233765), validation cost 3.44354 (error=0.0246913)
epoch 80, training cost 3.40245 (error=0.023497), validation cost 3.43265 (error=0.0245202)
epoch 90, training cost 3.38806 (error=0.0232657), validation cost 3.42408 (error=0.0246664)
[RESULT] training cost 3.37821, validation cost 3.40914, training error 0.0232423, validation error 0.024453
[SAVE] result_6_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_4/train.jbl
[SAVE] config:  config_adw_gen_6_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.2799518 -1.3538046]
[-1.2799518 -1.3538046]
data index: 0
error= 1.6479592492065611
dimension (observation): 0
steps: 100
[SAVE] : result_6_4/plot/0_data0_train.png
data index: 1
error= 3.070301988881881
dimension (observation): 0
steps: 100
[SAVE] : result_6_4/plot/1_data1_train.png
data index: 2
error= 1.613200512824715
dimension (observation): 0
steps: 100
[SAVE] : result_6_4/plot/2_data2_train.png
data index: 3
error= 1.4954807396602163
dimension (observation): 0
steps: 100
[SAVE] : result_6_4/plot/3_data3_train.png
data index: 4
error= 1.8533985201828296
dimension (observation): 0
steps: 100
[SAVE] : result_6_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:29:40.538255: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:29:40.592184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:29:40.592358: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:29:40.592437: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:29:40.592556: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:29:40.592629: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:29:40.592705: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:29:40.592767: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:29:40.592840: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:29:40.592854: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:29:40.593349: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:29:40.617960: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:29:40.619517: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cacf9ac7a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:29:40.619561: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:29:40.748308: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cacfa0eab0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:29:40.748357: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:29:40.748452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:29:40.748463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 9.29202 (error=0.0444828), validation cost 9.26472 (error=0.0452579)
epoch 10, training cost 3.71319 (error=0.023142), validation cost 3.74411 (error=0.0239015)
epoch 20, training cost 3.32266 (error=0.0226393), validation cost 3.34808 (error=0.023321)
epoch 30, training cost 3.15716 (error=0.0225939), validation cost 3.17484 (error=0.0232788)
epoch 40, training cost 3.00668 (error=0.0225753), validation cost 3.02722 (error=0.0232478)
epoch 50, training cost 2.87762 (error=0.0225667), validation cost 2.90053 (error=0.0232486)
epoch 60, training cost 2.80735 (error=0.0225686), validation cost 2.82903 (error=0.023232)
epoch 70, training cost 2.78519 (error=0.0225537), validation cost 2.80717 (error=0.0232051)
epoch 80, training cost 2.7757 (error=0.0225541), validation cost 2.79821 (error=0.0232319)
epoch 90, training cost 2.76978 (error=0.0225384), validation cost 2.79329 (error=0.0232258)
[RESULT] training cost 2.76527, validation cost 2.7891, training error 0.0225327, validation error 0.0232077
[SAVE] result_6_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_5/train.jbl
[SAVE] config:  config_adw_gen_6_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.47729385 -1.0184685 ]
[-0.50226927 -1.1399443 ]
data index: 0
error= 1.607487198985265
dimension (observation): 0
steps: 100
[SAVE] : result_6_5/plot/0_data0_train.png
data index: 1
error= 3.0153273435523937
dimension (observation): 0
steps: 100
[SAVE] : result_6_5/plot/1_data1_train.png
data index: 2
error= 1.4668686090383252
dimension (observation): 0
steps: 100
[SAVE] : result_6_5/plot/2_data2_train.png
data index: 3
error= 1.399778434018618
dimension (observation): 0
steps: 100
[SAVE] : result_6_5/plot/3_data3_train.png
data index: 4
error= 1.7062737033554876
dimension (observation): 0
steps: 100
[SAVE] : result_6_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:33:21.339700: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:33:21.388636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:33:21.388876: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:33:21.389013: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:33:21.389133: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:33:21.389226: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:33:21.389318: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:33:21.389423: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:33:21.389535: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:33:21.389545: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:33:21.390447: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:33:21.418023: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:33:21.419885: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5610bf429400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:33:21.419913: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:33:21.538861: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5610bf48b710 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:33:21.538898: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:33:21.538982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:33:21.538991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 1457.51 (error=0.062319), validation cost 1530.99 (error=0.0663299)
epoch 10, training cost 21.1864 (error=0.0227679), validation cost 21.3283 (error=0.0241578)
epoch 20, training cost 13.4963 (error=0.0225396), validation cost 13.3828 (error=0.0236927)
epoch 30, training cost 10.371 (error=0.0224917), validation cost 10.1701 (error=0.0235658)
epoch 40, training cost 8.35265 (error=0.0225144), validation cost 8.1886 (error=0.0237677)
epoch 50, training cost 7.10412 (error=0.0224745), validation cost 7.06151 (error=0.0235868)
epoch 60, training cost 6.18433 (error=0.0224568), validation cost 6.23883 (error=0.0235758)
epoch 70, training cost 5.56066 (error=0.0224837), validation cost 5.58665 (error=0.0235367)
epoch 80, training cost 5.08353 (error=0.0224677), validation cost 5.11361 (error=0.0236)
epoch 90, training cost 4.75916 (error=0.022483), validation cost 4.81048 (error=0.0236725)
[RESULT] training cost 4.49561, validation cost 4.52909, training error 0.0225091, validation error 0.0234923
[SAVE] result_6_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_6/train.jbl
[SAVE] config:  config_adw_gen_6_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.28464675  0.9503628 ]
[-0.28464675  0.9503628 ]
data index: 0
error= 1.6194941520008361
dimension (observation): 0
steps: 100
[SAVE] : result_6_6/plot/0_data0_train.png
data index: 1
error= 2.978160139639889
dimension (observation): 0
steps: 100
[SAVE] : result_6_6/plot/1_data1_train.png
data index: 2
error= 1.466187200919791
dimension (observation): 0
steps: 100
[SAVE] : result_6_6/plot/2_data2_train.png
data index: 3
error= 1.4123427149248866
dimension (observation): 0
steps: 100
[SAVE] : result_6_6/plot/3_data3_train.png
data index: 4
error= 1.7287370242154074
dimension (observation): 0
steps: 100
[SAVE] : result_6_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:36:56.911711: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:36:56.961589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:36:56.961813: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:36:56.961916: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:36:56.961976: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:36:56.962041: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:36:56.962101: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:36:56.962155: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:36:56.962197: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:36:56.962216: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:36:56.962740: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:36:56.989972: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:36:56.991150: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558af1d9ad00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:36:56.991201: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:36:57.114163: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558af1dfd010 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:36:57.114200: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:36:57.114297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:36:57.114306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 15.5023 (error=0.163072), validation cost 16.0153 (error=0.174208)
epoch 10, training cost 3.83814 (error=0.0271181), validation cost 3.87201 (error=0.0290959)
epoch 20, training cost 3.47723 (error=0.0231062), validation cost 3.51179 (error=0.0243062)
epoch 30, training cost 3.30384 (error=0.0226289), validation cost 3.34221 (error=0.0239247)
epoch 40, training cost 3.2227 (error=0.022579), validation cost 3.26768 (error=0.0237965)
epoch 50, training cost 3.18621 (error=0.0225137), validation cost 3.23126 (error=0.0237024)
epoch 60, training cost 3.16753 (error=0.0225153), validation cost 3.21375 (error=0.0237299)
epoch 70, training cost 3.15736 (error=0.0225254), validation cost 3.20285 (error=0.0237317)
epoch 80, training cost 3.15025 (error=0.0225023), validation cost 3.19499 (error=0.0236969)
epoch 90, training cost 3.1445 (error=0.0225041), validation cost 3.1938 (error=0.023784)
[RESULT] training cost 3.1408, validation cost 3.18629, training error 0.0224969, validation error 0.0237221
[SAVE] result_6_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_7/train.jbl
[SAVE] config:  config_adw_gen_6_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.58145386  0.30884805]
[-0.831041   -0.22350839]
data index: 0
error= 1.480409659246858
dimension (observation): 0
steps: 100
[SAVE] : result_6_7/plot/0_data0_train.png
data index: 1
error= 2.965104901937302
dimension (observation): 0
steps: 100
[SAVE] : result_6_7/plot/1_data1_train.png
data index: 2
error= 1.325557961377343
dimension (observation): 0
steps: 100
[SAVE] : result_6_7/plot/2_data2_train.png
data index: 3
error= 1.2731873445036617
dimension (observation): 0
steps: 100
[SAVE] : result_6_7/plot/3_data3_train.png
data index: 4
error= 1.5406369967204383
dimension (observation): 0
steps: 100
[SAVE] : result_6_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:40:24.245648: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:40:24.291503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:40:24.291661: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:40:24.291706: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:40:24.291746: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:40:24.291788: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:40:24.291827: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:40:24.291865: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:40:24.291905: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:40:24.291912: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:40:24.292363: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:40:24.317970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:40:24.319410: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56304a8acc70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:40:24.319442: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:40:24.455986: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56304a90ef80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:40:24.456057: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:40:24.456207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:40:24.456218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 620.015 (error=0.10673), validation cost 604.074 (error=0.102268)
epoch 10, training cost 6.64955 (error=0.0243679), validation cost 6.81908 (error=0.0257219)
epoch 20, training cost 5.0752 (error=0.0244725), validation cost 5.13757 (error=0.0258474)
epoch 30, training cost 4.63103 (error=0.0232382), validation cost 4.65661 (error=0.0242898)
epoch 40, training cost 4.56339 (error=0.0229174), validation cost 4.59224 (error=0.0239777)
epoch 50, training cost 4.50063 (error=0.0226917), validation cost 4.54252 (error=0.0237444)
epoch 60, training cost 4.44997 (error=0.0226082), validation cost 4.47875 (error=0.0236045)
epoch 70, training cost 4.40089 (error=0.0225374), validation cost 4.4309 (error=0.0235182)
epoch 80, training cost 4.34866 (error=0.022507), validation cost 4.38547 (error=0.0234771)
epoch 90, training cost 4.30594 (error=0.0224789), validation cost 4.33928 (error=0.0234008)
[RESULT] training cost 4.26479, validation cost 4.30145, training error 0.0224632, validation error 0.0233928
[SAVE] result_6_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_8/train.jbl
[SAVE] config:  config_adw_gen_6_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.8982561  1.0541953]
[-0.90296644  0.90855205]
data index: 0
error= 1.5448244772561996
dimension (observation): 0
steps: 100
[SAVE] : result_6_8/plot/0_data0_train.png
data index: 1
error= 2.993729287679349
dimension (observation): 0
steps: 100
[SAVE] : result_6_8/plot/1_data1_train.png
data index: 2
error= 1.3587913386301496
dimension (observation): 0
steps: 100
[SAVE] : result_6_8/plot/2_data2_train.png
data index: 3
error= 1.295018104874284
dimension (observation): 0
steps: 100
[SAVE] : result_6_8/plot/3_data3_train.png
data index: 4
error= 1.5660994650407565
dimension (observation): 0
steps: 100
[SAVE] : result_6_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:44:02.221555: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:44:02.274566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:44:02.275037: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:44:02.275190: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:44:02.275312: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:44:02.275411: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:44:02.275514: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:44:02.275593: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:44:02.275643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:44:02.275651: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:44:02.276131: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:44:02.306224: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:44:02.308922: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563c7368e370 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:44:02.309094: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:44:02.450696: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563c736f0680 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:44:02.450746: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:44:02.450883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:44:02.450892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 1.12454e+06 (error=0.0793492), validation cost 1.11958e+06 (error=0.0788937)
epoch 10, training cost 30.1588 (error=0.0512542), validation cost 29.8322 (error=0.0501441)
epoch 20, training cost 25.6242 (error=0.0413659), validation cost 25.4858 (error=0.0401271)
epoch 30, training cost 25.0082 (error=0.0326072), validation cost 24.8983 (error=0.0316226)
epoch 40, training cost 24.7425 (error=0.0285193), validation cost 24.7853 (error=0.0274562)
epoch 50, training cost 24.2887 (error=0.0249967), validation cost 24.3125 (error=0.0242068)
epoch 60, training cost 23.9612 (error=0.0240994), validation cost 23.9897 (error=0.0232241)
epoch 70, training cost 23.784 (error=0.0240795), validation cost 23.7583 (error=0.0232081)
epoch 80, training cost 23.2624 (error=0.0240482), validation cost 23.4189 (error=0.023232)
epoch 90, training cost 23.1832 (error=0.0238101), validation cost 23.2999 (error=0.0230356)
[RESULT] training cost 22.9522, validation cost 23.0406, training error 0.0235803, validation error 0.0225723
[SAVE] result_6_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_9/train.jbl
[SAVE] config:  config_adw_gen_6_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.15018712  1.2605705 ]
[-0.15018712  1.2605705 ]
data index: 0
error= 1.5585708828650588
dimension (observation): 0
steps: 100
[SAVE] : result_6_9/plot/0_data0_train.png
data index: 1
error= 3.0810807670549942
dimension (observation): 0
steps: 100
[SAVE] : result_6_9/plot/1_data1_train.png
data index: 2
error= 1.5774175775255639
dimension (observation): 0
steps: 100
[SAVE] : result_6_9/plot/2_data2_train.png
data index: 3
error= 1.5120615351287388
dimension (observation): 0
steps: 100
[SAVE] : result_6_9/plot/3_data3_train.png
data index: 4
error= 1.8260109137145006
dimension (observation): 0
steps: 100
[SAVE] : result_6_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_6_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:47:11.302970: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:47:11.346191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:47:11.346402: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:47:11.346479: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:47:11.346566: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:47:11.346655: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:47:11.346731: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:47:11.346794: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:47:11.346868: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:47:11.346877: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:47:11.347382: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:47:11.373965: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:47:11.375114: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5612fd8d1e30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:47:11.375138: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:47:11.525965: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5612fd934140 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:47:11.526027: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:47:11.526131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:47:11.526139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 448.455 (error=0.0694134), validation cost 502.782 (error=0.0766839)
epoch 10, training cost 9.85697 (error=0.0406634), validation cost 10.2546 (error=0.0408906)
epoch 20, training cost 6.16128 (error=0.0283725), validation cost 6.35012 (error=0.0285486)
epoch 30, training cost 5.14163 (error=0.0230861), validation cost 5.22272 (error=0.0238454)
epoch 40, training cost 4.58219 (error=0.0196675), validation cost 4.6602 (error=0.0206007)
epoch 50, training cost 4.24838 (error=0.0170294), validation cost 4.33241 (error=0.0183315)
epoch 60, training cost 4.06854 (error=0.0158233), validation cost 4.12985 (error=0.0167842)
epoch 70, training cost 3.96321 (error=0.0154376), validation cost 4.01641 (error=0.0161434)
epoch 80, training cost 3.85655 (error=0.0146814), validation cost 3.9327 (error=0.0157902)
epoch 90, training cost 3.79453 (error=0.0143443), validation cost 3.85363 (error=0.0152337)
[RESULT] training cost 3.73522, validation cost 3.79911, training error 0.0136574, validation error 0.0146129
[SAVE] result_6_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_6_10/train.jbl
[SAVE] config:  config_adw_gen_6_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_6_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.7332573  0.7812074]
[-1.2985553  -0.55455416]
data index: 0
error= 1.7791967568120342
dimension (observation): 0
steps: 100
[SAVE] : result_6_10/plot/0_data0_train.png
data index: 1
error= 3.3442948430251724
dimension (observation): 0
steps: 100
[SAVE] : result_6_10/plot/1_data1_train.png
data index: 2
error= 2.1734493068369467
dimension (observation): 0
steps: 100
[SAVE] : result_6_10/plot/2_data2_train.png
data index: 3
error= 0.8933797571005215
dimension (observation): 0
steps: 100
[SAVE] : result_6_10/plot/3_data3_train.png
data index: 4
error= 3.425088644301085
dimension (observation): 0
steps: 100
[SAVE] : result_6_10/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_1.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:50:46.099584: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:50:46.136891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:50:46.137101: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:50:46.137183: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:50:46.137283: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:50:46.137385: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:50:46.137478: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:50:46.137553: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:50:46.137634: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:50:46.137646: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:50:46.138180: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:50:46.165992: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:50:46.167481: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55eb1ed1e000 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:50:46.167511: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:50:46.319300: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55eb1ed80310 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:50:46.319354: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:50:46.319470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:50:46.319486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 226.833 (error=0.467309), validation cost 225.195 (error=0.463507)
epoch 10, training cost 5.99462 (error=0.0207289), validation cost 6.01054 (error=0.0215756)
epoch 20, training cost 3.924 (error=0.0237979), validation cost 3.93641 (error=0.0238286)
epoch 30, training cost 3.30121 (error=0.0240395), validation cost 3.31845 (error=0.0243161)
epoch 40, training cost 2.93952 (error=0.0235944), validation cost 2.96614 (error=0.0242652)
epoch 50, training cost 2.6903 (error=0.0232357), validation cost 2.71258 (error=0.0237754)
epoch 60, training cost 2.53771 (error=0.0229598), validation cost 2.56213 (error=0.0236501)
epoch 70, training cost 2.45421 (error=0.0228638), validation cost 2.46931 (error=0.0232619)
epoch 80, training cost 2.39771 (error=0.0227558), validation cost 2.417 (error=0.0233388)
epoch 90, training cost 2.35059 (error=0.0227226), validation cost 2.36962 (error=0.0232353)
[RESULT] training cost 2.31244, validation cost 2.33107, training error 0.0226568, validation error 0.0232077
[SAVE] result_7_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_1/train.jbl
[SAVE] config:  config_adw_gen_7_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.31850252 -1.0597404 ]
[-2.4234774 -4.634275 ]
data index: 0
error= 1.622224893416836
dimension (observation): 0
steps: 100
[SAVE] : result_7_1/plot/0_data0_train.png
data index: 1
error= 2.945221593710261
dimension (observation): 0
steps: 100
[SAVE] : result_7_1/plot/1_data1_train.png
data index: 2
error= 1.492745123483585
dimension (observation): 0
steps: 100
[SAVE] : result_7_1/plot/2_data2_train.png
data index: 3
error= 1.4364164083526905
dimension (observation): 0
steps: 100
[SAVE] : result_7_1/plot/3_data3_train.png
data index: 4
error= 1.676622779011472
dimension (observation): 0
steps: 100
[SAVE] : result_7_1/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_2.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:54:35.828721: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:54:35.881639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:54:35.881976: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:54:35.882115: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:54:35.882238: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:54:35.882395: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:54:35.882494: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:54:35.882651: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:54:35.882762: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:54:35.882813: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:54:35.883653: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:54:35.914012: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:54:35.915984: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5635380a1110 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:54:35.916071: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:54:36.062047: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563538103420 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:54:36.062087: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:54:36.062176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:54:36.062182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 441170 (error=0.136036), validation cost 433729 (error=0.143116)
epoch 10, training cost 4793.54 (error=0.0573899), validation cost 3245.96 (error=0.0580786)
epoch 20, training cost 1330.19 (error=0.037847), validation cost 1424.39 (error=0.0389203)
epoch 30, training cost 1145.18 (error=0.0316197), validation cost 1023.81 (error=0.0320436)
epoch 40, training cost 578.24 (error=0.0281141), validation cost 502.63 (error=0.0283019)
epoch 50, training cost 593.659 (error=0.0257948), validation cost 495.398 (error=0.0258637)
epoch 60, training cost 449.6 (error=0.0242107), validation cost 392.584 (error=0.0247472)
epoch 70, training cost 402.414 (error=0.023478), validation cost 358.746 (error=0.0239812)
epoch 80, training cost 318.53 (error=0.0230482), validation cost 294.933 (error=0.0235636)
epoch 90, training cost 279.153 (error=0.0228813), validation cost 245.013 (error=0.0233349)
[RESULT] training cost 223.204, validation cost 281.958, training error 0.0227932, validation error 0.0231264
[SAVE] result_7_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_2/train.jbl
[SAVE] config:  config_adw_gen_7_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.5611344  0.18670423]
[0.5611344  0.18670423]
data index: 0
error= 1.5469822237272008
dimension (observation): 0
steps: 100
[SAVE] : result_7_2/plot/0_data0_train.png
data index: 1
error= 2.999040452786373
dimension (observation): 0
steps: 100
[SAVE] : result_7_2/plot/1_data1_train.png
data index: 2
error= 1.4053887852369027
dimension (observation): 0
steps: 100
[SAVE] : result_7_2/plot/2_data2_train.png
data index: 3
error= 1.2968285870259892
dimension (observation): 0
steps: 100
[SAVE] : result_7_2/plot/3_data3_train.png
data index: 4
error= 1.5933321563732226
dimension (observation): 0
steps: 100
[SAVE] : result_7_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 19:57:35.814606: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 19:57:35.851529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 19:57:35.851657: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:57:35.851699: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:57:35.851738: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:57:35.851777: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:57:35.851816: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:57:35.851853: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 19:57:35.851891: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 19:57:35.851898: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 19:57:35.852270: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 19:57:35.877977: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 19:57:35.879148: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5593a4cdfdb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:57:35.879184: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 19:57:36.022666: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5593a4d420c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 19:57:36.022707: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 19:57:36.022833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 19:57:36.022842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 1974.9 (error=0.0513997), validation cost 1286.57 (error=0.0530736)
epoch 10, training cost 9.93796 (error=0.0264033), validation cost 10.2435 (error=0.0253275)
epoch 20, training cost 7.69549 (error=0.0305817), validation cost 7.65476 (error=0.0289706)
epoch 30, training cost 6.68987 (error=0.0292859), validation cost 6.66331 (error=0.0285358)
epoch 40, training cost 6.47213 (error=0.0273502), validation cost 6.44183 (error=0.0259505)
epoch 50, training cost 6.23259 (error=0.0266063), validation cost 6.19896 (error=0.0253892)
epoch 60, training cost 5.99519 (error=0.0255982), validation cost 5.95642 (error=0.0246431)
epoch 70, training cost 5.80411 (error=0.0247853), validation cost 5.76724 (error=0.0239993)
epoch 80, training cost 5.60811 (error=0.0243379), validation cost 5.57526 (error=0.0232567)
epoch 90, training cost 5.42785 (error=0.0240503), validation cost 5.39978 (error=0.0226818)
[RESULT] training cost 5.26124, validation cost 5.22147, training error 0.0237917, validation error 0.0224715
[SAVE] result_7_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_3/train.jbl
[SAVE] config:  config_adw_gen_7_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.6578412 2.4612665]
[1.3085383  0.80387205]
data index: 0
error= 1.6280658249301228
dimension (observation): 0
steps: 100
[SAVE] : result_7_3/plot/0_data0_train.png
data index: 1
error= 3.0515028343818678
dimension (observation): 0
steps: 100
[SAVE] : result_7_3/plot/1_data1_train.png
data index: 2
error= 1.613399192271183
dimension (observation): 0
steps: 100
[SAVE] : result_7_3/plot/2_data2_train.png
data index: 3
error= 1.5255989094826874
dimension (observation): 0
steps: 100
[SAVE] : result_7_3/plot/3_data3_train.png
data index: 4
error= 1.8104331196080943
dimension (observation): 0
steps: 100
[SAVE] : result_7_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:01:09.007987: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:01:09.042309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:01:09.042444: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:01:09.042497: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:01:09.042538: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:01:09.042579: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:01:09.042617: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:01:09.042656: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:01:09.042695: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:01:09.042701: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:01:09.043067: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:01:09.081979: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:01:09.083872: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556302e20e60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:01:09.083925: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:01:09.240267: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556302e83170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:01:09.240321: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:01:09.240447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:01:09.240453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 742.296 (error=0.143615), validation cost 637.841 (error=0.124607)
epoch 10, training cost 13.7522 (error=0.0333455), validation cost 13.0501 (error=0.0299805)
epoch 20, training cost 10.9516 (error=0.0331404), validation cost 10.492 (error=0.0325076)
epoch 30, training cost 9.32437 (error=0.0336866), validation cost 8.9281 (error=0.0338391)
epoch 40, training cost 8.14885 (error=0.0334208), validation cost 7.93172 (error=0.0344138)
epoch 50, training cost 7.29688 (error=0.0332882), validation cost 7.03651 (error=0.0332696)
epoch 60, training cost 6.60564 (error=0.0325911), validation cost 6.40667 (error=0.0330317)
epoch 70, training cost 6.03272 (error=0.0320671), validation cost 5.91642 (error=0.0324569)
epoch 80, training cost 5.58193 (error=0.0310314), validation cost 5.43601 (error=0.0318666)
epoch 90, training cost 5.19935 (error=0.0306206), validation cost 5.07931 (error=0.0309468)
[RESULT] training cost 4.88282, validation cost 4.78162, training error 0.0297727, validation error 0.0301074
[SAVE] result_7_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_4/train.jbl
[SAVE] config:  config_adw_gen_7_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.69279766  0.723761  ]
[-0.69279766  0.723761  ]
data index: 0
error= 2.509056295775548
dimension (observation): 0
steps: 100
[SAVE] : result_7_4/plot/0_data0_train.png
data index: 1
error= 3.6204606443398757
dimension (observation): 0
steps: 100
[SAVE] : result_7_4/plot/1_data1_train.png
data index: 2
error= 2.5975774816890445
dimension (observation): 0
steps: 100
[SAVE] : result_7_4/plot/2_data2_train.png
data index: 3
error= 2.514622352640738
dimension (observation): 0
steps: 100
[SAVE] : result_7_4/plot/3_data3_train.png
data index: 4
error= 2.1645572342649753
dimension (observation): 0
steps: 100
[SAVE] : result_7_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:04:50.977159: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:04:51.028283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:04:51.028494: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:04:51.028581: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:04:51.028653: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:04:51.028719: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:04:51.028765: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:04:51.028812: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:04:51.028859: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:04:51.028867: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:04:51.029437: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:04:51.058018: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:04:51.062306: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56457b67a340 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:04:51.062367: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:04:51.199797: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56457b6dc650 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:04:51.199849: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:04:51.200002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:04:51.200013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 370.044 (error=0.107035), validation cost 374.233 (error=0.104447)
epoch 10, training cost 15.1802 (error=0.0372346), validation cost 15.1001 (error=0.0365401)
epoch 20, training cost 11.1882 (error=0.0346212), validation cost 11.1243 (error=0.0341323)
epoch 30, training cost 8.95218 (error=0.0341041), validation cost 8.92505 (error=0.0338635)
epoch 40, training cost 7.31219 (error=0.0330687), validation cost 7.28209 (error=0.0327075)
epoch 50, training cost 6.11025 (error=0.0323412), validation cost 6.08908 (error=0.0318786)
epoch 60, training cost 5.22753 (error=0.0312774), validation cost 5.20282 (error=0.0304252)
epoch 70, training cost 4.58557 (error=0.0301643), validation cost 4.56102 (error=0.0297835)
epoch 80, training cost 4.1069 (error=0.0294817), validation cost 4.10749 (error=0.0295384)
epoch 90, training cost 3.75428 (error=0.0284998), validation cost 3.7348 (error=0.0280234)
[RESULT] training cost 3.49791, validation cost 3.48129, training error 0.0276165, validation error 0.027012
[SAVE] result_7_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_5/train.jbl
[SAVE] config:  config_adw_gen_7_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.33929384  0.66124225]
[-0.5475569  -0.08253181]
data index: 0
error= 1.6020113861551817
dimension (observation): 0
steps: 100
[SAVE] : result_7_5/plot/0_data0_train.png
data index: 1
error= 3.8768411080001877
dimension (observation): 0
steps: 100
[SAVE] : result_7_5/plot/1_data1_train.png
data index: 2
error= 1.5671289529193495
dimension (observation): 0
steps: 100
[SAVE] : result_7_5/plot/2_data2_train.png
data index: 3
error= 1.6218059965200653
dimension (observation): 0
steps: 100
[SAVE] : result_7_5/plot/3_data3_train.png
data index: 4
error= 2.1829323570071506
dimension (observation): 0
steps: 100
[SAVE] : result_7_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:08:35.494389: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:08:35.534771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:08:35.534926: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:08:35.534981: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:08:35.535032: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:08:35.535084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:08:35.535135: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:08:35.535196: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:08:35.535249: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:08:35.535258: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:08:35.535684: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:08:35.561992: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:08:35.563547: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562b7e57b7d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:08:35.563610: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:08:35.701572: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562b7e5ddae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:08:35.701621: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:08:35.701741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:08:35.701761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 1.26993e+06 (error=0.202824), validation cost 1.28974e+06 (error=0.205462)
epoch 10, training cost 50.5045 (error=0.0145469), validation cost 51.1027 (error=0.0148728)
epoch 20, training cost 32.6388 (error=0.0157536), validation cost 32.9738 (error=0.016033)
epoch 30, training cost 24.3296 (error=0.0172453), validation cost 23.891 (error=0.0172243)
epoch 40, training cost 19.4107 (error=0.0166272), validation cost 19.6612 (error=0.0167478)
epoch 50, training cost 16.4161 (error=0.0161623), validation cost 16.8082 (error=0.0162372)
epoch 60, training cost 14.5699 (error=0.0154877), validation cost 14.7798 (error=0.0156884)
epoch 70, training cost 13.0138 (error=0.0148967), validation cost 13.1299 (error=0.0152784)
epoch 80, training cost 11.9511 (error=0.0142813), validation cost 12.0691 (error=0.0145461)
epoch 90, training cost 11.0243 (error=0.0135059), validation cost 11.127 (error=0.0137441)
[RESULT] training cost 10.4905, validation cost 10.5064, training error 0.0131142, validation error 0.01309
[SAVE] result_7_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_6/train.jbl
[SAVE] config:  config_adw_gen_7_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.02657998  0.8009217 ]
[-1.4536691 -1.0872134]
data index: 0
error= 3.826982963704058
dimension (observation): 0
steps: 100
[SAVE] : result_7_6/plot/0_data0_train.png
data index: 1
error= 5.729218508706623
dimension (observation): 0
steps: 100
[SAVE] : result_7_6/plot/1_data1_train.png
data index: 2
error= 0.786235813676874
dimension (observation): 0
steps: 100
[SAVE] : result_7_6/plot/2_data2_train.png
data index: 3
error= 1.5558128302610124
dimension (observation): 0
steps: 100
[SAVE] : result_7_6/plot/3_data3_train.png
data index: 4
error= 2.076230823780515
dimension (observation): 0
steps: 100
[SAVE] : result_7_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:12:07.972089: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:12:08.007250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:12:08.007400: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:12:08.007453: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:12:08.007497: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:12:08.007552: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:12:08.007598: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:12:08.007636: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:12:08.007696: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:12:08.007705: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:12:08.008148: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:12:08.037991: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:12:08.039177: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e170de21e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:12:08.039201: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:12:08.211847: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e170e444f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:12:08.211921: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:12:08.212076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:12:08.212085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 955.013 (error=0.027662), validation cost 950.395 (error=0.0274696)
epoch 10, training cost 12.3917 (error=0.0442957), validation cost 12.5238 (error=0.0443749)
epoch 20, training cost 8.15263 (error=0.0246338), validation cost 8.13712 (error=0.024583)
epoch 30, training cost 7.21447 (error=0.0238286), validation cost 7.21273 (error=0.0239071)
epoch 40, training cost 6.62571 (error=0.0232093), validation cost 6.60806 (error=0.0231293)
epoch 50, training cost 6.23985 (error=0.023119), validation cost 6.23107 (error=0.0230117)
epoch 60, training cost 5.93762 (error=0.0230274), validation cost 5.94289 (error=0.02309)
epoch 70, training cost 5.70806 (error=0.0230467), validation cost 5.69717 (error=0.0230037)
epoch 80, training cost 5.51836 (error=0.0230177), validation cost 5.50734 (error=0.0230158)
epoch 90, training cost 5.35573 (error=0.0229743), validation cost 5.35923 (error=0.0230623)
[RESULT] training cost 5.22633, validation cost 5.22148, training error 0.0230174, validation error 0.0231495
[SAVE] result_7_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_7/train.jbl
[SAVE] config:  config_adw_gen_7_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[2.48061    0.40025353]
[ 1.204673   -0.25972694]
data index: 0
error= 1.6322773444576626
dimension (observation): 0
steps: 100
[SAVE] : result_7_7/plot/0_data0_train.png
data index: 1
error= 3.007870128181858
dimension (observation): 0
steps: 100
[SAVE] : result_7_7/plot/1_data1_train.png
data index: 2
error= 1.523002799404265
dimension (observation): 0
steps: 100
[SAVE] : result_7_7/plot/2_data2_train.png
data index: 3
error= 1.3758513530964074
dimension (observation): 0
steps: 100
[SAVE] : result_7_7/plot/3_data3_train.png
data index: 4
error= 1.6889095799993712
dimension (observation): 0
steps: 100
[SAVE] : result_7_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:15:49.208338: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:15:49.245854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:15:49.246048: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:15:49.246102: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:15:49.246150: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:15:49.246192: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:15:49.246233: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:15:49.246275: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:15:49.246315: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:15:49.246324: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:15:49.246762: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:15:49.269969: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:15:49.271037: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5577948905d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:15:49.271060: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:15:49.420277: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5577948f28e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:15:49.420322: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:15:49.420430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:15:49.420438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 178.387 (error=0.0597958), validation cost 169.223 (error=0.0554974)
epoch 10, training cost 5.16274 (error=0.0370012), validation cost 5.24318 (error=0.0392488)
epoch 20, training cost 4.13836 (error=0.0272721), validation cost 4.1672 (error=0.0282328)
epoch 30, training cost 3.63694 (error=0.0238955), validation cost 3.66702 (error=0.0249446)
epoch 40, training cost 3.49108 (error=0.0230645), validation cost 3.50837 (error=0.0237388)
epoch 50, training cost 3.43253 (error=0.0228718), validation cost 3.45146 (error=0.0234616)
epoch 60, training cost 3.40324 (error=0.0227886), validation cost 3.42163 (error=0.023358)
epoch 70, training cost 3.38917 (error=0.0227694), validation cost 3.40676 (error=0.0232763)
epoch 80, training cost 3.37853 (error=0.0227541), validation cost 3.39651 (error=0.0233246)
epoch 90, training cost 3.36745 (error=0.0226684), validation cost 3.38539 (error=0.0232785)
[RESULT] training cost 3.3557, validation cost 3.38073, training error 0.02271, validation error 0.0233817
[SAVE] result_7_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_8/train.jbl
[SAVE] config:  config_adw_gen_7_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.4870726  0.39365017]
[1.4870726  0.39365017]
data index: 0
error= 1.76598327134791
dimension (observation): 0
steps: 100
[SAVE] : result_7_8/plot/0_data0_train.png
data index: 1
error= 2.9976868142757547
dimension (observation): 0
steps: 100
[SAVE] : result_7_8/plot/1_data1_train.png
data index: 2
error= 1.5554559524327718
dimension (observation): 0
steps: 100
[SAVE] : result_7_8/plot/2_data2_train.png
data index: 3
error= 1.545315843354973
dimension (observation): 0
steps: 100
[SAVE] : result_7_8/plot/3_data3_train.png
data index: 4
error= 1.8473351720318243
dimension (observation): 0
steps: 100
[SAVE] : result_7_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:19:19.726748: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:19:19.762662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:19:19.762817: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:19:19.762869: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:19:19.762914: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:19:19.762956: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:19:19.762998: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:19:19.763037: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:19:19.763076: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:19:19.763083: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:19:19.763442: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:19:19.789998: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:19:19.791745: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ad7da12650 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:19:19.791795: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:19:19.943069: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ad7da74960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:19:19.943116: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:19:19.943226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:19:19.943234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 18.4236 (error=0.0450775), validation cost 18.7725 (error=0.0446853)
epoch 10, training cost 5.31966 (error=0.0341064), validation cost 5.28345 (error=0.0346296)
epoch 20, training cost 4.42809 (error=0.0249492), validation cost 4.41921 (error=0.0254041)
epoch 30, training cost 3.91757 (error=0.0204771), validation cost 3.91446 (error=0.0202164)
epoch 40, training cost 3.70243 (error=0.0180243), validation cost 3.7136 (error=0.0177976)
epoch 50, training cost 3.54366 (error=0.0159925), validation cost 3.5356 (error=0.0156037)
epoch 60, training cost 3.37236 (error=0.0127808), validation cost 3.34769 (error=0.0124484)
epoch 70, training cost 3.09466 (error=0.00786198), validation cost 3.09238 (error=0.00766135)
epoch 80, training cost 2.7281 (error=0.00395798), validation cost 2.71498 (error=0.00383254)
epoch 90, training cost 2.46775 (error=0.00242673), validation cost 2.43246 (error=0.00236636)
[RESULT] training cost 2.34706, validation cost 2.33198, training error 0.00189283, validation error 0.00180786
[SAVE] result_7_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_9/train.jbl
[SAVE] config:  config_adw_gen_7_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 5.5713277  -0.01159263]
[ 1.1489583 -1.099414 ]
data index: 0
error= 8.140510476248341
dimension (observation): 0
steps: 100
[SAVE] : result_7_9/plot/0_data0_train.png
data index: 1
error= 9.238086671418614
dimension (observation): 0
steps: 100
[SAVE] : result_7_9/plot/1_data1_train.png
data index: 2
error= 7.78938326028224
dimension (observation): 0
steps: 100
[SAVE] : result_7_9/plot/2_data2_train.png
data index: 3
error= 4.454165526473563
dimension (observation): 0
steps: 100
[SAVE] : result_7_9/plot/3_data3_train.png
data index: 4
error= 2.4557758861708807
dimension (observation): 0
steps: 100
[SAVE] : result_7_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_7_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:23:11.511319: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:23:11.555975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:23:11.556210: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:23:11.556304: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:23:11.556390: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:23:11.556455: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:23:11.556524: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:23:11.556619: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:23:11.556671: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:23:11.556682: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:23:11.557150: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:23:11.590071: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:23:11.592069: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f3ff200520 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:23:11.592099: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:23:11.749157: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f3ff262830 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:23:11.749200: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:23:11.749291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:23:11.749297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 319.573 (error=0.0301848), validation cost 332.963 (error=0.0316891)
epoch 10, training cost 16.2143 (error=0.0238234), validation cost 16.1475 (error=0.0225483)
epoch 20, training cost 11.6878 (error=0.0235378), validation cost 11.5954 (error=0.0227028)
epoch 30, training cost 9.20388 (error=0.0234086), validation cost 9.14822 (error=0.0227291)
epoch 40, training cost 7.67819 (error=0.0233235), validation cost 7.62489 (error=0.0228814)
epoch 50, training cost 6.65553 (error=0.0231914), validation cost 6.62263 (error=0.0229348)
epoch 60, training cost 5.95675 (error=0.0231448), validation cost 5.93052 (error=0.0228363)
epoch 70, training cost 5.44503 (error=0.023193), validation cost 5.41809 (error=0.0228236)
epoch 80, training cost 5.06986 (error=0.023135), validation cost 5.04661 (error=0.0228773)
epoch 90, training cost 4.787 (error=0.0231019), validation cost 4.76048 (error=0.0227654)
[RESULT] training cost 4.56441, validation cost 4.53196, training error 0.0230748, validation error 0.0226779
[SAVE] result_7_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_7_10/train.jbl
[SAVE] config:  config_adw_gen_7_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_7_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.278034    0.46574414]
[-0.278034    0.46574414]
data index: 0
error= 1.732457478848267
dimension (observation): 0
steps: 100
[SAVE] : result_7_10/plot/0_data0_train.png
data index: 1
error= 2.95834491751382
dimension (observation): 0
steps: 100
[SAVE] : result_7_10/plot/1_data1_train.png
data index: 2
error= 1.5499751957167502
dimension (observation): 0
steps: 100
[SAVE] : result_7_10/plot/2_data2_train.png
data index: 3
error= 1.4963863189174482
dimension (observation): 0
steps: 100
[SAVE] : result_7_10/plot/3_data3_train.png
data index: 4
error= 1.8006107674343494
dimension (observation): 0
steps: 100
[SAVE] : result_7_10/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_1.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:27:13.129274: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:27:13.169587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:27:13.169795: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:27:13.169889: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:27:13.169941: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:27:13.169998: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:27:13.170044: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:27:13.170106: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:27:13.170168: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:27:13.170186: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:27:13.170631: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:27:13.201964: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:27:13.203088: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555a506788a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:27:13.203115: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:27:13.353825: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555a506dabb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:27:13.353886: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:27:13.354007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:27:13.354019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 2966.41 (error=0.0429739), validation cost 2995.92 (error=0.0428637)
epoch 10, training cost 16.2933 (error=0.0234161), validation cost 16.0018 (error=0.0232244)
epoch 20, training cost 8.977 (error=0.0213165), validation cost 9.04789 (error=0.0211997)
epoch 30, training cost 6.87686 (error=0.0217596), validation cost 6.95066 (error=0.0218027)
epoch 40, training cost 5.88846 (error=0.0222306), validation cost 5.91458 (error=0.0220169)
epoch 50, training cost 5.17817 (error=0.0224657), validation cost 5.24734 (error=0.0223683)
epoch 60, training cost 4.83466 (error=0.022571), validation cost 4.85166 (error=0.0224557)
epoch 70, training cost 4.54721 (error=0.0226555), validation cost 4.50642 (error=0.0224842)
epoch 80, training cost 4.26846 (error=0.0227282), validation cost 4.28307 (error=0.0226094)
epoch 90, training cost 4.08415 (error=0.0226906), validation cost 4.43405 (error=0.0225575)
[RESULT] training cost 3.89824, validation cost 3.93469, training error 0.0226852, validation error 0.0225523
[SAVE] result_8_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_1/train.jbl
[SAVE] config:  config_adw_gen_8_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.03815573 1.1661364 ]
[-0.673872   -0.09437072]
data index: 0
error= 1.6418175799945005
dimension (observation): 0
steps: 100
[SAVE] : result_8_1/plot/0_data0_train.png
data index: 1
error= 3.033219974879875
dimension (observation): 0
steps: 100
[SAVE] : result_8_1/plot/1_data1_train.png
data index: 2
error= 1.4785933018866144
dimension (observation): 0
steps: 100
[SAVE] : result_8_1/plot/2_data2_train.png
data index: 3
error= 1.4240658425177244
dimension (observation): 0
steps: 100
[SAVE] : result_8_1/plot/3_data3_train.png
data index: 4
error= 1.7141569620238124
dimension (observation): 0
steps: 100
[SAVE] : result_8_1/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_2.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:30:28.654853: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:30:28.704837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:30:28.705004: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:30:28.705062: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:30:28.705112: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:30:28.705178: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:30:28.705230: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:30:28.705270: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:30:28.705311: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:30:28.705320: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:30:28.705841: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:30:28.733999: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:30:28.735118: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b0f69a66e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:30:28.735153: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:30:28.872673: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b0f6a089f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:30:28.872735: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:30:28.872864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:30:28.872875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 22.3684 (error=0.0789211), validation cost 24.488 (error=0.0753408)
epoch 10, training cost 4.09481 (error=0.0224202), validation cost 4.12685 (error=0.0241648)
epoch 20, training cost 2.90376 (error=0.022449), validation cost 2.92654 (error=0.0242819)
epoch 30, training cost 2.50542 (error=0.0224181), validation cost 2.54007 (error=0.0241153)
epoch 40, training cost 2.37599 (error=0.0223656), validation cost 2.42475 (error=0.0241158)
epoch 50, training cost 2.32805 (error=0.0223398), validation cost 2.37503 (error=0.0240794)
epoch 60, training cost 2.30307 (error=0.022361), validation cost 2.35082 (error=0.0240813)
epoch 70, training cost 2.28742 (error=0.0223487), validation cost 2.33463 (error=0.0241225)
epoch 80, training cost 2.27647 (error=0.0223545), validation cost 2.32753 (error=0.0241897)
epoch 90, training cost 2.26919 (error=0.0223626), validation cost 2.31577 (error=0.0240958)
[RESULT] training cost 2.26115, validation cost 2.30832, training error 0.0223509, validation error 0.0241331
[SAVE] result_8_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_2/train.jbl
[SAVE] config:  config_adw_gen_8_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.5132332  0.79784983]
[1.5132332  0.79784983]
data index: 0
error= 1.5000422824062463
dimension (observation): 0
steps: 100
[SAVE] : result_8_2/plot/0_data0_train.png
data index: 1
error= 3.0281806478805233
dimension (observation): 0
steps: 100
[SAVE] : result_8_2/plot/1_data1_train.png
data index: 2
error= 1.3222499524458193
dimension (observation): 0
steps: 100
[SAVE] : result_8_2/plot/2_data2_train.png
data index: 3
error= 1.2536376572764911
dimension (observation): 0
steps: 100
[SAVE] : result_8_2/plot/3_data3_train.png
data index: 4
error= 1.5343148215537072
dimension (observation): 0
steps: 100
[SAVE] : result_8_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:34:00.216586: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:34:00.262248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:34:00.262425: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:34:00.262485: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:34:00.262540: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:34:00.262594: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:34:00.262647: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:34:00.262700: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:34:00.262752: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:34:00.262762: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:34:00.263180: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:34:00.293997: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:34:00.295563: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55731fb5cc10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:34:00.295603: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:34:00.426433: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55731fbbef20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:34:00.426492: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:34:00.426623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:34:00.426632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 21.9644 (error=0.0848114), validation cost 20.3283 (error=0.0871439)
epoch 10, training cost 3.9643 (error=0.0258127), validation cost 3.95313 (error=0.0259729)
epoch 20, training cost 3.08988 (error=0.0229933), validation cost 3.07094 (error=0.0229217)
epoch 30, training cost 2.77217 (error=0.0226964), validation cost 2.77641 (error=0.0226636)
epoch 40, training cost 2.61997 (error=0.022701), validation cost 2.62497 (error=0.0227247)
epoch 50, training cost 2.53417 (error=0.0226967), validation cost 2.53674 (error=0.0227174)
epoch 60, training cost 2.48152 (error=0.0226944), validation cost 2.48079 (error=0.0226866)
epoch 70, training cost 2.4492 (error=0.0226856), validation cost 2.44645 (error=0.0226316)
epoch 80, training cost 2.42953 (error=0.0226883), validation cost 2.42929 (error=0.0226901)
epoch 90, training cost 2.41704 (error=0.0227119), validation cost 2.41355 (error=0.0225817)
[RESULT] training cost 2.41105, validation cost 2.41323, training error 0.022734, validation error 0.0227998
[SAVE] result_8_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_3/train.jbl
[SAVE] config:  config_adw_gen_8_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.8244003 -1.1551495]
[ 0.7490463 -1.1682088]
data index: 0
error= 1.718831757542323
dimension (observation): 0
steps: 100
[SAVE] : result_8_3/plot/0_data0_train.png
data index: 1
error= 2.9998278589218543
dimension (observation): 0
steps: 100
[SAVE] : result_8_3/plot/1_data1_train.png
data index: 2
error= 1.548242263583619
dimension (observation): 0
steps: 100
[SAVE] : result_8_3/plot/2_data2_train.png
data index: 3
error= 1.5106048690371576
dimension (observation): 0
steps: 100
[SAVE] : result_8_3/plot/3_data3_train.png
data index: 4
error= 1.8471917460909058
dimension (observation): 0
steps: 100
[SAVE] : result_8_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:37:35.560038: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:37:35.598123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:37:35.598284: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:37:35.598396: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:37:35.598477: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:37:35.598539: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:37:35.598593: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:37:35.598646: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:37:35.598692: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:37:35.598702: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:37:35.599213: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:37:35.625968: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:37:35.627139: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ee1ddd09c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:37:35.627159: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:37:35.773316: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ee1de32cd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:37:35.773358: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:37:35.773458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:37:35.773468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 355.77 (error=0.153644), validation cost 332.154 (error=0.164982)
epoch 10, training cost 7.2954 (error=0.039324), validation cost 7.42529 (error=0.0402273)
epoch 20, training cost 5.15168 (error=0.0301388), validation cost 5.22932 (error=0.0318267)
epoch 30, training cost 4.31888 (error=0.0268466), validation cost 4.39914 (error=0.0283045)
epoch 40, training cost 3.81961 (error=0.0240781), validation cost 3.83845 (error=0.0258558)
epoch 50, training cost 3.50355 (error=0.0230239), validation cost 3.5671 (error=0.0246849)
epoch 60, training cost 3.3567 (error=0.0228438), validation cost 3.38198 (error=0.0242528)
epoch 70, training cost 3.23717 (error=0.0227431), validation cost 3.27481 (error=0.0244356)
epoch 80, training cost 3.16602 (error=0.0227566), validation cost 3.20607 (error=0.0241298)
epoch 90, training cost 3.09033 (error=0.0226539), validation cost 3.12637 (error=0.024187)
[RESULT] training cost 3.04356, validation cost 3.07408, training error 0.0226195, validation error 0.0240683
[SAVE] result_8_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_4/train.jbl
[SAVE] config:  config_adw_gen_8_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.9739251 -0.9248858]
[ 0.9739251 -0.9248858]
data index: 0
error= 1.4892408984856187
dimension (observation): 0
steps: 100
[SAVE] : result_8_4/plot/0_data0_train.png
data index: 1
error= 3.186456717297178
dimension (observation): 0
steps: 100
[SAVE] : result_8_4/plot/1_data1_train.png
data index: 2
error= 1.3553668638693435
dimension (observation): 0
steps: 100
[SAVE] : result_8_4/plot/2_data2_train.png
data index: 3
error= 1.2161618023652179
dimension (observation): 0
steps: 100
[SAVE] : result_8_4/plot/3_data3_train.png
data index: 4
error= 1.529515018994589
dimension (observation): 0
steps: 100
[SAVE] : result_8_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:41:07.857286: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:41:07.892331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:41:07.892456: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:41:07.892502: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:41:07.892557: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:41:07.892604: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:41:07.892647: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:41:07.892688: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:41:07.892738: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:41:07.892746: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:41:07.893133: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:41:07.918000: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:41:07.919753: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5634e08900f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:41:07.919800: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:41:08.075439: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5634e08f2400 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:41:08.075489: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:41:08.075594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:41:08.075602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 5.59238 (error=0.0292151), validation cost 5.50354 (error=0.0288383)
epoch 10, training cost 3.07151 (error=0.0229466), validation cost 3.04645 (error=0.0220688)
epoch 20, training cost 2.84572 (error=0.0228648), validation cost 2.81765 (error=0.0220071)
epoch 30, training cost 2.79804 (error=0.0228657), validation cost 2.77139 (error=0.0219886)
epoch 40, training cost 2.78102 (error=0.022866), validation cost 2.75243 (error=0.0220123)
epoch 50, training cost 2.7725 (error=0.022867), validation cost 2.74363 (error=0.0220155)
epoch 60, training cost 2.76745 (error=0.0228691), validation cost 2.73788 (error=0.0219859)
epoch 70, training cost 2.76341 (error=0.0228585), validation cost 2.73394 (error=0.021982)
epoch 80, training cost 2.76182 (error=0.0228987), validation cost 2.73344 (error=0.022043)
epoch 90, training cost 2.75815 (error=0.0228628), validation cost 2.72879 (error=0.021975)
[RESULT] training cost 2.75606, validation cost 2.72686, training error 0.0228592, validation error 0.0219811
[SAVE] result_8_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_5/train.jbl
[SAVE] config:  config_adw_gen_8_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.3148825 -0.0877544]
[ 0.3148825 -0.0877544]
data index: 0
error= 1.6040405014634354
dimension (observation): 0
steps: 100
[SAVE] : result_8_5/plot/0_data0_train.png
data index: 1
error= 3.0005272673608765
dimension (observation): 0
steps: 100
[SAVE] : result_8_5/plot/1_data1_train.png
data index: 2
error= 1.4468116807240987
dimension (observation): 0
steps: 100
[SAVE] : result_8_5/plot/2_data2_train.png
data index: 3
error= 1.3843871177821494
dimension (observation): 0
steps: 100
[SAVE] : result_8_5/plot/3_data3_train.png
data index: 4
error= 1.6986080597383635
dimension (observation): 0
steps: 100
[SAVE] : result_8_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:44:32.347093: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:44:32.383832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:44:32.383956: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:44:32.383998: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:44:32.384039: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:44:32.384079: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:44:32.384129: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:44:32.384168: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:44:32.384206: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:44:32.384213: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:44:32.384566: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:44:32.409969: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:44:32.411226: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562b27810800 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:44:32.411261: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:44:32.562875: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562b27872b10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:44:32.562927: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:44:32.563038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:44:32.563044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 402.289 (error=0.0419822), validation cost 384.868 (error=0.0490277)
epoch 10, training cost 18.7261 (error=0.0230212), validation cost 19.208 (error=0.0253573)
epoch 20, training cost 5.15828 (error=0.0225033), validation cost 5.31254 (error=0.0240927)
epoch 30, training cost 3.66741 (error=0.0224096), validation cost 3.72007 (error=0.0241702)
epoch 40, training cost 3.3509 (error=0.0223924), validation cost 3.40291 (error=0.0240135)
epoch 50, training cost 3.21583 (error=0.0223935), validation cost 3.27469 (error=0.0240248)
epoch 60, training cost 3.14988 (error=0.0223701), validation cost 3.20913 (error=0.0241055)
epoch 70, training cost 3.10827 (error=0.022384), validation cost 3.16814 (error=0.0240624)
epoch 80, training cost 3.08301 (error=0.0223721), validation cost 3.14008 (error=0.0240315)
epoch 90, training cost 3.0654 (error=0.0224016), validation cost 3.13339 (error=0.024261)
[RESULT] training cost 3.05166, validation cost 3.10716, training error 0.0223742, validation error 0.0239884
[SAVE] result_8_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_6/train.jbl
[SAVE] config:  config_adw_gen_8_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.15935603 0.5718125 ]
[0.15935603 0.5718125 ]
data index: 0
error= 1.496785474997177
dimension (observation): 0
steps: 100
[SAVE] : result_8_6/plot/0_data0_train.png
data index: 1
error= 3.0307746332833148
dimension (observation): 0
steps: 100
[SAVE] : result_8_6/plot/1_data1_train.png
data index: 2
error= 1.349066278967843
dimension (observation): 0
steps: 100
[SAVE] : result_8_6/plot/2_data2_train.png
data index: 3
error= 1.2730429406229928
dimension (observation): 0
steps: 100
[SAVE] : result_8_6/plot/3_data3_train.png
data index: 4
error= 1.5802780382475907
dimension (observation): 0
steps: 100
[SAVE] : result_8_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:48:03.648725: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:48:03.697306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:48:03.697490: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:48:03.697553: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:48:03.697656: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:48:03.697773: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:48:03.697823: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:48:03.697907: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:48:03.697971: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:48:03.697981: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:48:03.698592: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:48:03.726185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:48:03.728993: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa517e0480 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:48:03.729066: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:48:03.883016: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa51842790 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:48:03.883070: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:48:03.883177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:48:03.883187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 28.1261 (error=0.273528), validation cost 28.5772 (error=0.281373)
epoch 10, training cost 3.99668 (error=0.0419795), validation cost 4.02166 (error=0.0422591)
epoch 20, training cost 3.62747 (error=0.033123), validation cost 3.66409 (error=0.0349121)
epoch 30, training cost 3.42902 (error=0.0263618), validation cost 3.45211 (error=0.0277592)
epoch 40, training cost 3.31462 (error=0.0237566), validation cost 3.33465 (error=0.0246178)
epoch 50, training cost 3.21978 (error=0.0229375), validation cost 3.2509 (error=0.0237216)
epoch 60, training cost 3.17698 (error=0.0227063), validation cost 3.20514 (error=0.0234884)
epoch 70, training cost 3.15677 (error=0.0225648), validation cost 3.19189 (error=0.0235037)
epoch 80, training cost 3.14925 (error=0.0225812), validation cost 3.18244 (error=0.0234673)
epoch 90, training cost 3.14413 (error=0.0225747), validation cost 3.18066 (error=0.0235158)
[RESULT] training cost 3.1404, validation cost 3.17476, training error 0.0225526, validation error 0.0234768
[SAVE] result_8_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_7/train.jbl
[SAVE] config:  config_adw_gen_8_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.71978    -0.44602963]
[ 0.71978    -0.44602963]
data index: 0
error= 1.5395142714002819
dimension (observation): 0
steps: 100
[SAVE] : result_8_7/plot/0_data0_train.png
data index: 1
error= 3.031645233543894
dimension (observation): 0
steps: 100
[SAVE] : result_8_7/plot/1_data1_train.png
data index: 2
error= 1.363785926647911
dimension (observation): 0
steps: 100
[SAVE] : result_8_7/plot/2_data2_train.png
data index: 3
error= 1.317189316001541
dimension (observation): 0
steps: 100
[SAVE] : result_8_7/plot/3_data3_train.png
data index: 4
error= 1.5912475646473754
dimension (observation): 0
steps: 100
[SAVE] : result_8_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:51:34.886227: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:51:34.931417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:51:34.931665: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:51:34.931846: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:51:34.931977: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:51:34.932064: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:51:34.932121: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:51:34.932190: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:51:34.932263: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:51:34.932278: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:51:34.932873: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:51:34.966025: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:51:34.967955: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5593a9e07940 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:51:34.968005: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:51:35.112842: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5593a9e69c50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:51:35.112902: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:51:35.113032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:51:35.113043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 142.531 (error=0.14506), validation cost 145.386 (error=0.145866)
epoch 10, training cost 9.98791 (error=0.0204439), validation cost 9.9865 (error=0.0203989)
epoch 20, training cost 7.55056 (error=0.0245271), validation cost 7.56307 (error=0.0245566)
epoch 30, training cost 5.92304 (error=0.0251329), validation cost 5.92189 (error=0.0251568)
epoch 40, training cost 4.98474 (error=0.0234465), validation cost 4.98855 (error=0.0232544)
epoch 50, training cost 4.46848 (error=0.0228569), validation cost 4.46005 (error=0.0226769)
epoch 60, training cost 4.12802 (error=0.0227712), validation cost 4.11639 (error=0.0226527)
epoch 70, training cost 3.88482 (error=0.0227277), validation cost 3.88343 (error=0.022569)
epoch 80, training cost 3.72986 (error=0.0227215), validation cost 3.71916 (error=0.0225383)
epoch 90, training cost 3.6283 (error=0.0228927), validation cost 3.6221 (error=0.0227689)
[RESULT] training cost 3.5555, validation cost 3.5393, training error 0.0227071, validation error 0.0225229
[SAVE] result_8_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_8/train.jbl
[SAVE] config:  config_adw_gen_8_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.82397264 -1.6986754 ]
[ 0.77030754 -1.8247213 ]
data index: 0
error= 1.604470845959045
dimension (observation): 0
steps: 100
[SAVE] : result_8_8/plot/0_data0_train.png
data index: 1
error= 2.9962987655761237
dimension (observation): 0
steps: 100
[SAVE] : result_8_8/plot/1_data1_train.png
data index: 2
error= 1.4377838337779083
dimension (observation): 0
steps: 100
[SAVE] : result_8_8/plot/2_data2_train.png
data index: 3
error= 1.3903216242896521
dimension (observation): 0
steps: 100
[SAVE] : result_8_8/plot/3_data3_train.png
data index: 4
error= 1.707205372935794
dimension (observation): 0
steps: 100
[SAVE] : result_8_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:55:18.024352: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:55:18.056777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:55:18.056918: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:55:18.056964: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:55:18.057049: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:55:18.057093: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:55:18.057142: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:55:18.057209: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:55:18.057275: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:55:18.057286: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:55:18.057806: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:55:18.085976: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:55:18.087439: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c544a2e500 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:55:18.087500: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:55:18.257162: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c544a90810 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:55:18.257223: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:55:18.257335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:55:18.257342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 293.498 (error=0.108087), validation cost 301.582 (error=0.111583)
epoch 10, training cost 10.2745 (error=0.0472754), validation cost 10.5174 (error=0.048437)
epoch 20, training cost 6.70423 (error=0.0372505), validation cost 6.94924 (error=0.038626)
epoch 30, training cost 5.53322 (error=0.0324328), validation cost 5.57942 (error=0.0325535)
epoch 40, training cost 4.96043 (error=0.029938), validation cost 5.01015 (error=0.0303731)
epoch 50, training cost 4.63291 (error=0.0283633), validation cost 4.63734 (error=0.0283803)
epoch 60, training cost 4.39776 (error=0.0269866), validation cost 4.41544 (error=0.0274493)
epoch 70, training cost 4.24436 (error=0.0261854), validation cost 4.28839 (error=0.0266099)
epoch 80, training cost 4.13733 (error=0.0254151), validation cost 4.1376 (error=0.0256685)
epoch 90, training cost 4.04348 (error=0.024758), validation cost 4.06858 (error=0.0250951)
[RESULT] training cost 3.97328, validation cost 3.99157, training error 0.0241516, validation error 0.0244784
[SAVE] result_8_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_9/train.jbl
[SAVE] config:  config_adw_gen_8_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.5624371  -0.21205401]
[-0.5624371  -0.21205401]
data index: 0
error= 1.8921475949043487
dimension (observation): 0
steps: 100
[SAVE] : result_8_9/plot/0_data0_train.png
data index: 1
error= 3.1765179187472494
dimension (observation): 0
steps: 100
[SAVE] : result_8_9/plot/1_data1_train.png
data index: 2
error= 1.9375242315643137
dimension (observation): 0
steps: 100
[SAVE] : result_8_9/plot/2_data2_train.png
data index: 3
error= 1.5403079859644098
dimension (observation): 0
steps: 100
[SAVE] : result_8_9/plot/3_data3_train.png
data index: 4
error= 1.725675046779964
dimension (observation): 0
steps: 100
[SAVE] : result_8_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_8_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 20:58:51.877971: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 20:58:51.915153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 20:58:51.915304: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:58:51.915371: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:58:51.915421: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:58:51.915473: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:58:51.915519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:58:51.915566: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 20:58:51.915612: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 20:58:51.915621: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 20:58:51.916075: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 20:58:51.941995: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 20:58:51.943608: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559647e5eaa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:58:51.943668: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 20:58:52.097718: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559647ec0db0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 20:58:52.097768: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 20:58:52.097920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 20:58:52.097941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 279832 (error=0.0925323), validation cost 280209 (error=0.098492)
epoch 10, training cost 7.07695 (error=0.0375898), validation cost 7.00068 (error=0.0372218)
epoch 20, training cost 7.02916 (error=0.0388686), validation cost 7.04779 (error=0.0383987)
epoch 30, training cost 7.05427 (error=0.0387379), validation cost 6.94469 (error=0.0380063)
epoch 40, training cost 6.14945 (error=0.0326814), validation cost 6.0488 (error=0.0324097)
epoch 50, training cost 5.22847 (error=0.0266577), validation cost 5.26804 (error=0.0278204)
epoch 60, training cost 5.02421 (error=0.0235871), validation cost 5.04481 (error=0.0246805)
epoch 70, training cost 4.95879 (error=0.0230558), validation cost 4.95292 (error=0.0239073)
epoch 80, training cost 4.95315 (error=0.0229536), validation cost 4.97328 (error=0.0237947)
epoch 90, training cost 4.95786 (error=0.0228522), validation cost 4.95865 (error=0.0236664)
[RESULT] training cost 4.92855, validation cost 4.98298, training error 0.0229017, validation error 0.0237406
[SAVE] result_8_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_8_10/train.jbl
[SAVE] config:  config_adw_gen_8_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_8_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.4592688   0.26717955]
[-1.4592688   0.26717955]
data index: 0
error= 1.5123129541534532
dimension (observation): 0
steps: 100
[SAVE] : result_8_10/plot/0_data0_train.png
data index: 1
error= 3.1138463456025254
dimension (observation): 0
steps: 100
[SAVE] : result_8_10/plot/1_data1_train.png
data index: 2
error= 1.3237454273132725
dimension (observation): 0
steps: 100
[SAVE] : result_8_10/plot/2_data2_train.png
data index: 3
error= 1.2829227502265672
dimension (observation): 0
steps: 100
[SAVE] : result_8_10/plot/3_data3_train.png
data index: 4
error= 1.6716175066650734
dimension (observation): 0
steps: 100
[SAVE] : result_8_10/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_1.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:01:57.183022: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:01:57.234784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:01:57.235003: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:01:57.235098: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:01:57.235171: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:01:57.235219: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:01:57.235261: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:01:57.235305: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:01:57.235371: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:01:57.235380: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:01:57.235942: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:01:57.270002: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:01:57.271564: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5639718a64d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:01:57.271607: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:01:57.415843: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5639719087e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:01:57.415907: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:01:57.415991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:01:57.415999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 25.5251 (error=0.0701767), validation cost 25.5556 (error=0.0691184)
epoch 10, training cost 5.03094 (error=0.0276709), validation cost 5.03299 (error=0.027218)
epoch 20, training cost 3.16448 (error=0.0229415), validation cost 3.16363 (error=0.0226476)
epoch 30, training cost 2.56796 (error=0.0228936), validation cost 2.55968 (error=0.0225372)
epoch 40, training cost 2.31087 (error=0.0228265), validation cost 2.30172 (error=0.0224604)
epoch 50, training cost 2.19417 (error=0.0227994), validation cost 2.18604 (error=0.0224567)
epoch 60, training cost 2.13637 (error=0.0228113), validation cost 2.12739 (error=0.0224458)
epoch 70, training cost 2.10258 (error=0.0227683), validation cost 2.09377 (error=0.0224068)
epoch 80, training cost 2.08046 (error=0.022753), validation cost 2.07223 (error=0.0224163)
epoch 90, training cost 2.06515 (error=0.0227662), validation cost 2.0567 (error=0.0224239)
[RESULT] training cost 2.05302, validation cost 2.04514, training error 0.0227635, validation error 0.0224408
[SAVE] result_9_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_1/train.jbl
[SAVE] config:  config_adw_gen_9_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.5676417  -0.19874588]
[ 0.5676417  -0.19874588]
data index: 0
error= 1.500683548802863
dimension (observation): 0
steps: 100
[SAVE] : result_9_1/plot/0_data0_train.png
data index: 1
error= 3.0113548786324382
dimension (observation): 0
steps: 100
[SAVE] : result_9_1/plot/1_data1_train.png
data index: 2
error= 1.3746026644582543
dimension (observation): 0
steps: 100
[SAVE] : result_9_1/plot/2_data2_train.png
data index: 3
error= 1.2630504974256633
dimension (observation): 0
steps: 100
[SAVE] : result_9_1/plot/3_data3_train.png
data index: 4
error= 1.5722825353016654
dimension (observation): 0
steps: 100
[SAVE] : result_9_1/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_2.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:05:40.106397: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:05:40.142529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:05:40.142662: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:05:40.142707: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:05:40.142754: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:05:40.142797: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:05:40.142838: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:05:40.142878: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:05:40.142928: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:05:40.142937: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:05:40.143311: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:05:40.169992: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:05:40.171542: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5578a0e1ff50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:05:40.171571: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:05:40.324548: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5578a0e82260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:05:40.324612: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:05:40.324721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:05:40.324735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 21.3175 (error=0.0276918), validation cost 24.2633 (error=0.0280156)
epoch 10, training cost 3.3243 (error=0.0233064), validation cost 3.30368 (error=0.0232465)
epoch 20, training cost 2.75091 (error=0.0229114), validation cost 2.75781 (error=0.022873)
epoch 30, training cost 2.55333 (error=0.0228319), validation cost 2.54823 (error=0.0227791)
epoch 40, training cost 2.47588 (error=0.022841), validation cost 2.45946 (error=0.0227477)
epoch 50, training cost 2.38035 (error=0.0228433), validation cost 2.37282 (error=0.0228092)
epoch 60, training cost 2.31808 (error=0.022803), validation cost 2.30576 (error=0.0227163)
epoch 70, training cost 2.28977 (error=0.0227609), validation cost 2.28529 (error=0.0227251)
epoch 80, training cost 2.27394 (error=0.0227514), validation cost 2.27354 (error=0.0227034)
epoch 90, training cost 2.26533 (error=0.0227293), validation cost 2.26704 (error=0.022667)
[RESULT] training cost 2.26017, validation cost 2.25414, training error 0.022715, validation error 0.0226652
[SAVE] result_9_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_2/train.jbl
[SAVE] config:  config_adw_gen_9_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.4481533  0.00618601]
[1.4481533  0.00618601]
data index: 0
error= 1.5689489020348943
dimension (observation): 0
steps: 100
[SAVE] : result_9_2/plot/0_data0_train.png
data index: 1
error= 3.030208692314526
dimension (observation): 0
steps: 100
[SAVE] : result_9_2/plot/1_data1_train.png
data index: 2
error= 1.4089317338113905
dimension (observation): 0
steps: 100
[SAVE] : result_9_2/plot/2_data2_train.png
data index: 3
error= 1.3425586344981821
dimension (observation): 0
steps: 100
[SAVE] : result_9_2/plot/3_data3_train.png
data index: 4
error= 1.639028736804024
dimension (observation): 0
steps: 100
[SAVE] : result_9_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:08:59.406675: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:08:59.446728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:08:59.446865: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:08:59.446909: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:08:59.446949: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:08:59.446990: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:08:59.447029: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:08:59.447070: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:08:59.447124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:08:59.447132: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:08:59.447563: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:08:59.473990: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:08:59.475135: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5596e1251730 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:08:59.475158: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:08:59.620257: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5596e12b3a40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:08:59.620315: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:08:59.620419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:08:59.620427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 2503 (error=0.0344212), validation cost 2249.14 (error=0.0348992)
epoch 10, training cost 38.4501 (error=0.0259328), validation cost 33.1982 (error=0.0249308)
epoch 20, training cost 26.739 (error=0.0243639), validation cost 27.2212 (error=0.0232627)
epoch 30, training cost 19.0283 (error=0.0231238), validation cost 17.2065 (error=0.022344)
epoch 40, training cost 15.9291 (error=0.02291), validation cost 15.8852 (error=0.0220313)
epoch 50, training cost 13.7532 (error=0.0228672), validation cost 12.3931 (error=0.0220766)
epoch 60, training cost 10.97 (error=0.022883), validation cost 13.2256 (error=0.0220102)
epoch 70, training cost 11.0767 (error=0.0229039), validation cost 9.83277 (error=0.0220116)
epoch 80, training cost 8.69034 (error=0.0228728), validation cost 8.81214 (error=0.022173)
epoch 90, training cost 8.12526 (error=0.0228509), validation cost 7.97305 (error=0.0221026)
[RESULT] training cost 7.84463, validation cost 7.92234, training error 0.0228711, validation error 0.022042
[SAVE] result_9_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_3/train.jbl
[SAVE] config:  config_adw_gen_9_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.3666108 1.7042259]
[1.3666108 1.7042259]
data index: 0
error= 1.5329706444223044
dimension (observation): 0
steps: 100
[SAVE] : result_9_3/plot/0_data0_train.png
data index: 1
error= 2.984911809696432
dimension (observation): 0
steps: 100
[SAVE] : result_9_3/plot/1_data1_train.png
data index: 2
error= 1.376067498306548
dimension (observation): 0
steps: 100
[SAVE] : result_9_3/plot/2_data2_train.png
data index: 3
error= 1.3075891135603932
dimension (observation): 0
steps: 100
[SAVE] : result_9_3/plot/3_data3_train.png
data index: 4
error= 1.637653395445837
dimension (observation): 0
steps: 100
[SAVE] : result_9_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:12:08.299690: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:12:08.339941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:12:08.340074: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:12:08.340118: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:12:08.340156: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:12:08.340197: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:12:08.340235: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:12:08.340277: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:12:08.340316: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:12:08.340325: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:12:08.340753: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:12:08.365976: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:12:08.367134: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c863f28cf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:12:08.367200: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:12:08.522059: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c863f8b000 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:12:08.522104: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:12:08.522208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:12:08.522215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 2784.35 (error=0.0314943), validation cost 2149.74 (error=0.0316581)
epoch 10, training cost 25.7575 (error=0.0234722), validation cost 25.7951 (error=0.0240939)
epoch 20, training cost 18.4085 (error=0.023136), validation cost 18.3022 (error=0.0235881)
epoch 30, training cost 15.458 (error=0.0227324), validation cost 15.549 (error=0.0234574)
epoch 40, training cost 13.8428 (error=0.0227055), validation cost 13.7299 (error=0.0231657)
epoch 50, training cost 12.7379 (error=0.0226226), validation cost 12.6333 (error=0.0231741)
epoch 60, training cost 11.9227 (error=0.0226103), validation cost 11.8404 (error=0.0231957)
epoch 70, training cost 11.3543 (error=0.0225969), validation cost 11.4471 (error=0.02325)
epoch 80, training cost 10.8326 (error=0.0225904), validation cost 10.8345 (error=0.0231833)
epoch 90, training cost 10.3699 (error=0.0226939), validation cost 10.4643 (error=0.0233645)
[RESULT] training cost 9.9454, validation cost 9.97925, training error 0.0226078, validation error 0.0231268
[SAVE] result_9_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_4/train.jbl
[SAVE] config:  config_adw_gen_9_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.8548074   0.60781264]
[-0.8548074   0.60781264]
data index: 0
error= 1.5746297452062077
dimension (observation): 0
steps: 100
[SAVE] : result_9_4/plot/0_data0_train.png
data index: 1
error= 3.0157762382781255
dimension (observation): 0
steps: 100
[SAVE] : result_9_4/plot/1_data1_train.png
data index: 2
error= 1.4264241984125179
dimension (observation): 0
steps: 100
[SAVE] : result_9_4/plot/2_data2_train.png
data index: 3
error= 1.3464894443641013
dimension (observation): 0
steps: 100
[SAVE] : result_9_4/plot/3_data3_train.png
data index: 4
error= 1.65005738151619
dimension (observation): 0
steps: 100
[SAVE] : result_9_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:15:38.871755: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:15:38.909399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:15:38.909574: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:15:38.909623: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:15:38.909677: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:15:38.909721: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:15:38.909762: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:15:38.909801: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:15:38.909845: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:15:38.909852: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:15:38.910306: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:15:38.938018: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:15:38.939901: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558d08fe8eb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:15:38.939953: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:15:39.093143: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558d0904b1c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:15:39.093215: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:15:39.093346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:15:39.093356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 21.493 (error=0.101056), validation cost 21.3509 (error=0.0989704)
epoch 10, training cost 3.90811 (error=0.0242697), validation cost 3.89373 (error=0.0240598)
epoch 20, training cost 3.3233 (error=0.0198928), validation cost 3.31618 (error=0.0196977)
epoch 30, training cost 3.059 (error=0.0202672), validation cost 3.04654 (error=0.0200735)
epoch 40, training cost 2.90927 (error=0.0215096), validation cost 2.90034 (error=0.0215209)
epoch 50, training cost 2.85485 (error=0.0222766), validation cost 2.85019 (error=0.0222469)
epoch 60, training cost 2.83098 (error=0.022489), validation cost 2.82553 (error=0.0223391)
epoch 70, training cost 2.82078 (error=0.0226536), validation cost 2.81242 (error=0.0224278)
epoch 80, training cost 2.8123 (error=0.0226901), validation cost 2.80616 (error=0.0224363)
epoch 90, training cost 2.8101 (error=0.0227413), validation cost 2.80237 (error=0.0225009)
[RESULT] training cost 2.8053, validation cost 2.79913, training error 0.0227525, validation error 0.0225524
[SAVE] result_9_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_5/train.jbl
[SAVE] config:  config_adw_gen_9_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.18273485 -0.961059  ]
[ 0.09267712 -1.1172601 ]
data index: 0
error= 1.5964961003931477
dimension (observation): 0
steps: 100
[SAVE] : result_9_5/plot/0_data0_train.png
data index: 1
error= 3.000128718295227
dimension (observation): 0
steps: 100
[SAVE] : result_9_5/plot/1_data1_train.png
data index: 2
error= 1.4428248286975667
dimension (observation): 0
steps: 100
[SAVE] : result_9_5/plot/2_data2_train.png
data index: 3
error= 1.4023096834735653
dimension (observation): 0
steps: 100
[SAVE] : result_9_5/plot/3_data3_train.png
data index: 4
error= 1.6878206276798138
dimension (observation): 0
steps: 100
[SAVE] : result_9_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:19:05.296823: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:19:05.347220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:19:05.347422: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:19:05.347519: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:19:05.347586: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:19:05.347639: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:19:05.347699: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:19:05.347758: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:19:05.347815: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:19:05.347825: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:19:05.348423: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:19:05.381991: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:19:05.383258: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a82f626030 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:19:05.383301: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:19:05.513816: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a82f688340 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:19:05.513899: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:19:05.514018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:19:05.514030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 19.5989 (error=0.304828), validation cost 19.6212 (error=0.304273)
epoch 10, training cost 4.06758 (error=0.0272828), validation cost 4.07425 (error=0.0273954)
epoch 20, training cost 3.39431 (error=0.0229704), validation cost 3.385 (error=0.0229634)
epoch 30, training cost 3.17772 (error=0.0227645), validation cost 3.18535 (error=0.0229173)
epoch 40, training cost 3.07954 (error=0.0226702), validation cost 3.08668 (error=0.0228023)
epoch 50, training cost 3.03222 (error=0.022655), validation cost 3.03939 (error=0.0229411)
epoch 60, training cost 3.00149 (error=0.0226642), validation cost 3.00737 (error=0.0229237)
epoch 70, training cost 2.98434 (error=0.0226562), validation cost 2.99155 (error=0.0229314)
epoch 80, training cost 2.97347 (error=0.0226659), validation cost 2.98211 (error=0.0229504)
epoch 90, training cost 2.96678 (error=0.0226675), validation cost 2.97389 (error=0.0229208)
[RESULT] training cost 2.96071, validation cost 2.96844, training error 0.0226618, validation error 0.0229222
[SAVE] result_9_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_6/train.jbl
[SAVE] config:  config_adw_gen_9_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.38180956 0.4710027 ]
[ 0.18858576 -0.10600436]
data index: 0
error= 1.5628568758591161
dimension (observation): 0
steps: 100
[SAVE] : result_9_6/plot/0_data0_train.png
data index: 1
error= 3.0463275008233976
dimension (observation): 0
steps: 100
[SAVE] : result_9_6/plot/1_data1_train.png
data index: 2
error= 1.4183949990853364
dimension (observation): 0
steps: 100
[SAVE] : result_9_6/plot/2_data2_train.png
data index: 3
error= 1.3358600868309247
dimension (observation): 0
steps: 100
[SAVE] : result_9_6/plot/3_data3_train.png
data index: 4
error= 1.6679426755508326
dimension (observation): 0
steps: 100
[SAVE] : result_9_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:22:41.967620: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:22:42.003718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:22:42.003860: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:22:42.003905: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:22:42.003946: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:22:42.003989: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:22:42.004030: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:22:42.004081: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:22:42.004122: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:22:42.004129: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:22:42.004572: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:22:42.046023: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:22:42.047503: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558775ac5460 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:22:42.047535: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:22:42.205142: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558775b27770 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:22:42.205188: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:22:42.205261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:22:42.205269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 25.6012 (error=0.0244375), validation cost 25.8698 (error=0.0234566)
epoch 10, training cost 7.4562 (error=0.0235234), validation cost 7.41555 (error=0.0219653)
epoch 20, training cost 5.34672 (error=0.0233362), validation cost 5.3098 (error=0.0216061)
epoch 30, training cost 4.45279 (error=0.0231668), validation cost 4.38949 (error=0.0214063)
epoch 40, training cost 3.96133 (error=0.0231067), validation cost 3.9069 (error=0.0216105)
epoch 50, training cost 3.66377 (error=0.0230626), validation cost 3.60453 (error=0.0214906)
epoch 60, training cost 3.47051 (error=0.0230589), validation cost 3.40844 (error=0.0213256)
epoch 70, training cost 3.34524 (error=0.0230546), validation cost 3.2844 (error=0.0214184)
epoch 80, training cost 3.26872 (error=0.0230513), validation cost 3.20533 (error=0.0213191)
epoch 90, training cost 3.22517 (error=0.023046), validation cost 3.16971 (error=0.0215585)
[RESULT] training cost 3.19821, validation cost 3.14419, training error 0.0230589, validation error 0.0215578
[SAVE] result_9_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_7/train.jbl
[SAVE] config:  config_adw_gen_9_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.9908887 -0.0546752]
[ 0.9908887 -0.0546752]
data index: 0
error= 1.7013551752537177
dimension (observation): 0
steps: 100
[SAVE] : result_9_7/plot/0_data0_train.png
data index: 1
error= 2.968422261482876
dimension (observation): 0
steps: 100
[SAVE] : result_9_7/plot/1_data1_train.png
data index: 2
error= 1.5440419381272363
dimension (observation): 0
steps: 100
[SAVE] : result_9_7/plot/2_data2_train.png
data index: 3
error= 1.4914466080514206
dimension (observation): 0
steps: 100
[SAVE] : result_9_7/plot/3_data3_train.png
data index: 4
error= 1.8194263998222995
dimension (observation): 0
steps: 100
[SAVE] : result_9_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:26:20.375840: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:26:20.407479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:26:20.407604: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:26:20.407650: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:26:20.407693: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:26:20.407737: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:26:20.407779: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:26:20.407822: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:26:20.407863: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:26:20.407879: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:26:20.408240: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:26:20.433997: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:26:20.435328: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563f8bf76050 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:26:20.435358: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:26:20.586621: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563f8bfd8360 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:26:20.586673: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:26:20.586783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:26:20.586793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 16.8736 (error=0.125513), validation cost 16.9492 (error=0.13136)
epoch 10, training cost 4.20088 (error=0.033821), validation cost 4.21539 (error=0.0343092)
epoch 20, training cost 3.71283 (error=0.0254731), validation cost 3.73141 (error=0.0261027)
epoch 30, training cost 3.4658 (error=0.0231974), validation cost 3.48922 (error=0.0237366)
epoch 40, training cost 3.38618 (error=0.022696), validation cost 3.4112 (error=0.0234077)
epoch 50, training cost 3.36042 (error=0.0226777), validation cost 3.38627 (error=0.0232821)
epoch 60, training cost 3.34806 (error=0.022637), validation cost 3.37449 (error=0.0233102)
epoch 70, training cost 3.33993 (error=0.0226534), validation cost 3.36351 (error=0.0232621)
epoch 80, training cost 3.3331 (error=0.0226232), validation cost 3.3581 (error=0.0232823)
epoch 90, training cost 3.32932 (error=0.0226494), validation cost 3.35429 (error=0.0233128)
[RESULT] training cost 3.32444, validation cost 3.35017, training error 0.0226065, validation error 0.0232192
[SAVE] result_9_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_8/train.jbl
[SAVE] config:  config_adw_gen_9_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.77874196 0.1216676 ]
[0.77874196 0.1216676 ]
data index: 0
error= 1.5918434565055344
dimension (observation): 0
steps: 100
[SAVE] : result_9_8/plot/0_data0_train.png
data index: 1
error= 3.0085441918811973
dimension (observation): 0
steps: 100
[SAVE] : result_9_8/plot/1_data1_train.png
data index: 2
error= 1.4397051107559122
dimension (observation): 0
steps: 100
[SAVE] : result_9_8/plot/2_data2_train.png
data index: 3
error= 1.346155031031359
dimension (observation): 0
steps: 100
[SAVE] : result_9_8/plot/3_data3_train.png
data index: 4
error= 1.6745160246886772
dimension (observation): 0
steps: 100
[SAVE] : result_9_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:29:44.711872: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:29:44.748090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:29:44.748249: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:29:44.748336: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:29:44.748411: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:29:44.748467: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:29:44.748525: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:29:44.748579: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:29:44.748636: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:29:44.748648: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:29:44.749136: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:29:44.777988: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:29:44.779391: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562b446e8bb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:29:44.779432: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:29:44.924627: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562b4474aec0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:29:44.924679: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:29:44.924772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:29:44.924779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 777.232 (error=0.089306), validation cost 780.019 (error=0.0946718)
epoch 10, training cost 23.9247 (error=0.0196805), validation cost 23.9204 (error=0.0202202)
epoch 20, training cost 18.2287 (error=0.0193476), validation cost 18.2328 (error=0.0198881)
epoch 30, training cost 15.1202 (error=0.0195714), validation cost 15.1349 (error=0.0198864)
epoch 40, training cost 13.0099 (error=0.0200039), validation cost 13.0646 (error=0.0204769)
epoch 50, training cost 11.4719 (error=0.0202558), validation cost 11.5241 (error=0.0208452)
epoch 60, training cost 10.3799 (error=0.0201581), validation cost 10.4063 (error=0.0207152)
epoch 70, training cost 9.52864 (error=0.0203105), validation cost 9.58516 (error=0.020884)
epoch 80, training cost 8.85148 (error=0.0204735), validation cost 8.88671 (error=0.0211291)
epoch 90, training cost 8.28692 (error=0.0205502), validation cost 8.3122 (error=0.0211749)
[RESULT] training cost 7.82385, validation cost 7.84602, training error 0.0207214, validation error 0.0211199
[SAVE] result_9_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_9/train.jbl
[SAVE] config:  config_adw_gen_9_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.0757966 2.453635 ]
[0.9639574 1.9551611]
data index: 0
error= 1.4738456245365779
dimension (observation): 0
steps: 100
[SAVE] : result_9_9/plot/0_data0_train.png
data index: 1
error= 3.183414261929287
dimension (observation): 0
steps: 100
[SAVE] : result_9_9/plot/1_data1_train.png
data index: 2
error= 1.7011427933256098
dimension (observation): 0
steps: 100
[SAVE] : result_9_9/plot/2_data2_train.png
data index: 3
error= 1.6759936655483847
dimension (observation): 0
steps: 100
[SAVE] : result_9_9/plot/3_data3_train.png
data index: 4
error= 1.4939404514644201
dimension (observation): 0
steps: 100
[SAVE] : result_9_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_9_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:33:27.638565: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:33:27.682755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:33:27.682878: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:33:27.682922: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:33:27.682961: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:33:27.683000: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:33:27.683038: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:33:27.683075: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:33:27.683128: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:33:27.683136: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:33:27.683519: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:33:27.710025: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:33:27.711719: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ff61fb8d90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:33:27.711772: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:33:27.863961: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ff6201b0a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:33:27.864051: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:33:27.864250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:33:27.864278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 49.6218 (error=0.147264), validation cost 48.4854 (error=0.141536)
epoch 10, training cost 7.09484 (error=0.0247685), validation cost 7.07247 (error=0.0246348)
epoch 20, training cost 5.41535 (error=0.0233566), validation cost 5.37745 (error=0.0227819)
epoch 30, training cost 4.61446 (error=0.0231047), validation cost 4.58352 (error=0.0224437)
epoch 40, training cost 4.21794 (error=0.0229552), validation cost 4.1874 (error=0.022304)
epoch 50, training cost 4.03492 (error=0.0229376), validation cost 4.00606 (error=0.0222584)
epoch 60, training cost 3.93249 (error=0.022885), validation cost 3.904 (error=0.0222219)
epoch 70, training cost 3.87082 (error=0.0228693), validation cost 3.84423 (error=0.0221817)
epoch 80, training cost 3.83339 (error=0.0228615), validation cost 3.80074 (error=0.0221972)
epoch 90, training cost 3.81186 (error=0.0228405), validation cost 3.77894 (error=0.0222038)
[RESULT] training cost 3.79351, validation cost 3.76761, training error 0.0228418, validation error 0.0221845
[SAVE] result_9_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_9_10/train.jbl
[SAVE] config:  config_adw_gen_9_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_9_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.73098487 -0.11360858]
[ 0.73098487 -0.11360858]
data index: 0
error= 1.5758662522344042
dimension (observation): 0
steps: 100
[SAVE] : result_9_10/plot/0_data0_train.png
data index: 1
error= 2.99907791425384
dimension (observation): 0
steps: 100
[SAVE] : result_9_10/plot/1_data1_train.png
data index: 2
error= 1.4572806834748009
dimension (observation): 0
steps: 100
[SAVE] : result_9_10/plot/2_data2_train.png
data index: 3
error= 1.3531367018308178
dimension (observation): 0
steps: 100
[SAVE] : result_9_10/plot/3_data3_train.png
data index: 4
error= 1.6915434324990786
dimension (observation): 0
steps: 100
[SAVE] : result_9_10/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_1.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:37:14.323106: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:37:14.361603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:37:14.361743: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:37:14.361792: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:37:14.361834: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:37:14.361893: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:37:14.361937: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:37:14.361978: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:37:14.362020: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:37:14.362028: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:37:14.362472: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:37:14.389995: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:37:14.391332: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564d6ffae8b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:37:14.391379: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:37:14.538893: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564d70010bc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:37:14.538970: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:37:14.539083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:37:14.539097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 10.9918 (error=0.0305269), validation cost 14.9144 (error=0.0326819)
epoch 10, training cost 3.5527 (error=0.0228164), validation cost 3.58189 (error=0.023969)
epoch 20, training cost 2.89649 (error=0.0225823), validation cost 2.92612 (error=0.0238915)
epoch 30, training cost 2.59102 (error=0.0225296), validation cost 2.60993 (error=0.0237273)
epoch 40, training cost 2.42199 (error=0.0226042), validation cost 2.45779 (error=0.0238126)
epoch 50, training cost 2.31487 (error=0.0224971), validation cost 2.34951 (error=0.0237885)
epoch 60, training cost 2.25302 (error=0.0225148), validation cost 2.28137 (error=0.0238874)
epoch 70, training cost 2.20479 (error=0.0224947), validation cost 2.23695 (error=0.0237537)
epoch 80, training cost 2.17321 (error=0.0224632), validation cost 2.2037 (error=0.0237507)
epoch 90, training cost 2.14416 (error=0.0224806), validation cost 2.1739 (error=0.023689)
[RESULT] training cost 2.12505, validation cost 2.1544, training error 0.0224656, validation error 0.0237336
[SAVE] result_10_1/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_1/train.jbl
[SAVE] config:  config_adw_gen_10_1.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_1/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-0.8641451   0.09830248]
[-1.388602   -0.26557732]
data index: 0
error= 1.616166679317942
dimension (observation): 0
steps: 100
[SAVE] : result_10_1/plot/0_data0_train.png
data index: 1
error= 3.00409314614096
dimension (observation): 0
steps: 100
[SAVE] : result_10_1/plot/1_data1_train.png
data index: 2
error= 1.4498404562053864
dimension (observation): 0
steps: 100
[SAVE] : result_10_1/plot/2_data2_train.png
data index: 3
error= 1.3817854196422856
dimension (observation): 0
steps: 100
[SAVE] : result_10_1/plot/3_data3_train.png
data index: 4
error= 1.6981397419812632
dimension (observation): 0
steps: 100
[SAVE] : result_10_1/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_2.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:41:00.603447: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:41:00.659829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:41:00.659995: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:41:00.660075: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:41:00.660130: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:41:00.660184: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:41:00.660240: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:41:00.660289: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:41:00.660348: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:41:00.660362: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:41:00.660839: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:41:00.690578: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:41:00.692718: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f5a0e23da0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:41:00.692752: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:41:00.839334: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f5a0e860b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:41:00.839394: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:41:00.839507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:41:00.839524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 79481 (error=0.225722), validation cost 75654.1 (error=0.216031)
epoch 10, training cost 229.238 (error=0.0417529), validation cost 288.694 (error=0.0398974)
epoch 20, training cost 137.885 (error=0.0286622), validation cost 390.658 (error=0.0278239)
epoch 30, training cost 4.3202 (error=0.0244981), validation cost 4.36293 (error=0.0239616)
epoch 40, training cost 3.30229 (error=0.0232506), validation cost 3.67708 (error=0.0229986)
epoch 50, training cost 3.19897 (error=0.0230914), validation cost 3.29836 (error=0.0228487)
epoch 60, training cost 3.00729 (error=0.0230541), validation cost 3.0248 (error=0.0226938)
epoch 70, training cost 2.94898 (error=0.0229265), validation cost 2.93809 (error=0.0226044)
epoch 80, training cost 2.89536 (error=0.0228836), validation cost 2.87801 (error=0.0225556)
epoch 90, training cost 2.87424 (error=0.0228609), validation cost 2.87579 (error=0.0225297)
[RESULT] training cost 2.84673, validation cost 2.90447, training error 0.0228224, validation error 0.0226711
[SAVE] result_10_2/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_2/train.jbl
[SAVE] config:  config_adw_gen_10_2.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_2/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.254846 0.693065]
[0.02221171 0.6544282 ]
data index: 0
error= 1.6620648822921442
dimension (observation): 0
steps: 100
[SAVE] : result_10_2/plot/0_data0_train.png
data index: 1
error= 2.9783576006232533
dimension (observation): 0
steps: 100
[SAVE] : result_10_2/plot/1_data1_train.png
data index: 2
error= 1.4978179179519826
dimension (observation): 0
steps: 100
[SAVE] : result_10_2/plot/2_data2_train.png
data index: 3
error= 1.4548198113541793
dimension (observation): 0
steps: 100
[SAVE] : result_10_2/plot/3_data3_train.png
data index: 4
error= 1.7408432700037904
dimension (observation): 0
steps: 100
[SAVE] : result_10_2/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_3.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:44:18.769791: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:44:18.809705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:44:18.809914: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:44:18.810003: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:44:18.810081: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:44:18.810144: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:44:18.810209: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:44:18.810257: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:44:18.810307: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:44:18.810316: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:44:18.810798: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:44:18.837967: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:44:18.839307: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558dc3e658c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:44:18.839337: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:44:19.007080: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558dc3ec7bd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:44:19.007130: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:44:19.007221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:44:19.007229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 9.13805 (error=0.0322387), validation cost 9.45884 (error=0.0308096)
epoch 10, training cost 2.98417 (error=0.0228032), validation cost 3.01608 (error=0.024415)
epoch 20, training cost 2.73148 (error=0.0225815), validation cost 2.77285 (error=0.0240588)
epoch 30, training cost 2.60897 (error=0.0224863), validation cost 2.65346 (error=0.023991)
epoch 40, training cost 2.54355 (error=0.0224595), validation cost 2.59696 (error=0.0241815)
epoch 50, training cost 2.49961 (error=0.0224272), validation cost 2.55045 (error=0.0241914)
epoch 60, training cost 2.47188 (error=0.0224184), validation cost 2.52002 (error=0.0241059)
epoch 70, training cost 2.45054 (error=0.0224333), validation cost 2.49797 (error=0.0240901)
epoch 80, training cost 2.43544 (error=0.0223828), validation cost 2.48217 (error=0.0239967)
epoch 90, training cost 2.42548 (error=0.0223982), validation cost 2.47408 (error=0.0241087)
[RESULT] training cost 2.41692, validation cost 2.466, training error 0.0224025, validation error 0.0240839
[SAVE] result_10_3/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_3/train.jbl
[SAVE] config:  config_adw_gen_10_3.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_3/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.97567165 -0.31428888]
[ 0.97567165 -0.31428888]
data index: 0
error= 1.4467041197797743
dimension (observation): 0
steps: 100
[SAVE] : result_10_3/plot/0_data0_train.png
data index: 1
error= 3.010911784623598
dimension (observation): 0
steps: 100
[SAVE] : result_10_3/plot/1_data1_train.png
data index: 2
error= 1.303415516374727
dimension (observation): 0
steps: 100
[SAVE] : result_10_3/plot/2_data2_train.png
data index: 3
error= 1.2131574880110112
dimension (observation): 0
steps: 100
[SAVE] : result_10_3/plot/3_data3_train.png
data index: 4
error= 1.5061632855235356
dimension (observation): 0
steps: 100
[SAVE] : result_10_3/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_4.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:47:48.143001: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:47:48.182731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:47:48.182870: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:47:48.182916: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:47:48.182955: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:47:48.183000: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:47:48.183043: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:47:48.183085: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:47:48.183124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:47:48.183132: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:47:48.183485: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:47:48.209972: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:47:48.211864: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564e29ba5470 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:47:48.211893: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:47:48.357236: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564e29c07780 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:47:48.357278: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:47:48.357381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:47:48.357388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 93.6709 (error=0.0389095), validation cost 107.812 (error=0.0372374)
epoch 10, training cost 9.77247 (error=0.0230889), validation cost 9.88157 (error=0.0230942)
epoch 20, training cost 5.54683 (error=0.022892), validation cost 5.48936 (error=0.0229913)
epoch 30, training cost 4.19993 (error=0.0227882), validation cost 4.21337 (error=0.0228572)
epoch 40, training cost 3.67599 (error=0.0227117), validation cost 3.64609 (error=0.022854)
epoch 50, training cost 3.34521 (error=0.0226793), validation cost 3.27436 (error=0.0228489)
epoch 60, training cost 3.11396 (error=0.0226587), validation cost 3.10701 (error=0.022846)
epoch 70, training cost 3.02202 (error=0.0226811), validation cost 3.0212 (error=0.0227922)
epoch 80, training cost 2.93378 (error=0.0226739), validation cost 2.93691 (error=0.0228174)
epoch 90, training cost 2.88662 (error=0.0226562), validation cost 2.90157 (error=0.0228195)
[RESULT] training cost 2.84958, validation cost 2.84553, training error 0.0226731, validation error 0.0227708
[SAVE] result_10_4/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_4/train.jbl
[SAVE] config:  config_adw_gen_10_4.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_4/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[0.6067744  0.12415257]
[0.6067744  0.12415257]
data index: 0
error= 1.5628136813991074
dimension (observation): 0
steps: 100
[SAVE] : result_10_4/plot/0_data0_train.png
data index: 1
error= 3.0184248599021917
dimension (observation): 0
steps: 100
[SAVE] : result_10_4/plot/1_data1_train.png
data index: 2
error= 1.4043570284176288
dimension (observation): 0
steps: 100
[SAVE] : result_10_4/plot/2_data2_train.png
data index: 3
error= 1.3515344963180729
dimension (observation): 0
steps: 100
[SAVE] : result_10_4/plot/3_data3_train.png
data index: 4
error= 1.6683282702832596
dimension (observation): 0
steps: 100
[SAVE] : result_10_4/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_5.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:51:49.028275: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:51:49.068428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:51:49.068612: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:51:49.068716: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:51:49.068778: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:51:49.068837: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:51:49.068893: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:51:49.068947: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:51:49.069007: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:51:49.069019: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:51:49.069515: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:51:49.098002: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:51:49.099127: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ab4f988140 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:51:49.099158: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:51:49.229678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ab4f9ea450 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:51:49.229733: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:51:49.229839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:51:49.229848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 21.5302 (error=0.0783603), validation cost 21.854 (error=0.0742583)
epoch 10, training cost 3.73232 (error=0.0307719), validation cost 3.71805 (error=0.030714)
epoch 20, training cost 3.04641 (error=0.0236782), validation cost 3.02155 (error=0.0227402)
epoch 30, training cost 2.9139 (error=0.0229892), validation cost 2.88738 (error=0.0220871)
epoch 40, training cost 2.87173 (error=0.0229729), validation cost 2.84389 (error=0.0220424)
epoch 50, training cost 2.84807 (error=0.0229107), validation cost 2.82177 (error=0.0221032)
epoch 60, training cost 2.83185 (error=0.0229057), validation cost 2.80351 (error=0.022038)
epoch 70, training cost 2.82255 (error=0.0228894), validation cost 2.79264 (error=0.02197)
epoch 80, training cost 2.81439 (error=0.0228856), validation cost 2.78323 (error=0.0219513)
epoch 90, training cost 2.8087 (error=0.0228789), validation cost 2.77932 (error=0.0219621)
[RESULT] training cost 2.80463, validation cost 2.77361, training error 0.0228936, validation error 0.0219514
[SAVE] result_10_5/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_5/train.jbl
[SAVE] config:  config_adw_gen_10_5.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_5/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[1.1086943 1.1712558]
[1.1086943 1.1712558]
data index: 0
error= 1.5508175304540277
dimension (observation): 0
steps: 100
[SAVE] : result_10_5/plot/0_data0_train.png
data index: 1
error= 3.0016798233673776
dimension (observation): 0
steps: 100
[SAVE] : result_10_5/plot/1_data1_train.png
data index: 2
error= 1.3875438661421449
dimension (observation): 0
steps: 100
[SAVE] : result_10_5/plot/2_data2_train.png
data index: 3
error= 1.3261669505849059
dimension (observation): 0
steps: 100
[SAVE] : result_10_5/plot/3_data3_train.png
data index: 4
error= 1.599174273645955
dimension (observation): 0
steps: 100
[SAVE] : result_10_5/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_6.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:55:40.578795: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:55:40.616214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:55:40.616344: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:55:40.616397: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:55:40.616440: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:55:40.616494: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:55:40.616539: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:55:40.616581: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:55:40.616623: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:55:40.616631: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:55:40.617048: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:55:40.646030: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:55:40.647568: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55715764fcb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:55:40.647595: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:55:40.796298: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5571576b1fc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:55:40.796341: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:55:40.796422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:55:40.796430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 33.7788 (error=0.0361503), validation cost 38.8937 (error=0.0327426)
epoch 10, training cost 4.60511 (error=0.0236694), validation cost 4.54213 (error=0.0219653)
epoch 20, training cost 4.04835 (error=0.0232765), validation cost 3.92539 (error=0.0217541)
epoch 30, training cost 3.69 (error=0.0231808), validation cost 3.63496 (error=0.0216573)
epoch 40, training cost 3.52072 (error=0.0230434), validation cost 3.47179 (error=0.0215923)
epoch 50, training cost 3.40161 (error=0.0230273), validation cost 3.33712 (error=0.0216373)
epoch 60, training cost 3.29774 (error=0.0230062), validation cost 3.25741 (error=0.0214903)
epoch 70, training cost 3.24238 (error=0.0230029), validation cost 3.19169 (error=0.0214789)
epoch 80, training cost 3.21365 (error=0.0229865), validation cost 3.14725 (error=0.0216238)
epoch 90, training cost 3.189 (error=0.0230104), validation cost 3.13148 (error=0.0214607)
[RESULT] training cost 3.17057, validation cost 3.15238, training error 0.0229755, validation error 0.0216028
[SAVE] result_10_6/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_6/train.jbl
[SAVE] config:  config_adw_gen_10_6.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_6/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 1.0123022 -0.2907248]
[ 1.0123022 -0.2907248]
data index: 0
error= 1.6480745200574307
dimension (observation): 0
steps: 100
[SAVE] : result_10_6/plot/0_data0_train.png
data index: 1
error= 2.9762308254534737
dimension (observation): 0
steps: 100
[SAVE] : result_10_6/plot/1_data1_train.png
data index: 2
error= 1.4871585511538525
dimension (observation): 0
steps: 100
[SAVE] : result_10_6/plot/2_data2_train.png
data index: 3
error= 1.4387474365248731
dimension (observation): 0
steps: 100
[SAVE] : result_10_6/plot/3_data3_train.png
data index: 4
error= 1.7482015627875707
dimension (observation): 0
steps: 100
[SAVE] : result_10_6/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_7.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 21:59:20.816703: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 21:59:20.852637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 21:59:20.852853: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:59:20.852919: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:59:20.853009: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:59:20.853090: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:59:20.853157: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:59:20.853217: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 21:59:20.853284: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 21:59:20.853296: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 21:59:20.853753: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 21:59:20.881985: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 21:59:20.883925: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563e9b6c26c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:59:20.883976: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 21:59:21.032424: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563e9b7249d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 21:59:21.032484: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 21:59:21.032609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 21:59:21.032616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 28.7117 (error=0.120332), validation cost 26.8119 (error=0.110538)
epoch 10, training cost 3.98069 (error=0.0286001), validation cost 4.03444 (error=0.0299727)
epoch 20, training cost 3.44869 (error=0.0238857), validation cost 3.49267 (error=0.0254242)
epoch 30, training cost 3.27399 (error=0.0226569), validation cost 3.32285 (error=0.0240573)
epoch 40, training cost 3.21526 (error=0.0224499), validation cost 3.27721 (error=0.0240943)
epoch 50, training cost 3.18418 (error=0.02241), validation cost 3.23978 (error=0.0238907)
epoch 60, training cost 3.16488 (error=0.0223841), validation cost 3.21615 (error=0.0237805)
epoch 70, training cost 3.15766 (error=0.0224042), validation cost 3.22412 (error=0.02414)
epoch 80, training cost 3.15068 (error=0.0223558), validation cost 3.2075 (error=0.023862)
epoch 90, training cost 3.14809 (error=0.0223809), validation cost 3.20548 (error=0.023938)
[RESULT] training cost 3.14511, validation cost 3.19999, training error 0.0223823, validation error 0.0238225
[SAVE] result_10_7/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_7/train.jbl
[SAVE] config:  config_adw_gen_10_7.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_7/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.691478  -0.6794019]
[-1.800842 -0.702562]
data index: 0
error= 1.5902312555424634
dimension (observation): 0
steps: 100
[SAVE] : result_10_7/plot/0_data0_train.png
data index: 1
error= 3.033679855554509
dimension (observation): 0
steps: 100
[SAVE] : result_10_7/plot/1_data1_train.png
data index: 2
error= 1.4275420657447786
dimension (observation): 0
steps: 100
[SAVE] : result_10_7/plot/2_data2_train.png
data index: 3
error= 1.338922846802755
dimension (observation): 0
steps: 100
[SAVE] : result_10_7/plot/3_data3_train.png
data index: 4
error= 1.6150919432093789
dimension (observation): 0
steps: 100
[SAVE] : result_10_7/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_8.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 22:02:59.704329: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 22:02:59.753368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 22:02:59.753594: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:02:59.753685: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:02:59.753774: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:02:59.753833: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:02:59.753911: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:02:59.753965: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:02:59.754026: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 22:02:59.754037: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 22:02:59.754508: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 22:02:59.781961: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 22:02:59.783351: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a787469400 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 22:02:59.783382: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 22:02:59.912995: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a7874cb710 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 22:02:59.913041: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 22:02:59.913124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 22:02:59.913131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 14.3384 (error=0.0609346), validation cost 16.1263 (error=0.0656847)
epoch 10, training cost 4.58222 (error=0.0276011), validation cost 4.59949 (error=0.0296029)
epoch 20, training cost 3.82081 (error=0.023565), validation cost 3.85862 (error=0.0247453)
epoch 30, training cost 3.5314 (error=0.0227723), validation cost 3.56544 (error=0.0236698)
epoch 40, training cost 3.41334 (error=0.0226452), validation cost 3.45288 (error=0.0235494)
epoch 50, training cost 3.37357 (error=0.022599), validation cost 3.41526 (error=0.0236601)
epoch 60, training cost 3.35811 (error=0.0226067), validation cost 3.3972 (error=0.0235696)
epoch 70, training cost 3.35362 (error=0.0225557), validation cost 3.38424 (error=0.0235069)
epoch 80, training cost 3.34554 (error=0.0225578), validation cost 3.37831 (error=0.0234221)
epoch 90, training cost 3.34194 (error=0.0225603), validation cost 3.37696 (error=0.0234938)
[RESULT] training cost 3.33737, validation cost 3.38743, training error 0.0226055, validation error 0.0236393
[SAVE] result_10_8/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_8/train.jbl
[SAVE] config:  config_adw_gen_10_8.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_8/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 0.7309346 -0.5011752]
[ 0.7309346 -0.5011752]
data index: 0
error= 1.4372991062123432
dimension (observation): 0
steps: 100
[SAVE] : result_10_8/plot/0_data0_train.png
data index: 1
error= 3.0429069916085494
dimension (observation): 0
steps: 100
[SAVE] : result_10_8/plot/1_data1_train.png
data index: 2
error= 1.2668619792907492
dimension (observation): 0
steps: 100
[SAVE] : result_10_8/plot/2_data2_train.png
data index: 3
error= 1.1836227252039613
dimension (observation): 0
steps: 100
[SAVE] : result_10_8/plot/3_data3_train.png
data index: 4
error= 1.459982460454921
dimension (observation): 0
steps: 100
[SAVE] : result_10_8/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_9.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 22:06:39.982435: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 22:06:40.022379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 22:06:40.022576: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:06:40.022639: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:06:40.022711: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:06:40.022783: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:06:40.022855: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:06:40.022917: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:06:40.022970: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 22:06:40.022980: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 22:06:40.023472: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 22:06:40.049953: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 22:06:40.050973: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5596c7d6f6c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 22:06:40.051001: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 22:06:40.186703: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5596c7dd19d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 22:06:40.186753: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 22:06:40.186881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 22:06:40.186909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 416.853 (error=0.0819937), validation cost 348.761 (error=0.0806189)
epoch 10, training cost 8.46649 (error=0.0355187), validation cost 8.3748 (error=0.0361874)
epoch 20, training cost 6.24676 (error=0.0259657), validation cost 6.25115 (error=0.0259512)
epoch 30, training cost 5.39328 (error=0.0246269), validation cost 5.37765 (error=0.024674)
epoch 40, training cost 4.89157 (error=0.0240414), validation cost 4.88441 (error=0.0241759)
epoch 50, training cost 4.55412 (error=0.0234115), validation cost 4.56261 (error=0.0235358)
epoch 60, training cost 4.32298 (error=0.0231243), validation cost 4.32172 (error=0.0232405)
epoch 70, training cost 4.15177 (error=0.0231583), validation cost 4.15531 (error=0.0233302)
epoch 80, training cost 4.00874 (error=0.023116), validation cost 4.00487 (error=0.0230105)
epoch 90, training cost 3.89209 (error=0.02294), validation cost 3.88926 (error=0.0228852)
[RESULT] training cost 3.81573, validation cost 3.81007, training error 0.0228622, validation error 0.0227295
[SAVE] result_10_9/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_9/train.jbl
[SAVE] config:  config_adw_gen_10_9.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_9/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[-1.702487    0.67013437]
[-2.3141096  0.5216789]
data index: 0
error= 1.549765802878765
dimension (observation): 0
steps: 100
[SAVE] : result_10_9/plot/0_data0_train.png
data index: 1
error= 3.0433522573469847
dimension (observation): 0
steps: 100
[SAVE] : result_10_9/plot/1_data1_train.png
data index: 2
error= 1.4231222123506884
dimension (observation): 0
steps: 100
[SAVE] : result_10_9/plot/2_data2_train.png
data index: 3
error= 1.2998021473883998
dimension (observation): 0
steps: 100
[SAVE] : result_10_9/plot/3_data3_train.png
data index: 4
error= 1.7523348573975677
dimension (observation): 0
steps: 100
[SAVE] : result_10_9/plot/4_data4_train.png
rm: cannot remove 'hyparam_adw_gen_10_10.json': No such file or directory
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:1536: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-07-17 22:10:31.232743: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-17 22:10:31.282870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:3b:00.0
2020-07-17 22:10:31.283142: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:10:31.283245: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:10:31.283342: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:10:31.283419: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:10:31.283508: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:10:31.283570: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2020-07-17 22:10:31.283661: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-07-17 22:10:31.283673: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-07-17 22:10:31.284266: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-17 22:10:31.314031: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3400000000 Hz
2020-07-17 22:10:31.315781: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c3145062f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 22:10:31.315836: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 22:10:31.446933: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c314568600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 22:10:31.447003: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-17 22:10:31.447130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 22:10:31.447139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:28: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:289: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:303: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:305: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:35: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:70: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/layers.py:377: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1215: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm_model.py:1385: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:547: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:549: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:553: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:555: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/htanaka/.pyenv/versions/anaconda3-2019.10/lib/python3.7/site-packages/dmm/dmm.py:369: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

#training data: 400
#valid data: 100
train_data_size: 400
batch_size     : 100
n_steps        : 100
dim_emit       : 1
## emission variables
emission_var/em_fc0/weights:0
emission_var/em_fc0/biases:0
emission_var/em_fc_mean/weights:0
emission_var/em_fc_mean/biases:0
emission_var/em_fc_cov/weights:0
emission_var/em_fc_cov/biases:0
## variational dist. variables
variational_dist_var/vd_lstm0/rnn/lstm_cell/kernel:0
variational_dist_var/vd_lstm0/rnn/lstm_cell/bias:0
variational_dist_var/vd_fc1/weights:0
variational_dist_var/vd_fc1/biases:0
variational_dist_var/vd_fc_mu/weights:0
variational_dist_var/vd_fc_mu/biases:0
variational_dist_var/vd_fc_cov/weights:0
variational_dist_var/vd_fc_cov/biases:0
## transition variables
transition_var/tr_fc0/weights:0
transition_var/tr_fc0/biases:0
transition_var/vd_fc_mu/weights:0
transition_var/vd_fc_mu/biases:0
transition_var/vd_fc_cov/weights:0
transition_var/vd_fc_cov/biases:0
## potential variables
## label variables
epoch 0, training cost 82.4384 (error=0.149159), validation cost 92.5178 (error=0.142688)
epoch 10, training cost 6.61508 (error=0.02698), validation cost 6.51558 (error=0.0256695)
epoch 20, training cost 5.71811 (error=0.0250355), validation cost 5.70061 (error=0.0239384)
epoch 30, training cost 5.28559 (error=0.0241445), validation cost 5.26061 (error=0.0229534)
epoch 40, training cost 5.03227 (error=0.0236763), validation cost 4.99396 (error=0.0228043)
epoch 50, training cost 4.84495 (error=0.0232423), validation cost 4.81254 (error=0.0223075)
epoch 60, training cost 4.69958 (error=0.0231067), validation cost 4.65881 (error=0.0221699)
epoch 70, training cost 4.54768 (error=0.0229737), validation cost 4.53136 (error=0.0220717)
epoch 80, training cost 4.41121 (error=0.0229282), validation cost 4.37318 (error=0.0220634)
epoch 90, training cost 4.28299 (error=0.0229311), validation cost 4.26518 (error=0.0220899)
[RESULT] training cost 4.18614, validation cost 4.16045, training error 0.0229301, validation error 0.0220525
[SAVE] result_10_10/model/model.last.ckpt
z_s (400, 100, 2)
z_params (400, 100, 2) (400, 100, 2)
z_pred_params (400, 100, 2) (400, 100, 2)
obs_params (400, 100, 1) (400, 100, 1)
obs_pred_params (400, 100, 1) (400, 100, 1)
[SAVE] result :  result_10_10/train.jbl
[SAVE] config:  config_adw_gen_10_10.result.json
=============
... loading
mode: train
#training data: 0
#valid data: 500
result: save_result_train
[LOAD]: result_10_10/train.jbl
data: dict_keys(['x', 'm', 's', 'num', 'n_steps', 'dim'])
result: dict_keys(['z_s', 'z_params', 'z_pred_params', 'obs_params', 'obs_pred_params', 'config', 'out_dir', 'pid_key', 'info'])
=============
z: z_params
z:  (400, 100, 2)
reconstructed obs: (400, 100, 1)
obs: (500, 100, 1)
[ 2.0845087  -0.47484177]
[ 1.9568534 -0.6708149]
data index: 0
error= 1.5369620145771885
dimension (observation): 0
steps: 100
[SAVE] : result_10_10/plot/0_data0_train.png
data index: 1
error= 3.0472524024450305
dimension (observation): 0
steps: 100
[SAVE] : result_10_10/plot/1_data1_train.png
data index: 2
error= 1.3556221431923825
dimension (observation): 0
steps: 100
[SAVE] : result_10_10/plot/2_data2_train.png
data index: 3
error= 1.2967366280695845
dimension (observation): 0
steps: 100
[SAVE] : result_10_10/plot/3_data3_train.png
data index: 4
error= 1.5709093137107937
dimension (observation): 0
steps: 100
[SAVE] : result_10_10/plot/4_data4_train.png
